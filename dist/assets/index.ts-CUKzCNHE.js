import{S as rc,c as tc,g as wl,s as Ms,d as ac,A as va,L as xs}from"./constants-Co0jPVN_.js";function jn(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(t[a[n]]=e[a[n]]);return t}function yl(e,r,t,a){function n(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function o(u){try{l(a.next(u))}catch(f){i(f)}}function c(u){try{l(a.throw(u))}catch(f){i(f)}}function l(u){u.done?s(u.value):n(u.value).then(o,c)}l((a=a.apply(e,r||[])).next())})}const El=e=>e?(...r)=>e(...r):(...r)=>fetch(...r);class Us extends Error{constructor(r,t="FunctionsError",a){super(r),this.name=t,this.context=a}}class Tl extends Us{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class mi extends Us{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class _i extends Us{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var gs;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(gs||(gs={}));class kl{constructor(r,{headers:t={},customFetch:a,region:n=gs.Any}={}){this.url=r,this.headers=t,this.region=n,this.fetch=El(a)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r){return yl(this,arguments,void 0,function*(t,a={}){var n;let s,i;try{const{headers:o,method:c,body:l,signal:u,timeout:f}=a;let h={},{region:d}=a;d||(d=this.region);const x=new URL(`${this.url}/${t}`);d&&d!=="any"&&(h["x-region"]=d,x.searchParams.set("forceFunctionRegion",d));let p;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=l):typeof l=="string"?(h["Content-Type"]="text/plain",p=l):typeof FormData<"u"&&l instanceof FormData?p=l:(h["Content-Type"]="application/json",p=JSON.stringify(l)):l&&typeof l!="string"&&!(typeof Blob<"u"&&l instanceof Blob)&&!(l instanceof ArrayBuffer)&&!(typeof FormData<"u"&&l instanceof FormData)?p=JSON.stringify(l):p=l;let g=u;f&&(i=new AbortController,s=setTimeout(()=>i.abort(),f),u?(g=i.signal,u.addEventListener("abort",()=>i.abort())):g=i.signal);const _=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:p,signal:g}).catch(F=>{throw new Tl(F)}),E=_.headers.get("x-relay-error");if(E&&E==="true")throw new mi(_);if(!_.ok)throw new _i(_);let v=((n=_.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),O;return v==="application/json"?O=yield _.json():v==="application/octet-stream"||v==="application/pdf"?O=yield _.blob():v==="text/event-stream"?O=_:v==="multipart/form-data"?O=yield _.formData():O=yield _.text(),{data:O,error:null,response:_}}catch(o){return{data:null,error:o,response:o instanceof _i||o instanceof mi?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var Al=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Sl=class{constructor(e){var r,t,a;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(t=e.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(a=e.urlLengthLimit)!==null&&a!==void 0?a:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let n=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let i=null,o=null,c=null,l=s.status,u=s.statusText;if(s.ok){var f,h;if(t.method!=="HEAD"){var d;const _=await s.text();_===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((d=t.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?o=_:o=JSON.parse(_))}const p=(f=t.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),g=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");p&&g&&g.length>1&&(c=parseInt(g[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,c=null,l=406,u="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var x;const p=await s.text();try{i=JSON.parse(p),Array.isArray(i)&&s.status===404&&(o=[],i=null,l=200,u="OK")}catch{s.status===404&&p===""?(l=204,u="No Content"):i={message:p}}if(i&&t.isMaybeSingle&&(!(i==null||(x=i.details)===null||x===void 0)&&x.includes("0 rows"))&&(i=null,l=200,u="OK"),i&&t.shouldThrowOnError)throw new Al(i)}return{error:i,data:o,count:c,status:l,statusText:u}});return this.shouldThrowOnError||(n=n.catch(s=>{var i;let o="",c="",l="";const u=s==null?void 0:s.cause;if(u){var f,h,d,x;const _=(f=u==null?void 0:u.message)!==null&&f!==void 0?f:"",E=(h=u==null?void 0:u.code)!==null&&h!==void 0?h:"";o=`${(d=s==null?void 0:s.name)!==null&&d!==void 0?d:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(x=u==null?void 0:u.name)!==null&&x!==void 0?x:"Error"}: ${_}`,E&&(o+=` (${E})`),u!=null&&u.stack&&(o+=`
${u.stack}`)}else{var p;o=(p=s==null?void 0:s.stack)!==null&&p!==void 0?p:""}const g=this.url.toString().length;return(s==null?void 0:s.name)==="AbortError"||(s==null?void 0:s.code)==="ABORT_ERR"?(l="",c="Request was aborted (timeout or manual cancellation)",g>this.urlLengthLimit&&(c+=`. Note: Your request URL is ${g} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((u==null?void 0:u.name)==="HeadersOverflowError"||(u==null?void 0:u.code)==="UND_ERR_HEADERS_OVERFLOW")&&(l="",c="HTTP headers exceeded server limits (typically 16KB)",g>this.urlLengthLimit&&(c+=`. Your request URL is ${g} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:c,code:l},data:null,count:null,status:0,statusText:""}})),n.then(e,r)}returns(){return this}overrideTypes(){return this}},bl=class extends Sl{select(e){let r=!1;const t=(e??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:t,foreignTable:a,referencedTable:n=a}={}){const s=n?`${n}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${r?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:t=r}={}){const a=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,r,{foreignTable:t,referencedTable:a=t}={}){const n=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(s,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:t=!1,buffers:a=!1,wal:n=!1,format:s="text"}={}){var i;const o=[e?"analyze":null,r?"verbose":null,t?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${c}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const wi=new RegExp("[,()]");var Xt=class extends bl{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}regexMatch(e,r){return this.url.searchParams.append(e,`match.${r}`),this}regexIMatch(e,r){return this.url.searchParams.append(e,`imatch.${r}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}isDistinct(e,r){return this.url.searchParams.append(e,`isdistinct.${r}`),this}in(e,r){const t=Array.from(new Set(r)).map(a=>typeof a=="string"&&wi.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}notIn(e,r){const t=Array.from(new Set(r)).map(a=>typeof a=="string"&&wi.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${t})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:t,type:a}={}){let n="";a==="plain"?n="pl":a==="phrase"?n="ph":a==="websearch"&&(n="w");const s=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${n}fts${s}.${r}`),this}match(e){return Object.entries(e).forEach(([r,t])=>{this.url.searchParams.append(r,`eq.${t}`)}),this}not(e,r,t){return this.url.searchParams.append(e,`not.${r}.${t}`),this}or(e,{foreignTable:r,referencedTable:t=r}={}){const a=t?`${t}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,r,t){return this.url.searchParams.append(e,`${r}.${t}`),this}},Cl=class{constructor(e,{headers:r={},schema:t,fetch:a,urlLengthLimit:n=8e3}){this.url=e,this.headers=new Headers(r),this.schema=t,this.fetch=a,this.urlLengthLimit=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,r){const{head:t=!1,count:a}=r??{},n=t?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join(""),{url:o,headers:c}=this.cloneRequestState();return o.searchParams.set("select",i),a&&c.append("Prefer",`count=${a}`),new Xt({method:n,url:o,headers:c,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:r,defaultToNull:t=!0}={}){var a;const n="POST",{url:s,headers:i}=this.cloneRequestState();if(r&&i.append("Prefer",`count=${r}`),t||i.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(o.length>0){const c=[...new Set(o)].map(l=>`"${l}"`);s.searchParams.set("columns",c.join(","))}}return new Xt({method:n,url:s,headers:i,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:r,ignoreDuplicates:t=!1,count:a,defaultToNull:n=!0}={}){var s;const i="POST",{url:o,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),r!==void 0&&o.searchParams.set("on_conflict",r),a&&c.append("Prefer",`count=${a}`),n||c.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(l.length>0){const u=[...new Set(l)].map(f=>`"${f}"`);o.searchParams.set("columns",u.join(","))}}return new Xt({method:i,url:o,headers:c,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:r}={}){var t;const a="PATCH",{url:n,headers:s}=this.cloneRequestState();return r&&s.append("Prefer",`count=${r}`),new Xt({method:a,url:n,headers:s,schema:this.schema,body:e,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var r;const t="DELETE",{url:a,headers:n}=this.cloneRequestState();return e&&n.append("Prefer",`count=${e}`),new Xt({method:t,url:a,headers:n,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}};function Pa(e){"@babel/helpers - typeof";return Pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Pa(e)}function Ol(e,r){if(Pa(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if(Pa(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Rl(e){var r=Ol(e,"string");return Pa(r)=="symbol"?r:r+""}function Fl(e,r,t){return(r=Rl(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function yi(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function sn(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?yi(Object(t),!0).forEach(function(a){Fl(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yi(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}var Il=class nc{constructor(r,{headers:t={},schema:a,fetch:n,timeout:s,urlLengthLimit:i=8e3}={}){this.url=r,this.headers=new Headers(t),this.schemaName=a,this.urlLengthLimit=i;const o=n??globalThis.fetch;s!==void 0&&s>0?this.fetch=(c,l)=>{const u=new AbortController,f=setTimeout(()=>u.abort(),s),h=l==null?void 0:l.signal;if(h){if(h.aborted)return clearTimeout(f),o(c,l);const d=()=>{clearTimeout(f),u.abort()};return h.addEventListener("abort",d,{once:!0}),o(c,sn(sn({},l),{},{signal:u.signal})).finally(()=>{clearTimeout(f),h.removeEventListener("abort",d)})}return o(c,sn(sn({},l),{},{signal:u.signal})).finally(()=>clearTimeout(f))}:this.fetch=o}from(r){if(!r||typeof r!="string"||r.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Cl(new URL(`${this.url}/${r}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(r){return new nc(this.url,{headers:this.headers,schema:r,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(r,t={},{head:a=!1,get:n=!1,count:s}={}){var i;let o;const c=new URL(`${this.url}/rpc/${r}`);let l;const u=d=>d!==null&&typeof d=="object"&&(!Array.isArray(d)||d.some(u)),f=a&&Object.values(t).some(u);f?(o="POST",l=t):a||n?(o=a?"HEAD":"GET",Object.entries(t).filter(([d,x])=>x!==void 0).map(([d,x])=>[d,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([d,x])=>{c.searchParams.append(d,x)})):(o="POST",l=t);const h=new Headers(this.headers);return f?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new Xt({method:o,url:c,headers:h,schema:this.schemaName,body:l,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}};class Dl{constructor(){}static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const a=t.versions;if(a&&a.node){const n=a.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let t=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(t+=`

Suggested solution: ${r.workaround}`),new Error(t)}static createWebSocket(r,t){const a=this.getWebSocketConstructor();return new a(r,t)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const Pl="2.97.0",Nl=`realtime-js/${Pl}`,Ll="1.0.0",sc="2.0.0",Ei=sc,vs=1e4,Bl=1e3,Ml=100;var lt;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(lt||(lt={}));var Ke;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ke||(Ke={}));var Lr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Lr||(Lr={}));var ms;(function(e){e.websocket="websocket"})(ms||(ms={}));var Tt;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Tt||(Tt={}));class Ul{constructor(r){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=r??[]}encode(r,t){if(r.event===this.BROADCAST_EVENT&&!(r.payload instanceof ArrayBuffer)&&typeof r.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(r));let a=[r.join_ref,r.ref,r.topic,r.event,r.payload];return t(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(r){var t;return this._isArrayBuffer((t=r.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(r):this._encodeJsonUserBroadcastPush(r)}_encodeBinaryUserBroadcastPush(r){var t,a;const n=(a=(t=r.payload)===null||t===void 0?void 0:t.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(r,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(r){var t,a;const n=(a=(t=r.payload)===null||t===void 0?void 0:t.payload)!==null&&a!==void 0?a:{},i=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(r,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(r,t,a){var n,s;const i=r.topic,o=(n=r.ref)!==null&&n!==void 0?n:"",c=(s=r.join_ref)!==null&&s!==void 0?s:"",l=r.payload.event,u=this.allowedMetadataKeys?this._pick(r.payload,this.allowedMetadataKeys):{},f=Object.keys(u).length===0?"":JSON.stringify(u);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+o.length+i.length+l.length+f.length,d=new ArrayBuffer(this.HEADER_LENGTH+h);let x=new DataView(d),p=0;x.setUint8(p++,this.KINDS.userBroadcastPush),x.setUint8(p++,c.length),x.setUint8(p++,o.length),x.setUint8(p++,i.length),x.setUint8(p++,l.length),x.setUint8(p++,f.length),x.setUint8(p++,t),Array.from(c,_=>x.setUint8(p++,_.charCodeAt(0))),Array.from(o,_=>x.setUint8(p++,_.charCodeAt(0))),Array.from(i,_=>x.setUint8(p++,_.charCodeAt(0))),Array.from(l,_=>x.setUint8(p++,_.charCodeAt(0))),Array.from(f,_=>x.setUint8(p++,_.charCodeAt(0)));var g=new Uint8Array(d.byteLength+a.byteLength);return g.set(new Uint8Array(d),0),g.set(new Uint8Array(a),d.byteLength),g.buffer}decode(r,t){if(this._isArrayBuffer(r)){let a=this._binaryDecode(r);return t(a)}if(typeof r=="string"){const a=JSON.parse(r),[n,s,i,o,c]=a;return t({join_ref:n,ref:s,topic:i,event:o,payload:c})}return t({})}_binaryDecode(r){const t=new DataView(r),a=t.getUint8(0),n=new TextDecoder;switch(a){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(r,t,n)}}_decodeUserBroadcast(r,t,a){const n=t.getUint8(1),s=t.getUint8(2),i=t.getUint8(3),o=t.getUint8(4);let c=this.HEADER_LENGTH+4;const l=a.decode(r.slice(c,c+n));c=c+n;const u=a.decode(r.slice(c,c+s));c=c+s;const f=a.decode(r.slice(c,c+i));c=c+i;const h=r.slice(c,r.byteLength),d=o===this.JSON_ENCODING?JSON.parse(a.decode(h)):h,x={type:this.BROADCAST_EVENT,event:u,payload:d};return i>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(r){var t;return r instanceof ArrayBuffer||((t=r==null?void 0:r.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(r,t){return!r||typeof r!="object"?{}:Object.fromEntries(Object.entries(r).filter(([a])=>t.includes(a)))}}class ic{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ce;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ce||(Ce={}));const Ti=(e,r,t={})=>{var a;const n=(a=t.skipTypes)!==null&&a!==void 0?a:[];return r?Object.keys(r).reduce((s,i)=>(s[i]=$l(i,e,r,n),s),{}):{}},$l=(e,r,t,a)=>{const n=r.find(o=>o.name===e),s=n==null?void 0:n.type,i=t[e];return s&&!a.includes(s)?oc(s,i):_s(i)},oc=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return Vl(r,t)}switch(e){case Ce.bool:return jl(r);case Ce.float4:case Ce.float8:case Ce.int2:case Ce.int4:case Ce.int8:case Ce.numeric:case Ce.oid:return Hl(r);case Ce.json:case Ce.jsonb:return Wl(r);case Ce.timestamp:return Gl(r);case Ce.abstime:case Ce.date:case Ce.daterange:case Ce.int4range:case Ce.int8range:case Ce.money:case Ce.reltime:case Ce.text:case Ce.time:case Ce.timestamptz:case Ce.timetz:case Ce.tsrange:case Ce.tstzrange:return _s(r);default:return _s(r)}},_s=e=>e,jl=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Hl=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},Wl=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Vl=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,a=e[t];if(e[0]==="{"&&a==="}"){let s;const i=e.slice(1,t);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>oc(r,o))}return e},Gl=e=>typeof e=="string"?e.replace(" ","T"):e,cc=e=>{const r=new URL(e);return r.protocol=r.protocol.replace(/^ws/i,"http"),r.pathname=r.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),r.pathname===""||r.pathname==="/"?r.pathname="/api/broadcast":r.pathname=r.pathname+"/api/broadcast",r.href};class Jn{constructor(r,t,a={},n=vs){this.channel=r,this.event=t,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var a;return this._hasReceived(r)&&t((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(a=>a.status===r).forEach(a=>a.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var ki;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(ki||(ki={}));class Ta{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ta.syncState(this.state,n,s,i),this.pendingDiffs.forEach(c=>{this.state=Ta.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(a.diff,{},n=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Ta.syncDiff(this.state,n,s,i),o())}),this.onJoin((n,s,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:s,newPresences:i})}),this.onLeave((n,s,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,a,n){const s=this.cloneDeep(r),i=this.transformState(t),o={},c={};return this.map(s,(l,u)=>{i[l]||(c[l]=u)}),this.map(i,(l,u)=>{const f=s[l];if(f){const h=u.map(g=>g.presence_ref),d=f.map(g=>g.presence_ref),x=u.filter(g=>d.indexOf(g.presence_ref)<0),p=f.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(o[l]=x),p.length>0&&(c[l]=p)}else o[l]=u}),this.syncDiff(s,{joins:o,leaves:c},a,n)}static syncDiff(r,t,a,n){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(s,(o,c)=>{var l;const u=(l=r[o])!==null&&l!==void 0?l:[];if(r[o]=this.cloneDeep(c),u.length>0){const f=r[o].map(d=>d.presence_ref),h=u.filter(d=>f.indexOf(d.presence_ref)<0);r[o].unshift(...h)}a(o,u,c)}),this.map(i,(o,c)=>{let l=r[o];if(!l)return;const u=c.map(f=>f.presence_ref);l=l.filter(f=>u.indexOf(f.presence_ref)<0),r[o]=l,n(o,l,c),l.length===0&&delete r[o]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(a=>t(a,r[a]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,a)=>{const n=r[a];return"metas"in n?t[a]=n.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[a]=n,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ai;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ai||(Ai={}));var ka;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ka||(ka={}));var Qr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Qr||(Qr={}));class Qt{constructor(r,t={config:{}},a){var n,s;if(this.topic=r,this.params=t,this.socket=a,this.bindings={},this.state=Ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Jn(this,Lr.join,this.params,this.timeout),this.rejoinTimer=new ic(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ke.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ke.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Lr.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Ta(this),this.broadcastEndpointURL=cc(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(r,t=this.timeout){var a,n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Ke.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,l=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(d=>d.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[ka.PRESENCE]&&this.bindings[ka.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:l,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(d=>r==null?void 0:r(Qr.CHANNEL_ERROR,d)),this._onClose(()=>r==null?void 0:r(Qr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:d})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),d===void 0){r==null||r(Qr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,_=[];for(let E=0;E<g;E++){const v=p[E],{filter:{event:O,schema:F,table:R,filter:k}}=v,L=d&&d[E];if(L&&L.event===O&&Qt.isFilterValueEqual(L.schema,F)&&Qt.isFilterValueEqual(L.table,R)&&Qt.isFilterValueEqual(L.filter,k))_.push(Object.assign(Object.assign({},v),{id:L.id}));else{this.unsubscribe(),this.state=Ke.errored,r==null||r(Qr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,r&&r(Qr.SUBSCRIBED);return}}).receive("error",d=>{this.state=Ke.errored,r==null||r(Qr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(Qr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,a){return this.state===Ke.joined&&r===ka.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(r,t,a)}async httpSend(r,t,a={}){var n;if(t==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:t,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=a.timeout)!==null&&n!==void 0?n:this.timeout);if(o.status===202)return{success:!0};let c=o.statusText;try{const l=await o.json();c=l.error||l.message||c}catch{}return Promise.reject(new Error(c))}async send(r,t={}){var a,n;if(!this._canPush()&&r.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=r,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=t.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,c;const l=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),l.receive("ok",()=>s("ok")),l.receive("error",()=>s("error")),l.receive("timeout",()=>s("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Ke.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Lr.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Jn(this,Lr.leave,{},r),a.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ke.closed,this.bindings={}}async _fetchWithTimeout(r,t,a){const n=new AbortController,s=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(s),i}_push(r,t,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Jn(this,r,t,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>Ml){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(r,t,a){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,a){var n,s;const i=r.toLocaleLowerCase(),{close:o,error:c,leave:l,join:u}=Lr;if(a&&[o,c,l,u].indexOf(i)>=0&&a!==this._joinRef())return;let h=this._onMessage(i,t,a);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(d=>{var x,p,g;return((x=d.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(p=d.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===i}).map(d=>d.callback(h,a)):(s=this.bindings[i])===null||s===void 0||s.filter(d=>{var x,p,g,_,E,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in d){const O=d.id,F=(x=d.filter)===null||x===void 0?void 0:x.event;return O&&((p=t.ids)===null||p===void 0?void 0:p.includes(O))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const O=(E=(_=d==null?void 0:d.filter)===null||_===void 0?void 0:_.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return O==="*"||O===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return d.type.toLocaleLowerCase()===i}).map(d=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:g,commit_timestamp:_,type:E,errors:v}=x;h=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:_,eventType:E,new:{},old:{},errors:v}),this._getPayloadRecords(x))}d.callback(h,a)})}_isClosed(){return this.state===Ke.closed}_isJoined(){return this.state===Ke.joined}_isJoining(){return this.state===Ke.joining}_isLeaving(){return this.state===Ke.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,a){const n=r.toLocaleLowerCase(),s={type:n,filter:t,callback:a};return this.bindings[n]?this.bindings[n].push(s):this.bindings[n]=[s],this}_off(r,t){const a=r.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var s;return!(((s=n.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===a&&Qt.isEqual(n.filter,t))})),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const a in r)if(r[a]!==t[a])return!1;return!0}static isFilterValueEqual(r,t){return(r??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Lr.close,{},r)}_onError(r){this._on(Lr.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ke.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=Ti(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=Ti(r.columns,r.old_record)),t}}const Zn=()=>{},on={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Kl=[1e3,2e3,5e3,1e4],ql=1e4,zl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xl{constructor(r,t){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=vs,this.transport=null,this.heartbeatIntervalMs=on.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zn,this.ref=0,this.reconnectTimer=null,this.vsn=Ei,this.logger=Zn,this.conn=null,this.sendBuffer=[],this.serializer=new Ul,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...s)=>n(...s):(...s)=>fetch(...s),!(!((a=t==null?void 0:t.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${r}/${ms.websocket}`,this.httpEndpoint=cc(r),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dl.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const t=r.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(r,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(r?this.conn.close(r,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,a){this.logger(r,t,a)}connectionState(){switch(this.conn&&this.conn.readyState){case lt.connecting:return Tt.Connecting;case lt.open:return Tt.Open;case lt.closing:return Tt.Closing;default:return Tt.Closed}}isConnected(){return this.connectionState()===Tt.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,t={config:{}}){const a=`realtime:${r}`,n=this.getChannels().find(s=>s.topic===a);if(n)return n;{const s=new Qt(`realtime:${r}`,t,this);return this.channels.push(s),s}}push(r){const{topic:t,event:a,payload:n,ref:s}=r,i=()=>{this.encode(r,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${t} ${a} (${s})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var r;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(Bl,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},on.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(a=>a.topic===r&&(a._isJoined()||a._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const l=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",l)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:a,event:n,payload:s,ref:i}=t,o=i?`(${i})`:"",c=s.status||"";this.log("receive",`${c} ${a} ${n} ${o}`.trim(),s),this.channels.filter(l=>l._isMember(a)).forEach(l=>l._trigger(n,s,i)),this._triggerStateCallbacks("message",t)})}_clearTimer(r){var t;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r),this.conn.readyState===lt.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===lt.open||this.conn.readyState===lt.connecting)try{this.conn.close()}catch(r){this.log("error","Error closing connection",r)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(r){var t;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(r=>r._trigger(Lr.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const a=r.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${r}${a}${n}`}_workerObjectUrl(r){let t;if(r)t=r;else{const a=new Blob([zl],{type:"application/javascript"});t=URL.createObjectURL(a)}return t}_setConnectionState(r,t=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(r=null){let t,a=!1;if(r)t=r,a=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),t=this.accessTokenValue}else t=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:Nl};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Lr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${r}`,t)})}_triggerStateCallbacks(r,t){try{this.stateChangeCallbacks[r].forEach(a=>{try{a(t)}catch(n){this.log("error",`error in ${r} callback`,n)}})}catch(a){this.log("error",`error triggering ${r} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new ic(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},on.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var t,a,n,s,i,o,c,l,u,f,h,d;switch(this.transport=(t=r==null?void 0:r.transport)!==null&&t!==void 0?t:null,this.timeout=(a=r==null?void 0:r.timeout)!==null&&a!==void 0?a:vs,this.heartbeatIntervalMs=(n=r==null?void 0:r.heartbeatIntervalMs)!==null&&n!==void 0?n:on.HEARTBEAT_INTERVAL,this.worker=(s=r==null?void 0:r.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=r==null?void 0:r.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=r==null?void 0:r.heartbeatCallback)!==null&&o!==void 0?o:Zn,this.vsn=(c=r==null?void 0:r.vsn)!==null&&c!==void 0?c:Ei,r!=null&&r.params&&(this.params=r.params),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=r==null?void 0:r.reconnectAfterMs)!==null&&l!==void 0?l:x=>Kl[x-1]||ql,this.vsn){case Ll:this.encode=(u=r==null?void 0:r.encode)!==null&&u!==void 0?u:(x,p)=>p(JSON.stringify(x)),this.decode=(f=r==null?void 0:r.decode)!==null&&f!==void 0?f:(x,p)=>p(JSON.parse(x));break;case sc:this.encode=(h=r==null?void 0:r.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(d=r==null?void 0:r.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r==null?void 0:r.workerUrl}}}var Na=class extends Error{constructor(e,r){var t;super(e),this.name="IcebergError",this.status=r.status,this.icebergType=r.icebergType,this.icebergCode=r.icebergCode,this.details=r.details,this.isCommitStateUnknown=r.icebergType==="CommitStateUnknownException"||[500,502,504].includes(r.status)&&((t=r.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Yl(e,r,t){const a=new URL(r,e);if(t)for(const[n,s]of Object.entries(t))s!==void 0&&a.searchParams.set(n,s);return a.toString()}async function Jl(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Zl(e){const r=e.fetchImpl??globalThis.fetch;return{async request({method:t,path:a,query:n,body:s,headers:i}){const o=Yl(e.baseUrl,a,n),c=await Jl(e.auth),l=await r(o,{method:t,headers:{...s?{"Content-Type":"application/json"}:{},...c,...i},body:s?JSON.stringify(s):void 0}),u=await l.text(),f=(l.headers.get("content-type")||"").includes("application/json"),h=f&&u?JSON.parse(u):u;if(!l.ok){const d=f?h:void 0,x=d==null?void 0:d.error;throw new Na((x==null?void 0:x.message)??`Request failed with status ${l.status}`,{status:l.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:d})}return{status:l.status,headers:l.headers,data:h}}}}function cn(e){return e.join("")}var Ql=class{constructor(e,r=""){this.client=e,this.prefix=r}async listNamespaces(e){const r=e?{parent:cn(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:r})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,r){const t={namespace:e.namespace,properties:r==null?void 0:r.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${cn(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${cn(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${cn(e.namespace)}`}),!0}catch(r){if(r instanceof Na&&r.status===404)return!1;throw r}}async createNamespaceIfNotExists(e,r){try{return await this.createNamespace(e,r)}catch(t){if(t instanceof Na&&t.status===409)return;throw t}}};function Ht(e){return e.join("")}var eu=class{constructor(e,r="",t){this.client=e,this.prefix=r,this.accessDelegation=t}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables`})).data.identifiers}async createTable(e,r){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables`,body:r,headers:t})).data.metadata}async updateTable(e,r){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables/${e.name}`,body:r});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(e,r){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((r==null?void 0:r.purge)??!1)}})}async loadTable(e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables/${e.name}`,headers:r})).data.metadata}async tableExists(e){const r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ht(e.namespace)}/tables/${e.name}`,headers:r}),!0}catch(t){if(t instanceof Na&&t.status===404)return!1;throw t}}async createTableIfNotExists(e,r){try{return await this.createTable(e,r)}catch(t){if(t instanceof Na&&t.status===409)return await this.loadTable({namespace:e.namespace,name:r.name});throw t}}},ru=class{constructor(e){var a;let r="v1";e.catalogName&&(r+=`/${e.catalogName}`);const t=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Zl({baseUrl:t,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(a=e.accessDelegation)==null?void 0:a.join(","),this.namespaceOps=new Ql(this.client,r),this.tableOps=new eu(this.client,r,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,r){return this.namespaceOps.createNamespace(e,r)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,r){return this.tableOps.createTable(e,r)}async updateTable(e,r){return this.tableOps.updateTable(e,r)}async dropTable(e,r){await this.tableOps.dropTable(e,r)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,r){return this.namespaceOps.createNamespaceIfNotExists(e,r)}async createTableIfNotExists(e,r){return this.tableOps.createTableIfNotExists(e,r)}},Hn=class extends Error{constructor(e,r="storage",t,a){super(e),this.__isStorageError=!0,this.namespace=r,this.name=r==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=a}};function Wn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var ln=class extends Hn{constructor(e,r,t,a="storage"){super(e,a,r,t),this.name=a==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=r,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},lc=class extends Hn{constructor(e,r,t="storage"){super(e,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=r}};const tu=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),au=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},ws=e=>{if(Array.isArray(e))return e.map(t=>ws(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,a])=>{const n=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));r[n]=ws(a)}),r},nu=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function La(e){"@babel/helpers - typeof";return La=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},La(e)}function su(e,r){if(La(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if(La(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function iu(e){var r=su(e,"string");return La(r)=="symbol"?r:r+""}function ou(e,r,t){return(r=iu(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Si(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function ue(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Si(Object(t),!0).forEach(function(a){ou(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Si(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}const bi=e=>{var r;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(r=e.error)===null||r===void 0?void 0:r.message)||JSON.stringify(e)},cu=async(e,r,t,a)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(t!=null&&t.noResolveJson)){const n=e,s=n.status||500;if(typeof n.json=="function")n.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";r(new ln(bi(i),s,o,a))}).catch(()=>{if(a==="vectors"){const i=s+"";r(new ln(n.statusText||`HTTP ${s} error`,s,i,a))}else{const i=s+"";r(new ln(n.statusText||`HTTP ${s} error`,s,i,a))}});else{const i=s+"";r(new ln(n.statusText||`HTTP ${s} error`,s,i,a))}}else r(new lc(bi(e),e,a))},lu=(e,r,t,a)=>{const n={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"||e==="HEAD"||!a?ue(ue({},n),t):(au(a)?(n.headers=ue({"Content-Type":"application/json"},r==null?void 0:r.headers),n.body=JSON.stringify(a)):n.body=a,r!=null&&r.duplex&&(n.duplex=r.duplex),ue(ue({},n),t))};async function ga(e,r,t,a,n,s,i){return new Promise((o,c)=>{e(t,lu(r,a,n,s)).then(l=>{if(!l.ok)throw l;if(a!=null&&a.noResolveJson)return l;if(i==="vectors"){const u=l.headers.get("content-type");if(l.headers.get("content-length")==="0"||l.status===204)return{};if(!u||!u.includes("application/json"))return{}}return l.json()}).then(l=>o(l)).catch(l=>cu(l,c,a,i))})}function uc(e="storage"){return{get:async(r,t,a,n)=>ga(r,"GET",t,a,n,void 0,e),post:async(r,t,a,n,s)=>ga(r,"POST",t,n,s,a,e),put:async(r,t,a,n,s)=>ga(r,"PUT",t,n,s,a,e),head:async(r,t,a,n)=>ga(r,"HEAD",t,ue(ue({},a),{},{noResolveJson:!0}),n,void 0,e),remove:async(r,t,a,n,s)=>ga(r,"DELETE",t,n,s,a,e)}}const uu=uc("storage"),{get:Ba,post:Nr,put:ys,head:fu,remove:$s}=uu,Er=uc("vectors");var oa=class{constructor(e,r={},t,a="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.fetch=tu(t),this.namespace=a}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=ue(ue({},this.headers),{},{[e]:r}),this}async handleOperation(e){var r=this;try{return{data:await e(),error:null}}catch(t){if(r.shouldThrowOnError)throw t;if(Wn(t))return{data:null,error:t};throw t}}},hu=class{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}};let fc;fc=Symbol.toStringTag;var du=class{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[fc]="BlobDownloadBuilder",this.promise=null}asStream(){return new hu(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}};const pu={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ci={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var xu=class extends oa{constructor(e,r={},t,a){super(e,r,a,"storage"),this.bucketId=t}async uploadOrUpdate(e,r,t,a){var n=this;return n.handleOperation(async()=>{let s;const i=ue(ue({},Ci),a);let o=ue(ue({},n.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",n.encodeMetadata(c)),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),c&&!s.has("metadata")&&s.append("metadata",n.encodeMetadata(c))):(s=t,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!i.duplex&&(i.duplex="half")),a!=null&&a.headers&&(o=ue(ue({},o),a.headers));const l=n._removeEmptyFolders(r),u=n._getFinalPath(l),f=await(e=="PUT"?ys:Nr)(n.fetch,`${n.url}/object/${u}`,s,ue({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{path:l,id:f.Id,fullPath:f.Key}})}async upload(e,r,t){return this.uploadOrUpdate("POST",e,r,t)}async uploadToSignedUrl(e,r,t,a){var n=this;const s=n._removeEmptyFolders(e),i=n._getFinalPath(s),o=new URL(n.url+`/object/upload/sign/${i}`);return o.searchParams.set("token",r),n.handleOperation(async()=>{let c;const l=ue({upsert:Ci.upsert},a),u=ue(ue({},n.headers),{"x-upsert":String(l.upsert)});return typeof Blob<"u"&&t instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),c.append("",t)):typeof FormData<"u"&&t instanceof FormData?(c=t,c.append("cacheControl",l.cacheControl)):(c=t,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType),{path:s,fullPath:(await ys(n.fetch,o.toString(),c,{headers:u})).Key}})}async createSignedUploadUrl(e,r){var t=this;return t.handleOperation(async()=>{let a=t._getFinalPath(e);const n=ue({},t.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const s=await Nr(t.fetch,`${t.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(t.url+s.url),o=i.searchParams.get("token");if(!o)throw new Hn("No token returned by API");return{signedUrl:i.toString(),path:e,token:o}})}async update(e,r,t){return this.uploadOrUpdate("PUT",e,r,t)}async move(e,r,t){var a=this;return a.handleOperation(async()=>await Nr(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:r,destinationBucket:t==null?void 0:t.destinationBucket},{headers:a.headers}))}async copy(e,r,t){var a=this;return a.handleOperation(async()=>({path:(await Nr(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:r,destinationBucket:t==null?void 0:t.destinationBucket},{headers:a.headers})).Key}))}async createSignedUrl(e,r,t){var a=this;return a.handleOperation(async()=>{let n=a._getFinalPath(e),s=await Nr(a.fetch,`${a.url}/object/sign/${n}`,ue({expiresIn:r},t!=null&&t.transform?{transform:t.transform}:{}),{headers:a.headers});const i=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${a.url}${s.signedURL}${i}`)}})}async createSignedUrls(e,r,t){var a=this;return a.handleOperation(async()=>{const n=await Nr(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:r,paths:e},{headers:a.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return n.map(i=>ue(ue({},i),{},{signedUrl:i.signedURL?encodeURI(`${a.url}${i.signedURL}${s}`):null}))})}download(e,r,t){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=n?`?${n}`:"",i=this._getFinalPath(e),o=()=>Ba(this.fetch,`${this.url}/${a}/${i}${s}`,{headers:this.headers,noResolveJson:!0},t);return new du(o,this.shouldThrowOnError)}async info(e){var r=this;const t=r._getFinalPath(e);return r.handleOperation(async()=>ws(await Ba(r.fetch,`${r.url}/object/info/${t}`,{headers:r.headers})))}async exists(e){var r=this;const t=r._getFinalPath(e);try{return await fu(r.fetch,`${r.url}/object/${t}`,{headers:r.headers}),{data:!0,error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Wn(a)&&a instanceof lc){const n=a.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,r){const t=this._getFinalPath(e),a=[],n=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";n!==""&&a.push(n);const s=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});i!==""&&a.push(i);let o=a.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${t}${o}`)}}}async remove(e){var r=this;return r.handleOperation(async()=>await $s(r.fetch,`${r.url}/object/${r.bucketId}`,{prefixes:e},{headers:r.headers}))}async list(e,r,t){var a=this;return a.handleOperation(async()=>{const n=ue(ue(ue({},pu),r),{},{prefix:e||""});return await Nr(a.fetch,`${a.url}/object/list/${a.bucketId}`,n,{headers:a.headers},t)})}async listV2(e,r){var t=this;return t.handleOperation(async()=>{const a=ue({},e);return await Nr(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,a,{headers:t.headers},r)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}};const gu="2.97.0",Ya={"X-Client-Info":`storage-js/${gu}`};var vu=class extends oa{constructor(e,r={},t,a){const n=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."));const s=n.href.replace(/\/$/,""),i=ue(ue({},Ya),r);super(s,i,t,"storage")}async listBuckets(e){var r=this;return r.handleOperation(async()=>{const t=r.listBucketOptionsToQueryString(e);return await Ba(r.fetch,`${r.url}/bucket${t}`,{headers:r.headers})})}async getBucket(e){var r=this;return r.handleOperation(async()=>await Ba(r.fetch,`${r.url}/bucket/${e}`,{headers:r.headers}))}async createBucket(e,r={public:!1}){var t=this;return t.handleOperation(async()=>await Nr(t.fetch,`${t.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:t.headers}))}async updateBucket(e,r){var t=this;return t.handleOperation(async()=>await ys(t.fetch,`${t.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(e){var r=this;return r.handleOperation(async()=>await Nr(r.fetch,`${r.url}/bucket/${e}/empty`,{},{headers:r.headers}))}async deleteBucket(e){var r=this;return r.handleOperation(async()=>await $s(r.fetch,`${r.url}/bucket/${e}`,{},{headers:r.headers}))}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}},mu=class extends oa{constructor(e,r={},t){const a=e.replace(/\/$/,""),n=ue(ue({},Ya),r);super(a,n,t,"storage")}async createBucket(e){var r=this;return r.handleOperation(async()=>await Nr(r.fetch,`${r.url}/bucket`,{name:e},{headers:r.headers}))}async listBuckets(e){var r=this;return r.handleOperation(async()=>{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const a=t.toString(),n=a?`${r.url}/bucket?${a}`:`${r.url}/bucket`;return await Ba(r.fetch,n,{headers:r.headers})})}async deleteBucket(e){var r=this;return r.handleOperation(async()=>await $s(r.fetch,`${r.url}/bucket/${e}`,{},{headers:r.headers}))}from(e){var r=this;if(!nu(e))throw new Hn("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new ru({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>r.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(t,{get(n,s){const i=n[s];return typeof i!="function"?i:async(...o)=>{try{return{data:await i.apply(n,o),error:null}}catch(c){if(a)throw c;return{data:null,error:c}}}}})}},_u=class extends oa{constructor(e,r={},t){const a=e.replace(/\/$/,""),n=ue(ue({},Ya),{},{"Content-Type":"application/json"},r);super(a,n,t,"vectors")}async createIndex(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/CreateIndex`,e,{headers:r.headers})||{})}async getIndex(e,r){var t=this;return t.handleOperation(async()=>await Er.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:t.headers}))}async listIndexes(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/ListIndexes`,e,{headers:r.headers}))}async deleteIndex(e,r){var t=this;return t.handleOperation(async()=>await Er.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:t.headers})||{})}},wu=class extends oa{constructor(e,r={},t){const a=e.replace(/\/$/,""),n=ue(ue({},Ya),{},{"Content-Type":"application/json"},r);super(a,n,t,"vectors")}async putVectors(e){var r=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/PutVectors`,e,{headers:r.headers})||{})}async getVectors(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/GetVectors`,e,{headers:r.headers}))}async listVectors(e){var r=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/ListVectors`,e,{headers:r.headers}))}async queryVectors(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/QueryVectors`,e,{headers:r.headers}))}async deleteVectors(e){var r=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/DeleteVectors`,e,{headers:r.headers})||{})}},yu=class extends oa{constructor(e,r={},t){const a=e.replace(/\/$/,""),n=ue(ue({},Ya),{},{"Content-Type":"application/json"},r);super(a,n,t,"vectors")}async createBucket(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:r.headers})||{})}async getBucket(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/GetVectorBucket`,{vectorBucketName:e},{headers:r.headers}))}async listBuckets(e={}){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/ListVectorBuckets`,e,{headers:r.headers}))}async deleteBucket(e){var r=this;return r.handleOperation(async()=>await Er.post(r.fetch,`${r.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:r.headers})||{})}},Eu=class extends yu{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new Tu(this.url,this.headers,e,this.fetch)}async createBucket(e){var r=()=>super.createBucket,t=this;return r().call(t,e)}async getBucket(e){var r=()=>super.getBucket,t=this;return r().call(t,e)}async listBuckets(e={}){var r=()=>super.listBuckets,t=this;return r().call(t,e)}async deleteBucket(e){var r=()=>super.deleteBucket,t=this;return r().call(t,e)}},Tu=class extends _u{constructor(e,r,t,a){super(e,r,a),this.vectorBucketName=t}async createIndex(e){var r=()=>super.createIndex,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(e={}){var r=()=>super.listIndexes,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(e){var r=()=>super.getIndex,t=this;return r().call(t,t.vectorBucketName,e)}async deleteIndex(e){var r=()=>super.deleteIndex,t=this;return r().call(t,t.vectorBucketName,e)}index(e){return new ku(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},ku=class extends wu{constructor(e,r,t,a,n){super(e,r,n),this.vectorBucketName=t,this.indexName=a}async putVectors(e){var r=()=>super.putVectors,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var r=()=>super.getVectors,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(e={}){var r=()=>super.listVectors,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var r=()=>super.queryVectors,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var r=()=>super.deleteVectors,t=this;return r().call(t,ue(ue({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},Au=class extends vu{constructor(e,r={},t,a){super(e,r,t,a)}from(e){return new xu(this.url,this.headers,e,this.fetch)}get vectors(){return new Eu(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new mu(this.url+"/iceberg",this.headers,this.fetch)}};const hc="2.97.0",Yt=30*1e3,Es=3,Qn=Es*Yt,Su="http://localhost:9999",bu="supabase.auth.token",Cu={"X-Client-Info":`gotrue-js/${hc}`},Ts="X-Supabase-Api-Version",dc={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ou=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ru=10*60*1e3;class Ma extends Error{constructor(r,t,a){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=a}}function le(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Fu extends Ma{constructor(r,t,a){super(r,t,a),this.name="AuthApiError",this.status=t,this.code=a}}function Iu(e){return le(e)&&e.name==="AuthApiError"}class kt extends Ma{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class nt extends Ma{constructor(r,t,a,n){super(r,a,n),this.name=t,this.status=a}}class wr extends nt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function es(e){return le(e)&&e.name==="AuthSessionMissingError"}class Wt extends nt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class un extends nt{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class fn extends nt{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Du(e){return le(e)&&e.name==="AuthImplicitGrantRedirectError"}class Oi extends nt{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Pu extends nt{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ks extends nt{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function rs(e){return le(e)&&e.name==="AuthRetryableFetchError"}class Ri extends nt{constructor(r,t,a){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=a}}class As extends nt{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fi=` 	
\r=`.split(""),Nu=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<Fi.length;r+=1)e[Fi[r].charCodeAt(0)]=-2;for(let r=0;r<Sn.length;r+=1)e[Sn[r].charCodeAt(0)]=r;return e})();function Ii(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;t(Sn[a]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const a=r.queue>>r.queuedBits-6&63;t(Sn[a]),r.queuedBits-=6}}function pc(e,r,t){const a=Nu[e];if(a>-1)for(r.queue=r.queue<<6|a,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Di(e){const r=[],t=i=>{r.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},s=i=>{Mu(i,a,t)};for(let i=0;i<e.length;i+=1)pc(e.charCodeAt(i),n,s);return r.join("")}function Lu(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Bu(e,r){for(let t=0;t<e.length;t+=1){let a=e.charCodeAt(t);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(e.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}Lu(a,r)}}function Mu(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){r.utf8seq=a;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function ra(e){const r=[],t={queue:0,queuedBits:0},a=n=>{r.push(n)};for(let n=0;n<e.length;n+=1)pc(e.charCodeAt(n),t,a);return new Uint8Array(r)}function Uu(e){const r=[];return Bu(e,t=>r.push(t)),new Uint8Array(r)}function bt(e){const r=[],t={queue:0,queuedBits:0},a=n=>{r.push(n)};return e.forEach(n=>Ii(n,t,a)),Ii(null,t,a),r.join("")}function $u(e){return Math.round(Date.now()/1e3)+e}function ju(){return Symbol("auth-callback")}const Qe=()=>typeof window<"u"&&typeof document<"u",wt={tested:!1,writable:!1},xc=()=>{if(!Qe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(wt.tested)return wt.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wt.tested=!0,wt.writable=!0}catch{wt.tested=!0,wt.writable=!1}return wt.writable};function Hu(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,s)=>{r[s]=n})}catch{}return t.searchParams.forEach((a,n)=>{r[n]=a}),r}const gc=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),Wu=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Jt=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},yt=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ze=async(e,r)=>{await e.removeItem(r)};class Vn{constructor(){this.promise=new Vn.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}Vn.promiseConstructor=Promise;function hn(e){const r=e.split(".");if(r.length!==3)throw new As("Invalid JWT structure");for(let a=0;a<r.length;a++)if(!Ou.test(r[a]))throw new As("JWT not in base64url format");return{header:JSON.parse(Di(r[0])),payload:JSON.parse(Di(r[1])),signature:ra(r[2]),raw:{header:r[0],payload:r[1]}}}async function Vu(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function Gu(e,r){return new Promise((a,n)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!r(s,null,i)){a(i);return}}catch(i){if(!r(s,i)){n(i);return}}})()})}function Ku(e){return("0"+e.toString(16)).substr(-2)}function qu(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=t.length;let n="";for(let s=0;s<56;s++)n+=t.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(r),Array.from(r,Ku).join("")}async function zu(e){const t=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(a);return Array.from(n).map(s=>String.fromCharCode(s)).join("")}async function Xu(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await zu(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vt(e,r,t=!1){const a=qu();let n=a;t&&(n+="/PASSWORD_RECOVERY"),await Jt(e,`${r}-code-verifier`,n);const s=await Xu(a);return[s,a===s?"plain":"s256"]}const Yu=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ju(e){const r=e.headers.get(Ts);if(!r||!r.match(Yu))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function Zu(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function Qu(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ef=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gt(e){if(!ef.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ts(){const e={};return new Proxy(e,{get:(r,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const a=t.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function rf(e,r){return new Proxy(e,{get:(t,a,n)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const s=a.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,a,n)}return!r.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(t,a,n)}})}function Pi(e){return JSON.parse(JSON.stringify(e))}const Et=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tf=[502,503,504];async function Ni(e){var r;if(!Wu(e))throw new ks(Et(e),0);if(tf.includes(e.status))throw new ks(Et(e),e.status);let t;try{t=await e.json()}catch(s){throw new kt(Et(s),s)}let a;const n=Ju(e);if(n&&n.getTime()>=dc["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?a=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(a=t.error_code),a){if(a==="weak_password")throw new Ri(Et(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(a==="session_not_found")throw new wr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Ri(Et(t),e.status,t.weak_password.reasons);throw new Fu(Et(t),e.status||500,a)}const af=(e,r,t,a)=>{const n={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),t))};async function fe(e,r,t,a){var n;const s=Object.assign({},a==null?void 0:a.headers);s[Ts]||(s[Ts]=dc["2024-01-01"].name),a!=null&&a.jwt&&(s.Authorization=`Bearer ${a.jwt}`);const i=(n=a==null?void 0:a.query)!==null&&n!==void 0?n:{};a!=null&&a.redirectTo&&(i.redirect_to=a.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await nf(e,r,t+o,{headers:s,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function nf(e,r,t,a,n,s){const i=af(r,a,n,s);let o;try{o=await e(t,Object.assign({},i))}catch(c){throw console.error(c),new ks(Et(c),0)}if(o.ok||await Ni(o),a!=null&&a.noResolveJson)return o;try{return await o.json()}catch(c){await Ni(c)}}function Pr(e){var r;let t=null;cf(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=$u(e.expires_in)));const a=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:a},error:null}}function Li(e){const r=Pr(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,a)=>t&&typeof a=="string",!0)&&(r.data.weak_password=e.weak_password),r}function ut(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function sf(e){return{data:e,error:null}}function of(e){const{action_link:r,email_otp:t,hashed_token:a,redirect_to:n,verification_type:s}=e,i=jn(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:r,email_otp:t,hashed_token:a,redirect_to:n,verification_type:s},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function Bi(e){return e}function cf(e){return e.access_token&&e.refresh_token&&e.expires_in}const as=["global","local","others"];class lf{constructor({url:r="",headers:t={},fetch:a}){this.url=r,this.headers=t,this.fetch=gc(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(r,t=as[0]){if(as.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${as.join(", ")}`);try{return await fe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(a){if(le(a))return{data:null,error:a};throw a}}async inviteUserByEmail(r,t={}){try{return await fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ut})}catch(a){if(le(a))return{data:{user:null},error:a};throw a}}async generateLink(r){try{const{options:t}=r,a=jn(r,["options"]),n=Object.assign(Object.assign({},a),t);return"newEmail"in a&&(n.new_email=a==null?void 0:a.newEmail,delete n.newEmail),await fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:of,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(le(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await fe(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:ut})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,a,n,s,i,o,c;try{const l={nextPage:null,lastPage:0,total:0},u=await fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=r==null?void 0:r.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Bi});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,d=(c=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);l[`${g}Page`]=p}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},f),l),error:null}}catch(l){if(le(l))return{data:{users:[]},error:l};throw l}}async getUserById(r){Gt(r);try{return await fe(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:ut})}catch(t){if(le(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){Gt(r);try{return await fe(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:ut})}catch(a){if(le(a))return{data:{user:null},error:a};throw a}}async deleteUser(r,t=!1){Gt(r);try{return await fe(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:ut})}catch(a){if(le(a))return{data:{user:null},error:a};throw a}}async _listFactors(r){Gt(r.userId);try{const{data:t,error:a}=await fe(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:a}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _deleteFactor(r){Gt(r.userId),Gt(r.id);try{return{data:await fe(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _listOAuthClients(r){var t,a,n,s,i,o,c;try{const l={nextPage:null,lastPage:0,total:0},u=await fe(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(s=(n=r==null?void 0:r.perPage)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""},xform:Bi});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,d=(c=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return d.length>0&&(d.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);l[`${g}Page`]=p}),l.total=parseInt(h)),{data:Object.assign(Object.assign({},f),l),error:null}}catch(l){if(le(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(r){try{return await fe(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:r,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _getOAuthClient(r){try{return await fe(this.fetch,"GET",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}async _updateOAuthClient(r,t){try{return await fe(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${r}`,{body:t,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(le(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(r){try{return await fe(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${r}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(le(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(r){try{return await fe(this.fetch,"POST",`${this.url}/admin/oauth/clients/${r}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(le(t))return{data:null,error:t};throw t}}}function Mi(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}const Kt={debug:!!(globalThis&&xc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class vc extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class Ui extends vc{}async function uf(e,r,t){Kt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const a=new globalThis.AbortController;r>0&&setTimeout(()=>{a.abort(),Kt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve();try{return await globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){Kt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await t()}finally{Kt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}else{if(r===0)throw Kt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ui(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Kt.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}catch(n){throw(n==null?void 0:n.name)==="AbortError"?new Ui(`Acquiring an exclusive Navigator LockManager lock "${e}" timed out waiting ${r}ms`):n}}function ff(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function mc(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function hf(e){return parseInt(e,16)}function df(e){const r=new TextEncoder().encode(e);return"0x"+Array.from(r,a=>a.toString(16).padStart(2,"0")).join("")}function pf(e){var r;const{chainId:t,domain:a,expirationTime:n,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:c,resources:l,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((r=e.statement)===null||r===void 0)&&r.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const d=mc(e.address),x=u?`${u}://${a}`:a,p=e.statement?`${e.statement}
`:"",g=`${x} wants you to sign in with your Ethereum account:
${d}

${p}`;let _=`URI: ${f}
Version: ${h}
Chain ID: ${t}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(n&&(_+=`
Expiration Time: ${n.toISOString()}`),o&&(_+=`
Not Before: ${o.toISOString()}`),c&&(_+=`
Request ID: ${c}`),l){let E=`
Resources:`;for(const v of l){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);E+=`
- ${v}`}_+=E}return`${g}
${_}`}class Ve extends Error{constructor({message:r,code:t,cause:a,name:n}){var s;super(r,{cause:a}),this.__isWebAuthnError=!0,this.name=(s=n??(a instanceof Error?a.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=t}}class bn extends Ve{constructor(r,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:r}),this.name="WebAuthnUnknownError",this.originalError=t}}function xf({error:e,options:r}){var t,a,n;const{publicKey:s}=r;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(r.signal instanceof AbortSignal)return new Ve({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((t=s.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Ve({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(r.mediation==="conditional"&&((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Ve({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ve({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ve({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ve({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Ve({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ve({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(_c(i)){if(s.rp.id!==i)return new Ve({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ve({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Ve({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ve({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ve({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function gf({error:e,options:r}){const{publicKey:t}=r;if(!t)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(r.signal instanceof AbortSignal)return new Ve({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ve({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(_c(a)){if(t.rpId!==a)return new Ve({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ve({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ve({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ve({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class vf{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const r=new AbortController;return this.controller=r,r.signal}cancelCeremony(){if(this.controller){const r=new Error("Manually cancelling existing WebAuthn API call");r.name="AbortError",this.controller.abort(r),this.controller=void 0}}}const mf=new vf;function _f(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:r,user:t,excludeCredentials:a}=e,n=jn(e,["challenge","user","excludeCredentials"]),s=ra(r).buffer,i=Object.assign(Object.assign({},t),{id:ra(t.id).buffer}),o=Object.assign(Object.assign({},n),{challenge:s,user:i});if(a&&a.length>0){o.excludeCredentials=new Array(a.length);for(let c=0;c<a.length;c++){const l=a[c];o.excludeCredentials[c]=Object.assign(Object.assign({},l),{id:ra(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function wf(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:r,allowCredentials:t}=e,a=jn(e,["challenge","allowCredentials"]),n=ra(r).buffer,s=Object.assign(Object.assign({},a),{challenge:n});if(t&&t.length>0){s.allowCredentials=new Array(t.length);for(let i=0;i<t.length;i++){const o=t[i];s.allowCredentials[i]=Object.assign(Object.assign({},o),{id:ra(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function yf(e){var r;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const t=e;return{id:e.id,rawId:e.id,response:{attestationObject:bt(new Uint8Array(e.response.attestationObject)),clientDataJSON:bt(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(r=t.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function Ef(e){var r;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const t=e,a=e.getClientExtensionResults(),n=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:bt(new Uint8Array(n.authenticatorData)),clientDataJSON:bt(new Uint8Array(n.clientDataJSON)),signature:bt(new Uint8Array(n.signature)),userHandle:n.userHandle?bt(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(r=t.authenticatorAttachment)!==null&&r!==void 0?r:void 0}}function _c(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function $i(){var e,r;return!!(Qe()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((r=navigator==null?void 0:navigator.credentials)===null||r===void 0?void 0:r.get)=="function")}async function Tf(e){try{const r=await navigator.credentials.create(e);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new bn("Browser returned unexpected credential type",r)}:{data:null,error:new bn("Empty credential response",r)}}catch(r){return{data:null,error:xf({error:r,options:e})}}}async function kf(e){try{const r=await navigator.credentials.get(e);return r?r instanceof PublicKeyCredential?{data:r,error:null}:{data:null,error:new bn("Browser returned unexpected credential type",r)}:{data:null,error:new bn("Empty credential response",r)}}catch(r){return{data:null,error:gf({error:r,options:e})}}}const Af={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Sf={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Cn(...e){const r=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),t=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),a={};for(const n of e)if(n)for(const s in n){const i=n[s];if(i!==void 0)if(Array.isArray(i))a[s]=i;else if(t(i))a[s]=i;else if(r(i)){const o=a[s];r(o)?a[s]=Cn(o,i):a[s]=Cn(i)}else a[s]=i}return a}function bf(e,r){return Cn(Af,e,r||{})}function Cf(e,r){return Cn(Sf,e,r||{})}class Of{constructor(r){this.client=r,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(r){return this.client.mfa.enroll(Object.assign(Object.assign({},r),{factorType:"webauthn"}))}async _challenge({factorId:r,webauthn:t,friendlyName:a,signal:n},s){var i;try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:r,webauthn:t});if(!o)return{data:null,error:c};const l=n??mf.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;if(!u.name){const f=a;if(f)u.name=`${u.id}:${f}`;else{const d=(await this.client.getUser()).data.user,x=((i=d==null?void 0:d.user_metadata)===null||i===void 0?void 0:i.name)||(d==null?void 0:d.email)||(d==null?void 0:d.id)||"User";u.name=`${u.id}:${x}`}}u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=bf(o.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:f,error:h}=await Tf({publicKey:u,signal:l});return f?{data:{factorId:r,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}case"request":{const u=Cf(o.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:f,error:h}=await kf(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:l}));return f?{data:{factorId:r,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:f}},error:null}:{data:null,error:h}}}}catch(o){return le(o)?{data:null,error:o}:{data:null,error:new kt("Unexpected error in challenge",o)}}}async _verify({challengeId:r,factorId:t,webauthn:a}){return this.client.mfa.verify({factorId:t,challengeId:r,webauthn:a})}async _authenticate({factorId:r,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!t)return{data:null,error:new Ma("rpId is required for WebAuthn authentication")};try{if(!$i())return{data:null,error:new kt("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:r,webauthn:{rpId:t,rpOrigins:a},signal:n},{request:s});if(!i)return{data:null,error:o};const{webauthn:c}=i;return this._verify({factorId:r,challengeId:i.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:a,credential_response:c.credential_response}})}catch(i){return le(i)?{data:null,error:i}:{data:null,error:new kt("Unexpected error in authenticate",i)}}}async _register({friendlyName:r,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},s){if(!t)return{data:null,error:new Ma("rpId is required for WebAuthn registration")};try{if(!$i())return{data:null,error:new kt("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:r});if(!i)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===r&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:c,error:l}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:t,rpOrigins:a},signal:n},{create:s});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:a,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:l}}catch(i){return le(i)?{data:null,error:i}:{data:null,error:new kt("Unexpected error in register",i)}}}}ff();const Rf={url:Su,storageKey:bu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Cu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function ji(e,r,t){return await t()}const qt={};class Ua{get jwks(){var r,t;return(t=(r=qt[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(r){qt[this.storageKey]=Object.assign(Object.assign({},qt[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,t;return(t=(r=qt[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){qt[this.storageKey]=Object.assign(Object.assign({},qt[this.storageKey]),{cachedAt:r})}constructor(r){var t,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},Rf),r);if(this.storageKey=s.storageKey,this.instanceID=(t=Ua.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Ua.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&Qe()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new lf({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=gc(s.fetch),this.lock=s.lock||ji,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&Qe()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=uf:this.lock=ji,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Of(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:xc()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Mi(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Mi(this.memoryStorage)),Qe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i);try{await this._notifyAllSubscribers(i.data.event,i.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}s.skipAutoInitialize||this.initialize().catch(i=>{this._debug("#initialize()","error",i)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(r){if(this.throwOnError&&r&&r.error)throw r.error;return r}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${hc}) ${new Date().toISOString()}`}_debug(...r){return this.logDebugMessages&&this.logger(this._logPrefix(),...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{let t={},a="none";if(Qe()&&(t=Hu(window.location.href),this._isImplicitGrantCallback(t)?a="implicit":await this._isPKCECallback(t)&&(a="pkce")),Qe()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:s}=await this._getSessionFromURL(t,a);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Du(s)){const c=(r=s.details)===null||r===void 0?void 0:r.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:i,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return le(t)?this._returnResult({error:t}):this._returnResult({error:new kt("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,a,n;try{const s=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(t=r==null?void 0:r.options)===null||t===void 0?void 0:t.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=r==null?void 0:r.options)===null||n===void 0?void 0:n.captchaToken}},xform:Pr}),{data:i,error:o}=s;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(s){if(le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(r){var t,a,n;try{let s;if("email"in r){const{email:u,password:f,options:h}=r;let d=null,x=null;this.flowType==="pkce"&&([d,x]=await Vt(this.storage,this.storageKey)),s=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:f,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:d,code_challenge_method:x},xform:Pr})}else if("phone"in r){const{phone:u,password:f,options:h}=r;s=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},channel:(n=h==null?void 0:h.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Pr})}else throw new un("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return await Ze(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const c=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(s){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(r){try{let t;if("email"in r){const{email:s,password:i,options:o}=r;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Li})}else if("phone"in r){const{phone:s,password:i,options:o}=r;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Li})}else throw new un("You must provide either an email or phone number and a password");const{data:a,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const s=new Wt;return this._returnResult({data:{user:null,session:null},error:s})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(r){var t,a,n,s;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(a=r.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=r.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(s=r.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;switch(t){case"ethereum":return await this.signInWithEthereum(r);case"solana":return await this.signInWithSolana(r);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(r){var t,a,n,s,i,o,c,l,u,f,h;let d,x;if("message"in r)d=r.message,x=r.signature;else{const{chain:p,wallet:g,statement:_,options:E}=r;let v;if(Qe())if(typeof g=="object")v=g;else{const I=window;if("ethereum"in I&&typeof I.ethereum=="object"&&"request"in I.ethereum&&typeof I.ethereum.request=="function")v=I.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(E!=null&&E.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=g}const O=new URL((t=E==null?void 0:E.url)!==null&&t!==void 0?t:window.location.href),F=await v.request({method:"eth_requestAccounts"}).then(I=>I).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=mc(F[0]);let k=(a=E==null?void 0:E.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!k){const I=await v.request({method:"eth_chainId"});k=hf(I)}const L={domain:O.host,address:R,statement:_,uri:O.href,version:"1",chainId:k,nonce:(n=E==null?void 0:E.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(s=E==null?void 0:E.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=E==null?void 0:E.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=E==null?void 0:E.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(l=E==null?void 0:E.signInWithEthereum)===null||l===void 0?void 0:l.requestId,resources:(u=E==null?void 0:E.signInWithEthereum)===null||u===void 0?void 0:u.resources};d=pf(L),x=await v.request({method:"personal_sign",params:[df(d),R]})}try{const{data:p,error:g}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:d,signature:x},!((f=r.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=r.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Pr});if(g)throw g;if(!p||!p.session||!p.user){const _=new Wt;return this._returnResult({data:{user:null,session:null},error:_})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:g})}catch(p){if(le(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(r){var t,a,n,s,i,o,c,l,u,f,h,d;let x,p;if("message"in r)x=r.message,p=r.signature;else{const{chain:g,wallet:_,statement:E,options:v}=r;let O;if(Qe())if(typeof _=="object")O=_;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))O=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=_}const F=new URL((t=v==null?void 0:v.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in O&&O.signIn){const R=await O.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),E?{statement:E}:null));let k;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")k=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)k=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),p=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in O)||typeof O.signMessage!="function"||!("publicKey"in O)||typeof O!="object"||!O.publicKey||!("toBase58"in O.publicKey)||typeof O.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${F.host} wants you to sign in with your Solana account:`,O.publicKey.toBase58(),...E?["",E,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(n=(a=v==null?void 0:v.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((s=v==null?void 0:v.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const R=await O.signMessage(new TextEncoder().encode(x),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=R}}try{const{data:g,error:_}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:bt(p)},!((h=r.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=r.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Pr});if(_)throw _;if(!g||!g.session||!g.user){const E=new Wt;return this._returnResult({data:{user:null,session:null},error:E})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:_})}catch(g){if(le(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(r){const t=await yt(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(t??"").split("/");try{if(!a&&this.flowType==="pkce")throw new Pu;const{data:s,error:i}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:a},xform:Pr});if(await Ze(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!s||!s.session||!s.user){const o=new Wt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:n??null}),error:i})}catch(s){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(r){try{const{options:t,provider:a,token:n,access_token:s,nonce:i}=r,o=await fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Pr}),{data:c,error:l}=o;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!c||!c.session||!c.user){const u=new Wt;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:l})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(r){var t,a,n,s,i;try{if("email"in r){const{email:o,options:c}=r;let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Vt(this.storage,this.storageKey));const{error:f}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:l,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in r){const{phone:o,options:c}=r,{data:l,error:u}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:u})}throw new un("You must provide either an email or phone number.")}catch(o){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(r){var t,a;try{let n,s;"options"in r&&(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo,s=(a=r.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:o}=await fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:s}}),redirectTo:n,xform:Pr});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,l=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:l,session:c},error:null})}catch(n){if(le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(r){var t,a,n,s,i;try{let o=null,c=null;this.flowType==="pkce"&&([o,c]=await Vt(this.storage,this.storageKey));const l=await fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=r==null?void 0:r.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:sf});return!((s=l.data)===null||s===void 0)&&s.url&&Qe()&&!(!((i=r.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(o){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:a}=r;if(a)throw a;if(!t)throw new wr;const{error:n}=await fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(r){if(le(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:a,type:n,options:s}=r,{error:i}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in r){const{phone:a,type:n,options:s}=r,{data:i,error:o}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new un("You must provide either an email or phone number and a type")}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=t();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await yt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const a=r.expires_at?r.expires_at*1e3-Date.now()<Qn:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",r.expires_at),!a){if(this.userStorage){const i=await yt(this.userStorage,this.storageKey+"-user");i!=null&&i.user?r.user=i.user:r.user=ts()}if(this.storage.isServer&&r.user&&!r.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};r.user=rf(r.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:r},error:null}}const{data:n,error:s}=await this._callRefreshToken(r.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(r){if(r)return await this._getUser(r);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(r){try{return r?await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:ut}):await this._useSession(async t=>{var a,n,s;const{data:i,error:o}=t;if(o)throw o;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new wr}:await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0,xform:ut})})}catch(t){if(le(t))return es(t)&&(await this._removeSession(),await Ze(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async a=>{const{data:n,error:s}=a;if(s)throw s;if(!n.session)throw new wr;const i=n.session;let o=null,c=null;this.flowType==="pkce"&&r.email!=null&&([o,c]=await Vt(this.storage,this.storageKey));const{data:l,error:u}=await fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:ut});if(u)throw u;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(a){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(r){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new wr;const t=Date.now()/1e3;let a=t,n=!0,s=null;const{payload:i}=hn(r.access_token);if(i.exp&&(a=i.exp,n=a<=t),n){const{data:o,error:c}=await this._callRefreshToken(r.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:c}=await this._getUser(r.access_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});s={access_token:r.access_token,refresh_token:r.refresh_token,user:o.user,token_type:"bearer",expires_in:a-t,expires_at:a},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(t){if(le(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var a;if(!r){const{data:i,error:o}=t;if(o)throw o;r=(a=i.session)!==null&&a!==void 0?a:void 0}if(!(r!=null&&r.refresh_token))throw new wr;const{data:n,error:s}=await this._callRefreshToken(r.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(le(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(r,t){try{if(!Qe())throw new fn("No browser detected.");if(r.error||r.error_description||r.error_code)throw new fn(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Oi("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new fn("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Oi("No code detected.");const{data:E,error:v}=await this._exchangeCodeForSession(r.code);if(v)throw v;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:E.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:s,refresh_token:i,expires_in:o,expires_at:c,token_type:l}=r;if(!s||!o||!i||!l)throw new fn("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let h=u+f;c&&(h=parseInt(c));const d=h-u;d*1e3<=Yt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${f}s`);const x=h-f;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,u);const{data:p,error:g}=await this._getUser(s);if(g)throw g;const _={provider_token:a,provider_refresh_token:n,access_token:s,expires_in:f,expires_at:h,refresh_token:i,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:_,redirectType:r.type},error:null})}catch(a){if(le(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(r){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),r):!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await yt(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var a;const{data:n,error:s}=t;if(s&&!es(s))return this._returnResult({error:s});const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:o}=await this.admin.signOut(i,r);if(o&&!(Iu(o)&&(o.status===404||o.status===401||o.status===403)||es(o)))return this._returnResult({error:o})}return r!=="others"&&(await this._removeSession(),await Ze(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(r){const t=ju(),a={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,a),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:a}}}async _emitInitialSession(r){return await this._useSession(async t=>{var a,n;try{const{data:{session:s},error:i}=t;if(i)throw i;await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",r,"session",s)}catch(s){await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",s),console.error(s)}})}async resetPasswordForEmail(r,t={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Vt(this.storage,this.storageKey,!0));try{return await fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var r;try{const{data:t,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(r){return"token"in r?this.linkIdentityIdToken(r):this.linkIdentityOAuth(r)}async linkIdentityOAuth(r){var t;try{const{data:a,error:n}=await this._useSession(async s=>{var i,o,c,l,u;const{data:f,error:h}=s;if(h)throw h;const d=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(i=r.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=r.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=r.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await fe(this.fetch,"GET",d,{headers:this.headers,jwt:(u=(l=f.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Qe()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),this._returnResult({data:{provider:r.provider,url:a==null?void 0:a.url},error:null})}catch(a){if(le(a))return this._returnResult({data:{provider:r.provider,url:null},error:a});throw a}}async linkIdentityIdToken(r){return await this._useSession(async t=>{var a;try{const{error:n,data:{session:s}}=t;if(n)throw n;const{options:i,provider:o,token:c,access_token:l,nonce:u}=r,f=await fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=s==null?void 0:s.access_token)!==null&&a!==void 0?a:void 0,body:{provider:o,id_token:c,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Pr}),{data:h,error:d}=f;return d?this._returnResult({data:{user:null,session:null},error:d}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Wt}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:d}))}catch(n){if(await Ze(this.storage,`${this.storageKey}-code-verifier`),le(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(r){try{return await this._useSession(async t=>{var a,n;const{data:s,error:i}=t;if(i)throw i;return await fe(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(n=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await Gu(async n=>(n>0&&await Vu(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:Pr})),(n,s)=>{const i=200*Math.pow(2,n);return s&&rs(s)&&Date.now()+i-a<Yt})}catch(a){if(this._debug(t,"error",a),le(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const a=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",a),Qe()&&!t.skipBrowserRedirect&&window.location.assign(a),{data:{provider:r,url:a},error:null}}async _recoverAndRefresh(){var r,t;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await yt(this.storage,this.storageKey);if(n&&this.userStorage){let i=await yt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Jt(this.userStorage,this.storageKey+"-user",i)),n.user=(r=i==null?void 0:i.user)!==null&&r!==void 0?r:ts()}else if(n&&!n.user&&!n.user){const i=await yt(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await Ze(this.storage,this.storageKey+"-user"),await Jt(this.storage,this.storageKey,n)):n.user=ts()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const s=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Qn;if(this._debug(a,`session has${s?"":" not"} expired with margin of ${Qn}s`),s){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),rs(i)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(n.access_token);!o&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(a,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(r){var t,a;if(!r)throw new wr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Vn;const{data:s,error:i}=await this._refreshAccessToken(r);if(i)throw i;if(!s.session)throw new wr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(n,"error",s),le(s)){const i={data:null,error:s};return rs(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(s),s}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(r,t,a=!0){const n=`#_notifyAllSubscribers(${r})`;this._debug(n,"begin",t,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:r,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(r,t)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(n,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await Ze(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},r),a=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&t.user&&await Jt(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const s=Pi(n);await Jt(this.storage,this.storageKey,s)}else{const n=Pi(t);await Jt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ze(this.storage,this.storageKey),await Ze(this.storage,this.storageKey+"-code-verifier"),await Ze(this.storage,this.storageKey+"-user"),this.userStorage&&await Ze(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Qe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),Yt);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:a}}=t;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-r)/Yt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Yt}ms, refresh threshold is ${Es} ticks`),n<=Es&&await this._callRefreshToken(a.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof vc)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(r){this._debug("#visibilityChangedCallback","error",r)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,a){const n=[`provider=${encodeURIComponent(t)}`];if(a!=null&&a.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[s,i]=await Vt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(o.toString())}if(a!=null&&a.queryParams){const s=new URLSearchParams(a.queryParams);n.push(s.toString())}return a!=null&&a.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${r}?${n.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;return s?this._returnResult({data:null,error:s}):await fe(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(r){try{return await this._useSession(async t=>{var a,n;const{data:s,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:r.factorType==="totp"?{issuer:r.issuer}:{}),{data:c,error:l}=await fe(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return l?this._returnResult({data:null,error:l}):(r.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _verify(r){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({challenge_id:r.challengeId},"webauthn"in r?{webauthn:Object.assign(Object.assign({},r.webauthn),{credential_response:r.webauthn.type==="create"?yf(r.webauthn.credential_response):Ef(r.webauthn.credential_response)})}:{code:r.code}),{data:o,error:c}=await fe(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:i,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:c}))})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(r){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=await fe(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:r,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:_f(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:wf(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(r){const{data:t,error:a}=await this._challenge({factorId:r.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){var r;const{data:{user:t},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const s of(r=t==null?void 0:t.factors)!==null&&r!==void 0?r:[])n.all.push(s),s.status==="verified"&&n[s.factor_type].push(s);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(r){var t,a,n,s;if(r)try{const{payload:d}=hn(r);let x=null;d.aal&&(x=d.aal);let p=x;const{data:{user:g},error:_}=await this.getUser(r);if(_)return this._returnResult({data:null,error:_});((a=(t=g==null?void 0:g.factors)===null||t===void 0?void 0:t.filter(O=>O.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(p="aal2");const v=d.amr||[];return{data:{currentLevel:x,nextLevel:p,currentAuthenticationMethods:v},error:null}}catch(d){if(le(d))return this._returnResult({data:null,error:d});throw d}const{data:{session:i},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=hn(i.access_token);let l=null;c.aal&&(l=c.aal);let u=l;((s=(n=i.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(u="aal2");const h=c.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:h},error:null}}async _getAuthorizationDetails(r){try{return await this._useSession(async t=>{const{data:{session:a},error:n}=t;return n?this._returnResult({data:null,error:n}):a?await fe(this.fetch,"GET",`${this.url}/oauth/authorizations/${r}`,{headers:this.headers,jwt:a.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new wr})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(r,t){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new wr});const i=await fe(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&Qe()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(a){if(le(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(r,t){try{return await this._useSession(async a=>{const{data:{session:n},error:s}=a;if(s)return this._returnResult({data:null,error:s});if(!n)return this._returnResult({data:null,error:new wr});const i=await fe(this.fetch,"POST",`${this.url}/oauth/authorizations/${r}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&Qe()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(a){if(le(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async r=>{const{data:{session:t},error:a}=r;return a?this._returnResult({data:null,error:a}):t?await fe(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new wr})})}catch(r){if(le(r))return this._returnResult({data:null,error:r});throw r}}async _revokeOAuthGrant(r){try{return await this._useSession(async t=>{const{data:{session:a},error:n}=t;return n?this._returnResult({data:null,error:n}):a?(await fe(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:r.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new wr})})}catch(t){if(le(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(r,t={keys:[]}){let a=t.keys.find(o=>o.kid===r);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(o=>o.kid===r),a&&this.jwks_cached_at+Ru>n)return a;const{data:s,error:i}=await fe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=n,a=s.keys.find(o=>o.kid===r),!a)?null:a}async getClaims(r,t={}){try{let a=r;if(!a){const{data:d,error:x}=await this.getSession();if(x||!d.session)return this._returnResult({data:null,error:x});a=d.session.access_token}const{header:n,payload:s,signature:i,raw:{header:o,payload:c}}=hn(a);t!=null&&t.allowExpired||Zu(s.exp);const l=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!l){const{error:d}=await this.getUser(a);if(d)throw d;return{data:{claims:s,header:n,signature:i},error:null}}const u=Qu(n.alg),f=await crypto.subtle.importKey("jwk",l,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,Uu(`${o}.${c}`)))throw new As("Invalid JWT signature");return{data:{claims:s,header:n,signature:i},error:null}}catch(a){if(le(a))return this._returnResult({data:null,error:a});throw a}}}Ua.nextInstanceID={};const Ff=Ua,If="2.97.0";let ma="";typeof Deno<"u"?ma="deno":typeof document<"u"?ma="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ma="react-native":ma="node";const Df={"X-Client-Info":`supabase-js-${ma}/${If}`},Pf={headers:Df},Nf={schema:"public"},Lf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Bf={};function $a(e){"@babel/helpers - typeof";return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},$a(e)}function Mf(e,r){if($a(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,r);if($a(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Uf(e){var r=Mf(e,"string");return $a(r)=="symbol"?r:r+""}function $f(e,r,t){return(r=Uf(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Hi(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);r&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function Pe(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Hi(Object(t),!0).forEach(function(a){$f(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Hi(Object(t)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}const jf=e=>e?(...r)=>e(...r):(...r)=>fetch(...r),Hf=()=>Headers,Wf=(e,r,t)=>{const a=jf(t),n=Hf();return async(s,i)=>{var o;const c=(o=await r())!==null&&o!==void 0?o:e;let l=new n(i==null?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${c}`),a(s,Pe(Pe({},i),{},{headers:l}))}};function Vf(e){return e.endsWith("/")?e:e+"/"}function Gf(e,r){var t,a;const{db:n,auth:s,realtime:i,global:o}=e,{db:c,auth:l,realtime:u,global:f}=r,h={db:Pe(Pe({},c),n),auth:Pe(Pe({},l),s),realtime:Pe(Pe({},u),i),storage:{},global:Pe(Pe(Pe({},f),o),{},{headers:Pe(Pe({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(a=o==null?void 0:o.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Kf(e){const r=e==null?void 0:e.trim();if(!r)throw new Error("supabaseUrl is required.");if(!r.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Vf(r))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var qf=class extends Ff{constructor(e){super(e)}},zf=class{constructor(e,r,t){var a,n;this.supabaseUrl=e,this.supabaseKey=r;const s=Kf(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:Nf,realtime:Bf,auth:Pe(Pe({},Lf),{},{storageKey:i}),global:Pf},c=Gf(t??{},o);if(this.storageKey=(a=c.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var l;this.auth=this._initSupabaseAuthClient((l=c.auth)!==null&&l!==void 0?l:{},this.headers,c.global.fetch)}this.fetch=Wf(r,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Pe({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new Il(new URL("rest/v1",s).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch,timeout:c.db.timeout,urlLengthLimit:c.db.urlLengthLimit}),this.storage=new Au(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new kl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,t)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,r,t;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:t,storage:a,userStorage:n,storageKey:s,flowType:i,lock:o,debug:c,throwOnError:l},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qf({url:this.authUrl.href,headers:Pe(Pe({},h),u),storageKey:s,autoRefreshToken:e,persistSession:r,detectSessionInUrl:t,storage:a,userStorage:n,flowType:i,lock:o,debug:c,throwOnError:l,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(d=>d.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Xl(this.realtimeUrl.href,Pe(Pe({},e),{},{params:Pe(Pe({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,r,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const wc=(e,r,t)=>new zf(e,r,t);function Xf(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const r=e.version;if(r==null)return!1;const t=r.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Xf()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let dn=null;async function ur(){var t,a;if(dn)return dn;let e=rc,r=tc;try{const n=await((a=(t=chrome==null?void 0:chrome.storage)==null?void 0:t.local)==null?void 0:a.get(["supabaseUrl","supabaseAnonKey"]));n!=null&&n.supabaseUrl&&(e=n.supabaseUrl),n!=null&&n.supabaseAnonKey&&(r=n.supabaseAnonKey)}catch{}if(!e||!r)throw new Error("Supabase URL  Anon Key  .    Supabase  .");return dn=wc(e,r,{auth:{persistSession:!1,autoRefreshToken:!1}}),dn}async function Yf(e,r){const t=await ur(),{data:a,error:n}=await t.from("parser_rules").select("id, selectors").eq("dom_hash",e).eq("groupware_type",r).order("use_count",{ascending:!1}).limit(1).maybeSingle();return n?(console.error("[ApprovalGraph] getParserRule error:",n.message),null):a?{id:a.id,selectors:a.selectors}:null}async function Jf(e,r,t){const a=await ur(),{error:n}=await a.from("parser_rules").insert({dom_hash:e,groupware_type:r,selectors:t,use_count:1,created_at:new Date().toISOString()});n&&console.error("[ApprovalGraph] saveParserRule error:",n.message)}async function Zf(e){const r=await ur(),{error:t}=await r.rpc("increment_rule_use_count",{rule_id:e});if(t){const{data:a}=await r.from("parser_rules").select("use_count").eq("id",e).single();a&&await r.from("parser_rules").update({use_count:(a.use_count||0)+1}).eq("id",e)}}async function Qf(e,r){const t=await ur(),{data:a,error:n}=await t.from("documents").insert({doc_type:e.doc_type||null,subject:e.subject||null,body:e.body||null,requester_name:e.requester_name||null,requester_dept:e.requester_dept||null,approval_line:e.approval_line,created_at_doc:e.created_at||null,groupware:e.groupware||null,user_id:null,inserted_at:new Date().toISOString()}).select("id").single();if(n)throw new Error(`  : ${n.message}`);return{id:a.id}}async function eh(e,r){const t=await ur(),{error:a}=await t.from("documents").update({summary:r.summary||null,coherence:r.coherence||null,recommendation:r.recommendation||null,topics:r.topics||[],similar_docs_insight:r.similar_docs_insight||null,analyzed_at:new Date().toISOString()}).eq("id",e);a&&console.error("[ApprovalGraph] updateDocumentAnalysis error:",a.message)}async function rh(e,r){if(!e||e.length===0)return[];let a=(await ur()).from("documents").select("id, subject, doc_type, coherence, summary, topics, analyzed_at").not("analyzed_at","is",null).overlaps("topics",e).order("analyzed_at",{ascending:!1}).limit(5);r&&(a=a.neq("id",r));const{data:n,error:s}=await a;return s?(console.error("[ApprovalGraph] findSimilarDocuments error:",s.message),[]):(n||[]).map(i=>{var u,f;const o=i.topics||[],c=e.filter(h=>o.includes(h)).length,l=Math.max(e.length,o.length,1);return{id:i.id,subject:i.subject||"",doc_type:i.doc_type||"",status:((u=i.coherence)==null?void 0:u.overall_score)>=70?"approved":"pending",similarity_score:Math.round(c/l*100)/100,coherence_score:((f=i.coherence)==null?void 0:f.overall_score)??0,summary:i.summary||{request:"",basis:"",expected_effect:""},insight:""}})}async function th(){const e=await ur(),{data:r,error:t}=await e.from("coherence_rules").select("*").eq("is_active",!0).order("priority",{ascending:!0});return t?(console.warn("[ApprovalGraph] getCoherenceRules:",t.message),[]):r||[]}async function ah(e,r="lite"){const t=await ur(),{data:a,error:n}=await t.rpc("get_daily_usage",{p_user_id:e,p_mode:r});return n?(console.error("[ApprovalGraph] getDailyUsage error:",n.message),0):typeof a=="number"?a:0}async function nh(e,r="lite"){const t=await ur(),{data:a,error:n}=await t.rpc("check_usage_limit",{p_user_id:e,p_mode:r});return n?(console.error("[ApprovalGraph] checkUsageLimit error:",n.message),!0):a===!0}async function sh(e){const r=await ur(),{data:t,error:a}=await r.from("goals").select("*").eq("user_id",e).order("created_at",{ascending:!1});return a?(console.warn("[ApprovalGraph] getGoals:",a.message),[]):(t||[]).map(n=>({id:n.id,title:n.title,description:n.description||"",deadline:n.deadline,progress:n.progress,source:n.source,relatedDocIds:n.related_doc_ids||[],createdAt:n.created_at,updatedAt:n.updated_at}))}async function ih(e,r){const t=await ur(),{error:a}=await t.from("goals").upsert({id:r.id,user_id:e,title:r.title,description:r.description,deadline:r.deadline,progress:r.progress,source:r.source,related_doc_ids:r.relatedDocIds,updated_at:new Date().toISOString()});a&&console.error("[ApprovalGraph] upsertGoal:",a.message)}async function oh(e){const r=await ur(),{error:t}=await r.from("goals").delete().eq("id",e);t&&console.error("[ApprovalGraph] deleteGoal:",t.message)}async function ch(e,r=50){const t=await ur(),{data:a,error:n}=await t.from("analyses").select("id, document_id, mode, overall_score, created_at, documents(subject, doc_type)").eq("user_id",e).order("created_at",{ascending:!1}).limit(r);return n?(console.warn("[ApprovalGraph] getAnalysisHistory:",n.message),[]):(a||[]).map(s=>{var i,o;return{id:s.id,documentId:s.document_id,subject:((i=s.documents)==null?void 0:i.subject)||"",docType:((o=s.documents)==null?void 0:o.doc_type)||"",mode:s.mode,overallScore:s.overall_score,createdAt:s.created_at}})}async function Wi(e){const[r,t]=await Promise.all([ah(e,"lite"),nh(e,"pro")]);return{liteUsedToday:r,liteLimit:5,proAvailable:t}}async function lh(e,r){const t=await ur(),{error:a}=await t.from("career_documents").insert({id:r.id,user_id:e,title:r.title,content:r.content,prompt:r.prompt,history_count:r.historyCount,created_at:r.createdAt});a&&console.error("[ApprovalGraph] saveCareerDocument:",a.message)}async function uh(e){const r=await ur(),{data:t,error:a}=await r.from("career_documents").select("*").eq("user_id",e).order("created_at",{ascending:!1});return a?(console.warn("[ApprovalGraph] getCareerDocuments:",a.message),[]):(t||[]).map(n=>({id:n.id,title:n.title,content:n.content,prompt:n.prompt||"",historyCount:n.history_count||0,createdAt:n.created_at}))}async function fh(e){const r=await ur(),{error:t}=await r.from("career_documents").delete().eq("id",e);t&&console.error("[ApprovalGraph] deleteCareerDocument:",t.message)}const Ss=new Map;function yc(e,r){return`${e}::${r}`}async function hh(e,r){const t=yc(e,r),a=Ss.get(t);if(a)return a;try{const n=await Yf(e,r);if(n)return Ss.set(t,n.selectors),Zf(n.id).catch(()=>{}),n.selectors}catch(n){console.warn("[ApprovalGraph] Supabase cache lookup failed:",n)}return null}async function dh(e,r,t){const a=yc(e,r);Ss.set(a,t);try{await Jf(e,r,t)}catch(n){console.warn("[ApprovalGraph] Supabase cache write failed:",n)}}function ph(e){const r=` HTML DOM  .
 HTML         CSS  JSON .

    CSS   :
- subject:   (  /)
- body:   (  )
- doc_type:   (, ,  )
- requester_name:  
- requester_dept:  
- approval_line: /   ( ,  ,     // . "", "", "", ""      )
- created_at: /

    JSON .    .
{
  "subject": "CSS ",
  "body": "CSS ",
  "doc_type": "CSS ",
  "requester_name": "CSS ",
  "requester_dept": "CSS ",
  "approval_line": "CSS ",
  "created_at": "CSS "
}

  :
1.      (ID > class > tag).
2.     .
3.        "" .
4.  document.querySelector()   .`,t=` HTML     CSS  JSON .

HTML:
\`\`\`html
${e}
\`\`\``;return{system:r,user:t}}function xh(e){switch(e){case"application":return`1. summary:  
   - request:   (  )
   - basis:  ( / )
   - expected_effect:   (   )`;case"report":return`1. summary:  
   - request:   (  )
   - basis:  ( / )
   - expected_effect: / (    )`;case"cooperation":return`1. summary:  
   - request:   ( / )
   - basis:  ( /)
   - expected_effect:   (   )`;default:return`1. summary:  
   - request:   (  )
   - basis:  (   )
   - expected_effect:   (   )`}}function gh(e){switch(e){case"application":return`6. value_hierarchy:        ( )
   -        1  (:  ,    )
   -       1~3 
   -      3~4 
   -   ,      `;case"report":return`6. value_hierarchy:       ( )
   -       1 
   -       KPI 2~4 
   -     3~5 
   -   ,      `;case"cooperation":return`6. value_hierarchy:        ( )
   -       1 
   -      KPI 1~3 
   -     3~4 
   -   ,      `;default:return`6. value_hierarchy:       ( )
   -       1 
   -      KPI 2~4 
   -     3~5 
   -   ,      `}}function vh(e){switch(e){case"application":return`7. predicted_questions:    ( ,  3)
   -           3
   -   ,   ,    
   - : "  ?", "    ?"`;case"report":return`7. predicted_questions:    ( ,  3)
   -           3
   -  ,   ,    
   - : "    ?", "   ?"`;case"cooperation":return`7. predicted_questions:    ( ,  3)
   -           3
   -   ,  ,     
   - : "    ?", "  ?"`;default:return`7. predicted_questions:    ( ,  3)
   -    (//)       3
   -      
   - : " 5,000   ?", "   ?"`}}function mh(e,r){const t=`      .
        .
     JSON .

 :
- doc_type:   (, , ,  )
- subject:  
- body:   (//  ,  )
- requester_name:  
- requester_dept:  
- created_at: / (YYYY-MM-DD    )

 :
1.      .
2.       "" .
3. body  ,  , /     .
4.   //  body .

  (JSON ,   ):
{
  "doc_type": " ",
  "subject": "",
  "body": " ",
  "requester_name": " ",
  "requester_dept": " ",
  "created_at": ""
}`,n=`     .${r&&r!=="unknown"?`
: ${r}`:""}

:
"""
${e}
"""`;return{system:t,user:n}}function _h(e,r,t,a){const n=wl(e.doc_type||""),s=`      .
      JSON .

 :
${xh(n)}

2. coherence:   ( ,  100)

       
      ,     .
    ,         3~5 .
     (weight)   100 .
         .

   [  ]
   -  : - ,   ,   
   -  :   //   
   -  :     , / 
   -  :   ( ,  ),  
   - 5W1H : Who/What/When/Where/Why/How  
   -  :  ,  ,  
   -  :   , / 
   -  :   ,  
   -  :    (  )

   [  ]
   - /  ( ,  ,  ):  ,   
   - / (,  ):  ,   
   -  (,  ): 5W1H ,   
   -  (,  ):  ,   
   -  (,  ): 5W1H ,   

   - overall_score:    (0~100 )    score   
   - checks:     ( 3~5 )
      : { "item": " ", "result": "PASS|WARN|FAIL", "detail": "", "weight": , "score": , "evidence_refs": [" 1", " 2"] }

         ( ):
     - score 0 ~ weight  .      
     - result : score  weight0.8  "PASS", score  weight0.4  "WARN",   "FAIL"
     - overall_score =   score  (0~100)
     -   weight   100

        

     [  ]
     - PASS     .   WARN
     - " ", " "    PASS   
     -      ,   WARN 
     - 100        

     [evidence_refs detail     ]

     [evidence_refs   ]
     -  "(body)"      
     - (subject)    .    
     -        (15~80)
     -  2,  5.   
     -  : [" 3  15%   ", ": 2025 4 1"]
     -  : ["  "]     

     [detail  ]
     -    . "  "    
     -      ''   
     -   "~ ", "~ "  

         

     [    ]
     -    "===  ==="  .
     -   (, , , , ,  )   .
     - "===    ==="    ,  //    .

     [ ]
     - (,  ) HTML      .
          (: '  ', '  ', ' ', '  ') HTML   .     .
     -      .      .
     - //         .

     [  ]
     - "===   () ==="  ,        ,    .
     -     /    .
     -  ()   ,      .      .

     [    ]
     -  "" ,         .
     -     ""    .
     -        .       .
     -  " OO" "OO"  .         .
     -  " OO" "()OO"  .      .
     -   /     .
     - /  (: "OO--2026-0001")       .

     [/]
     - ()     (  ).
     -   (, ,  ) /    . : 1  2   .  " "  .
     - "   "   .

     []
     -   "===  ==="    .    .
     -  FAIL/WARN         .
     -   :        .
     -   : detail "", "", ""   result FAIL/WARN  .     PASS  .

3. similar_docs_insight:    ()
   -      ,   

4. recommendation:    ()
   -     ( / /  )

5. topics:    ( )
   -     3~5

${gh(n)}

   :
   {
     "business_goal": " /",
     "goal_description": "    (1~2)",
     "kpis": [
       { "name": "KPI", "current": " /", "target": " /", "relevance": "high|medium|low" }
     ],
     "value_chain": [" ()", " ", " ", " "],
     "impact_score": "high|medium|low"
   }

   :
   - business_goal:       1
   - kpis:  KPI       ,   
   - value_chain:     ...      
   - impact_score:      

${vh(n)}

    JSON . checks   3~5   :
{
  "summary": { "request": "...", "basis": "...", "expected_effect": "..." },
  "coherence": {
    "overall_score": 75,
    "checks": [
      { "item": "1", "result": "WARN", "detail": "...", "weight": 30, "score": 20, "evidence_refs": ["  1", "  2"] },
      { "item": "2", "result": "PASS", "detail": "...", "weight": 25, "score": 25, "evidence_refs": [" ", " "] },
      { "item": "3", "result": "WARN", "detail": "...", "weight": 25, "score": 15, "evidence_refs": ["1", "2"] },
      { "item": "4", "result": "PASS", "detail": "...", "weight": 10, "score": 10, "evidence_refs": [""] },
      { "item": "5", "result": "WARN", "detail": "...", "weight": 10, "score": 5, "evidence_refs": ["  "] }
    ]
  },
  "similar_docs_insight": "...",
  "recommendation": "...",
  "topics": ["...", "..."],
  "value_hierarchy": {
    "business_goal": "",
    "goal_description": " ",
    "kpis": [{ "name": "KPI", "current": "", "target": "", "relevance": "high" }],
    "value_chain": ["", " ", " ", ""],
    "impact_score": "high"
  },
  "predicted_questions": ["1", "2", "3"]
}`,i=r.length>0?r.map((h,d)=>{var x;return`[ ${d+1}] : ${h.subject||""}, : ${h.doc_type||""}, : ${h.status||""}, : ${h.coherence_score??"N/A"}, : ${((x=h.summary)==null?void 0:x.request)||""}`}).join(`
`):"  .",o=t.length>0?t.map((h,d)=>`[ ${d+1}] ${h.name||h.rule_name||""}: ${h.description||h.rule_description||""}`).join(`
`):"   .",c=e.attachments&&e.attachments.length>0?e.attachments.map((h,d)=>`[ ${d+1}] ${h.name} (${h.type}, ${h.size||" "})`).join(`
`):" ",l=e.body&&e.body.trim().length>=20,u=l?e.body:e.rawText?Ms(e.rawText,e.subject):"  ",f=`   .

===   (      ) ===
 : ${e.doc_type||""}
: ${e.subject||""}
: ${e.requester_name||""} (${e.requester_dept||" "})
: ${e.created_at||""}

===  ===
${e.approval_line.length>0?e.approval_line.map(h=>`- ${h.name} (${h.position}) [${h.status}]`).join(`
`):"  "}

===  ( ) ===
${u}

${e.tableMarkdown?`===   () ===
${e.tableMarkdown}`:""}

${l&&e.rawText?`===    (   //  ,   ) ===
${e.rawText}`:""}
===  ===
${c}

===   ===
${i}

${a&&a.length>0?`===    ( ) ===
     .    .
${a.map(h=>`- ${h.category}: ${h.userMessage}`).join(`
`)}

`:""}===   ===
${o}`;return{system:s,user:f}}function wh(e,r){if(r<=0)return"WARN";const t=e/r;return t>=.8?"PASS":t>=.4?"WARN":"FAIL"}function yh(e,r){return e==="PASS"?r:e==="WARN"?Math.round(r*.5):0}const Eh="https://api.openai.com/v1/chat/completions",Ec="gpt-4o",Th="gpt-4o";async function kh(){var r,t;let e="";try{const a=await((t=(r=chrome==null?void 0:chrome.storage)==null?void 0:r.local)==null?void 0:t.get(["openai_api_key"]));a!=null&&a.openai_api_key&&(e=a.openai_api_key)}catch{}if(!e)throw new Error("OpenAI API   .    API  .");return e}async function Ja(e){var s,i,o;const r=await kh(),t=await fetch(Eh,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({model:e.model,messages:e.messages,max_tokens:e.max_tokens,temperature:e.temperature??.2,response_format:e.response_format})});if(!t.ok){const c=await t.text().catch(()=>""),l=t.statusText||"Unknown error";throw new Error(`OpenAI API  (${t.status} ${l}): ${c}`)}const a=await t.json(),n=(o=(i=(s=a==null?void 0:a.choices)==null?void 0:s[0])==null?void 0:i.message)==null?void 0:o.content;if(!n)throw new Error("OpenAI  content .");return n}async function Ah(e){const{system:r,user:t}=ph(e),a=await Ja({model:Ec,messages:[{role:"system",content:r},{role:"user",content:t}],max_tokens:1e3,temperature:.1,response_format:{type:"json_object"}});let n;try{n=JSON.parse(a)}catch{throw new Error(`LLM  JSON  : ${a.slice(0,200)}`)}return{subject:typeof n.subject=="string"?n.subject:"",body:typeof n.body=="string"?n.body:"",doc_type:typeof n.doc_type=="string"?n.doc_type:"",requester_name:typeof n.requester_name=="string"?n.requester_name:"",requester_dept:typeof n.requester_dept=="string"?n.requester_dept:"",approval_line:typeof n.approval_line=="string"?n.approval_line:"",created_at:typeof n.created_at=="string"?n.created_at:""}}function Sh(e){return!e.body||e.body.trim().length<ac||!e.subject}async function bh(e,r){const{system:t,user:a}=mh(e,r),n=await Ja({model:Ec,messages:[{role:"system",content:t},{role:"user",content:a}],max_tokens:2e3,temperature:.1,response_format:{type:"json_object"}});let s;try{s=JSON.parse(n)}catch{return{doc_type:"",subject:"",body:"",requester_name:"",requester_dept:"",created_at:""}}return{doc_type:typeof s.doc_type=="string"?s.doc_type:"",subject:typeof s.subject=="string"?s.subject:"",body:typeof s.body=="string"?s.body:"",requester_name:typeof s.requester_name=="string"?s.requester_name:"",requester_dept:typeof s.requester_dept=="string"?s.requester_dept:"",created_at:typeof s.created_at=="string"?s.created_at:""}}async function Ch(e,r,t,a,n){if(Sh(e)&&e.rawText&&((!e.body||e.body.trim().length<ac)&&(e.body=Ms(e.rawText,e.subject)),!e.subject)){const F=await bh(e.rawText,e.groupware);F.subject&&(e.subject=F.subject),!e.requester_name&&F.requester_name&&(e.requester_name=F.requester_name),!e.requester_dept&&F.requester_dept&&(e.requester_dept=F.requester_dept),!e.doc_type&&F.doc_type&&(e.doc_type=F.doc_type),!e.created_at&&F.created_at&&(e.created_at=F.created_at)}const{system:s,user:i}=_h(e,r,t,n);let o=i;if(a&&a.length>0){const F=a.map(R=>`=== : ${R.name} ===
${R.content.slice(0,3e3)}`).join(`

`);o+=`

===   () ===
${F}`}const c=e.bodyImages&&e.bodyImages.length>0;let l;if(c){const F=[{type:"text",text:o+`

    /.       .`}];for(const R of e.bodyImages)F.push({type:"image_url",image_url:{url:R,detail:"low"}});l={role:"user",content:F}}else l={role:"user",content:o};const u=await Ja({model:Th,messages:[{role:"system",content:s},l],max_tokens:5e3,temperature:.3,response_format:{type:"json_object"}});let f;try{f=JSON.parse(u)}catch{throw new Error(`  JSON  : ${u.slice(0,200)}`)}const h=f.summary||{request:"",basis:"",expected_effect:""},d=f.coherence||{overall_score:0,checks:[]};typeof d.overall_score!="number"&&(d.overall_score=0),Array.isArray(d.checks)||(d.checks=[]),d.checks=d.checks.map(F=>{const R=typeof F.item=="string"?F.item:"",k=typeof F.weight=="number"&&F.weight>0?F.weight:20,L=typeof F.score=="number"?F.score:-1,I=["PASS","WARN","FAIL"].includes(F.result)?F.result:null,G=L>=0?Math.min(Math.round(L),k):yh(I||"WARN",k),W=wh(G,k),N=Array.isArray(F.evidence_refs)?F.evidence_refs.filter(X=>typeof X=="string"&&X.length>0):[];return{item:R,result:W,detail:typeof F.detail=="string"?F.detail:"",weight:k,score:G,evidence_refs:N}});const x=d.checks.reduce((F,R)=>F+R.score,0);d.overall_score=Math.round(x);const p=typeof f.recommendation=="string"?f.recommendation:"",g=Array.isArray(f.topics)?f.topics.filter(F=>typeof F=="string"):[],_=typeof f.similar_docs_insight=="string"?f.similar_docs_insight:"",E=Array.isArray(f.causal_chains)?f.causal_chains:[],v=f.value_hierarchy||null,O=Array.isArray(f.predicted_questions)?f.predicted_questions.filter(F=>typeof F=="string").slice(0,3):[];return{summary:h,coherence:d,recommendation:p,topics:g,similar_docs_insight:_,causal_chains:E,value_hierarchy:v,predicted_questions:O}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Tc=1252,Oh=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],js={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hs=function(e){Oh.indexOf(e)!=-1&&(Tc=js[0]=e)};function Rh(){Hs(1252)}var Ur=function(e){Hs(e)};function kc(){Ur(1200),Rh()}function Vi(e){for(var r=[],t=0,a=e.length;t<a;++t)r[t]=e.charCodeAt(t);return r}function Fh(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function Ac(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var _a=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?Fh(e.slice(2)):r==254&&t==255?Ac(e.slice(2)):r==65279?e.slice(1):e},pn=function(r){return String.fromCharCode(r)},Gi=function(r){return String.fromCharCode(r)},ja,ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ki(e){for(var r="",t=0,a=0,n=0,s=0,i=0,o=0,c=0,l=0;l<e.length;)t=e.charCodeAt(l++),s=t>>2,a=e.charCodeAt(l++),i=(t&3)<<4|a>>4,n=e.charCodeAt(l++),o=(a&15)<<2|n>>6,c=n&63,isNaN(a)?o=c=64:isNaN(n)&&(c=64),r+=ht.charAt(s)+ht.charAt(i)+ht.charAt(o)+ht.charAt(c);return r}function kr(e){var r="",t=0,a=0,n=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)s=ht.indexOf(e.charAt(l++)),i=ht.indexOf(e.charAt(l++)),t=s<<2|i>>4,r+=String.fromCharCode(t),o=ht.indexOf(e.charAt(l++)),a=(i&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(a)),c=ht.indexOf(e.charAt(l++)),n=(o&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var we=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Lt=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function xt(e){return we?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qi(e){return we?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Br=function(r){return we?Lt(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function Bt(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Ws(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ws(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var ft=we?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Lt(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var a=new Uint8Array(t),n=0;for(r=0,t=0;r<e.length;t+=n,++r)if(n=e[r].length,e[r]instanceof Uint8Array)a.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";a.set(new Uint8Array(e[r]),t)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function Ih(e){for(var r=[],t=0,a=e.length+250,n=xt(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)n[t++]=i;else if(i<2048)n[t++]=192|i>>6&31,n[t++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;n[t++]=240|i>>8&7,n[t++]=128|i>>2&63,n[t++]=128|o>>6&15|(i&3)<<4,n[t++]=128|o&63}else n[t++]=224|i>>12&15,n[t++]=128|i>>6&63,n[t++]=128|i&63;t>a&&(r.push(n.slice(0,t)),t=0,n=xt(65535),a=65530)}return r.push(n.slice(0,t)),ft(r)}var gr=/\u0000/g,wa=/[\u0001-\u0006]/g;function ta(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function $r(e,r){var t=""+e;return t.length>=r?t:Ne("0",r-t.length)+t}function Vs(e,r){var t=""+e;return t.length>=r?t:Ne(" ",r-t.length)+t}function On(e,r){var t=""+e;return t.length>=r?t:t+Ne(" ",r-t.length)}function Dh(e,r){var t=""+Math.round(e);return t.length>=r?t:Ne("0",r-t.length)+t}function Ph(e,r){var t=""+e;return t.length>=r?t:Ne("0",r-t.length)+t}var zi=Math.pow(2,32);function zt(e,r){if(e>zi||e<-zi)return Dh(e,r);var t=Math.round(e);return Ph(t,r)}function Rn(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Xi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ns=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Nh(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Yi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Lh={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Fn(e,r,t){for(var a=e<0?-1:1,n=e*a,s=0,i=1,o=0,c=1,l=0,u=0,f=Math.floor(n);l<r&&(f=Math.floor(n),o=f*i+s,u=f*l+c,!(n-f<5e-8));)n=1/(n-f),s=i,i=o,c=l,l=u;if(u>r&&(l>r?(u=c,o=s):(u=l,o=i)),!t)return[0,a*o,u];var h=Math.floor(a*o/u);return[h,a*o-h*u,u]}function Ct(e,r,t){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,i=[],o={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)i=t?[1317,10,29]:[1900,2,29],s=3;else if(a===0)i=t?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),a<60&&(s=(s+6)%7),t&&(s=Hh(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=s,o}var Sc=new Date(1899,11,31,0,0,0),Bh=Sc.getTime(),Mh=new Date(1900,2,1,0,0,0);function bc(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=Mh&&(t+=24*60*60*1e3),(t-(Bh+(e.getTimezoneOffset()-Sc.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Gs(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Uh(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function $h(e){var r=e<0?12:11,t=Gs(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function jh(e){var r=Gs(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Ha(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=$h(e):r===10?t=e.toFixed(10).substr(0,12):t=jh(e),Gs(Uh(t.toUpperCase()))}function Dt(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Ha(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Rr(14,bc(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Hh(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function Wh(e,r,t,a){var n="",s=0,i=0,o=t.y,c,l=0;switch(e){case 98:o=t.y+543;case 121:switch(r.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(r.length){case 1:case 2:c=t.m,l=r.length;break;case 3:return ns[t.m-1][1];case 5:return ns[t.m-1][0];default:return ns[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=t.d,l=r.length;break;case 3:return Xi[t.q][0];default:return Xi[t.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(t.H+11)%12,l=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=t.H,l=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=t.M,l=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?$r(t.S,r.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,s=Math.round(i*(t.S+t.u)),s>=60*i&&(s=0),r==="s"?s===0?"0":""+s/i:(n=$r(s,2+a),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}l=r.length===3?1:2;break;case 101:c=o,l=1;break}var u=l>0?$r(c,l):"";return u}function dt(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,a=e.substr(0,t);t!=e.length;t+=r)a+=(a.length>0?",":"")+e.substr(t,r);return a}var Cc=/%/g;function Vh(e,r,t){var a=r.replace(Cc,""),n=r.length-a.length;return rt(e,a,t*Math.pow(10,2*n))+Ne("%",n)}function Gh(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return rt(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Oc(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Oc(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(r/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),t.indexOf("e")===-1){var i=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,n)+"."+t.substr(2+n),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Rc=/# (\?+)( ?)\/( ?)(\d+)/;function Kh(e,r,t){var a=parseInt(e[4],10),n=Math.round(r*a),s=Math.floor(n/a),i=n-s*a,o=a;return t+(s===0?"":""+s)+" "+(i===0?Ne(" ",e[1].length+1+e[4].length):Vs(i,e[1].length)+e[2]+"/"+e[3]+$r(o,e[4].length))}function qh(e,r,t){return t+(r===0?"":""+r)+Ne(" ",e[1].length+2+e[4].length)}var Fc=/^#*0*\.([0#]+)/,Ic=/\).*[0#]/,Dc=/\(###\) ###\\?-####/;function dr(e){for(var r="",t,a=0;a!=e.length;++a)switch(t=e.charCodeAt(a)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Ji(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Zi(e,r){var t=e-Math.floor(e),a=Math.pow(10,r);return r<(""+Math.round(t*a)).length?0:Math.round(t*a)}function zh(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function Xh(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Cr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ic)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Cr("n",a,t):"("+Cr("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Gh(e,r,t);if(r.indexOf("%")!==-1)return Vh(e,r,t);if(r.indexOf("E")!==-1)return Oc(r,t);if(r.charCodeAt(0)===36)return"$"+Cr(e,r.substr(r.charAt(1)==" "?2:1),t);var n,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+zt(c,r.length);if(r.match(/^[#?]+$/))return n=zt(t,0),n==="0"&&(n=""),n.length>r.length?n:dr(r.substr(0,r.length-n.length))+n;if(s=r.match(Rc))return Kh(s,c,l);if(r.match(/^#+0+$/))return l+zt(c,r.length-r.indexOf("0"));if(s=r.match(Fc))return n=Ji(t,s[1].length).replace(/^([^\.]+)$/,"$1."+dr(s[1])).replace(/\.$/,"."+dr(s[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Ne("0",dr(s[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+Ji(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+dt(zt(c,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Cr(e,r,-t):dt(""+(Math.floor(t)+zh(t,s[1].length)))+"."+$r(Zi(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return Cr(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ta(Cr(e,r.replace(/[\\-]/g,""),t)),i=0,ta(ta(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(r.match(Dc))return n=Cr(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Fn(c,Math.pow(10,i)-1,!1),n=""+l,u=rt("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=On(o[2],i),u.length<s[4].length&&(u=dr(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Fn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Vs(o[1],i)+s[2]+"/"+s[3]+On(o[2],i):Ne(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return n=zt(t,0),r.length<=n.length?n:dr(r.substr(0,r.length-n.length))+n;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=r.indexOf(".")-i,h=r.length-n.length-f;return dr(r.substr(0,f)+n+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return i=Zi(t,s[1].length),t<0?"-"+Cr(e,r,-t):dt(Xh(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?$r(0,3-x.length):"")+x})+"."+$r(i,s[1].length);switch(r){case"###,##0.00":return Cr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var d=dt(zt(c,0));return d!=="0"?l+d:"";case"###,###.00":return Cr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Cr(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Yh(e,r,t){for(var a=r.length-1;r.charCodeAt(a-1)===44;)--a;return rt(e,r.substr(0,a),t/Math.pow(10,3*(r.length-a)))}function Jh(e,r,t){var a=r.replace(Cc,""),n=r.length-a.length;return rt(e,a,t*Math.pow(10,2*n))+Ne("%",n)}function Pc(e,r){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Pc(e,-r);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%n;if(s<0&&(s+=n),t=(r/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!t.match(/[Ee]/)){var i=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+s):t+="E+"+(i-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,u){return c+l+u.substr(0,(n+s)%n)+"."+u.substr(s)+"E"})}else t=r.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Gr(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ic)){var a=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gr("n",a,t):"("+Gr("n",a,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Yh(e,r,t);if(r.indexOf("%")!==-1)return Jh(e,r,t);if(r.indexOf("E")!==-1)return Pc(r,t);if(r.charCodeAt(0)===36)return"$"+Gr(e,r.substr(r.charAt(1)==" "?2:1),t);var n,s,i,o,c=Math.abs(t),l=t<0?"-":"";if(r.match(/^00+$/))return l+$r(c,r.length);if(r.match(/^[#?]+$/))return n=""+t,t===0&&(n=""),n.length>r.length?n:dr(r.substr(0,r.length-n.length))+n;if(s=r.match(Rc))return qh(s,c,l);if(r.match(/^#+0+$/))return l+$r(c,r.length-r.indexOf("0"));if(s=r.match(Fc))return n=(""+t).replace(/^([^\.]+)$/,"$1."+dr(s[1])).replace(/\.$/,"."+dr(s[1])),n=n.replace(/\.(\d*)$/,function(x,p){return"."+p+Ne("0",dr(s[1]).length-p.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return l+dt(""+c);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gr(e,r,-t):dt(""+t)+"."+Ne("0",s[1].length);if(s=r.match(/^#,#*,#0/))return Gr(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=ta(Gr(e,r.replace(/[\\-]/g,""),t)),i=0,ta(ta(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<n.length?n.charAt(i++):x==="0"?"0":""}));if(r.match(Dc))return n=Gr(e,"##########",t),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=Fn(c,Math.pow(10,i)-1,!1),n=""+l,u=rt("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+s[2]+"/"+s[3],u=On(o[2],i),u.length<s[4].length&&(u=dr(s[4].substr(s[4].length-u.length))+u),n+=u,n;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=Fn(c,Math.pow(10,i)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Vs(o[1],i)+s[2]+"/"+s[3]+On(o[2],i):Ne(" ",2*i+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return n=""+t,r.length<=n.length?n:dr(r.substr(0,r.length-n.length))+n;if(s=r.match(/^([#0]+)\.([#0]+)$/)){n=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=n.indexOf(".");var f=r.indexOf(".")-i,h=r.length-n.length-f;return dr(r.substr(0,f)+n+r.substr(r.length-h))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Gr(e,r,-t):dt(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?$r(0,3-x.length):"")+x})+"."+$r(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var d=dt(""+c);return d!=="0"?l+d:"";default:if(r.match(/\.[0#?]*$/))return Gr(e,r.slice(0,r.lastIndexOf(".")),t)+dr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function rt(e,r,t){return(t|0)===t?Gr(e,r,t):Cr(e,r,t)}function Zh(e){for(var r=[],t=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:r[r.length]=e.substr(n,a-n),n=a+1}if(r[r.length]=e.substr(n),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Nc=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ca(e){for(var r=0,t="",a="";r<e.length;)switch(t=e.charAt(r)){case"G":Rn(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(a=t;e.charAt(r++)!=="]"&&r<e.length;)a+=e.charAt(r);if(a.match(Nc))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Qh(e,r,t,a){for(var n=[],s="",i=0,o="",c="t",l,u,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Rn(e,i))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);n[n.length]={t:"t",v:s},++i;break;case"\\":var d=e.charAt(++i),x=d==="("||d===")"?d:"t";n[n.length]={t:x,v:d},++i;break;case"_":n[n.length]={t:"t",v:" "},i+=2;break;case"@":n[n.length]={t:"T",v:r},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(l==null&&(l=Ct(r,t,e.charAt(i+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||l==null&&(l=Ct(r,t),l==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(l==null&&(l=Ct(r,t)),e.substr(i,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(l!=null&&(p.v=l.H>=12?"":""),p.t="T",i+=5,h="h"):(p.t="t",++i),l==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Nc)){if(l==null&&(l=Ct(r,t),l==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ca(e)||(n[n.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;n[n.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;n[n.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:o,v:o},++i;break;case"$":n[n.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++i;break}var g=0,_=0,E;for(i=n.length-1,c="t";i>=0;--i)switch(n[i].t){case"h":case"H":n[i].t=h,c="h",g<1&&(g=1);break;case"s":(E=n[i].v.match(/\.0+$/))&&(_=Math.max(_,E[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[i].t;break;case"m":c==="s"&&(n[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[i].v.match(/[Hh]/)&&(g=1),g<2&&n[i].v.match(/[Mm]/)&&(g=2),g<3&&n[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",O;for(i=0;i<n.length;++i)switch(n[i].t){case"t":case"T":case" ":case"D":break;case"X":n[i].v="",n[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[i].v=Wh(n[i].t.charCodeAt(0),n[i].v,l,_),n[i].t="t";break;case"n":case"?":for(O=i+1;n[O]!=null&&((o=n[O].t)==="?"||o==="D"||(o===" "||o==="t")&&n[O+1]!=null&&(n[O+1].t==="?"||n[O+1].t==="t"&&n[O+1].v==="/")||n[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[O].v==="/"||n[O].v===" "&&n[O+1]!=null&&n[O+1].t=="?"));)n[i].v+=n[O].v,n[O]={v:"",t:";"},++O;v+=n[i].v,i=O-1;break;case"G":n[i].t="t",n[i].v=Dt(r,t);break}var F="",R,k;if(v.length>0){v.charCodeAt(0)==40?(R=r<0&&v.charCodeAt(0)===45?-r:r,k=rt("n",v,R)):(R=r<0&&a>1?-r:r,k=rt("n",v,R),R<0&&n[0]&&n[0].t=="t"&&(k=k.substr(1),n[0].v="-"+n[0].v)),O=k.length-1;var L=n.length;for(i=0;i<n.length;++i)if(n[i]!=null&&n[i].t!="t"&&n[i].v.indexOf(".")>-1){L=i;break}var I=n.length;if(L===n.length&&k.indexOf("E")===-1){for(i=n.length-1;i>=0;--i)n[i]==null||"n?".indexOf(n[i].t)===-1||(O>=n[i].v.length-1?(O-=n[i].v.length,n[i].v=k.substr(O+1,n[i].v.length)):O<0?n[i].v="":(n[i].v=k.substr(0,O+1),O=-1),n[i].t="t",I=i);O>=0&&I<n.length&&(n[I].v=k.substr(0,O+1)+n[I].v)}else if(L!==n.length&&k.indexOf("E")===-1){for(O=k.indexOf(".")-1,i=L;i>=0;--i)if(!(n[i]==null||"n?".indexOf(n[i].t)===-1)){for(u=n[i].v.indexOf(".")>-1&&i===L?n[i].v.indexOf(".")-1:n[i].v.length-1,F=n[i].v.substr(u+1);u>=0;--u)O>=0&&(n[i].v.charAt(u)==="0"||n[i].v.charAt(u)==="#")&&(F=k.charAt(O--)+F);n[i].v=F,n[i].t="t",I=i}for(O>=0&&I<n.length&&(n[I].v=k.substr(0,O+1)+n[I].v),O=k.indexOf(".")+1,i=L;i<n.length;++i)if(!(n[i]==null||"n?(".indexOf(n[i].t)===-1&&i!==L)){for(u=n[i].v.indexOf(".")>-1&&i===L?n[i].v.indexOf(".")+1:0,F=n[i].v.substr(0,u);u<n[i].v.length;++u)O<k.length&&(F+=k.charAt(O++));n[i].v=F,n[i].t="t",I=i}}}for(i=0;i<n.length;++i)n[i]!=null&&"n?".indexOf(n[i].t)>-1&&(R=a>1&&r<0&&i>0&&n[i-1].v==="-"?-r:r,n[i].v=rt(n[i].t,n[i].v,R),n[i].t="t");var G="";for(i=0;i!==n.length;++i)n[i]!=null&&(G+=n[i].v);return G}var Qi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function eo(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function ed(e,r){var t=Zh(e),a=t.length,n=t[a-1].indexOf("@");if(a<4&&n>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||n>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=n>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=n>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=n>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var s=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,s];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var i=t[0].match(Qi),o=t[1].match(Qi);return eo(r,i)?[a,t[0]]:eo(r,o)?[a,t[1]]:[a,t[i!=null&&o!=null?2:1]]}return[a,s]}function Rr(e,r,t){t==null&&(t={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?a=t.dateNF:a=e;break;case"number":e==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:ve)[e],a==null&&(a=t.table&&t.table[Yi[e]]||ve[Yi[e]]),a==null&&(a=Lh[e]||"General");break}if(Rn(a,0))return Dt(r,t);r instanceof Date&&(r=bc(r,t.date1904));var n=ed(a,r);if(Rn(n[1]))return Dt(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Qh(n[1],r,t,n[0])}function Ot(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(ve[t]==null){r<0&&(r=t);continue}if(ve[t]==e){r=t;break}}r<0&&(r=391)}return ve[r]=e,r}function Lc(){ve=Nh()}var rd={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Bc=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function td(e){var r=typeof e=="number"?ve[e]:e;return r=r.replace(Bc,"(\\d+)"),new RegExp("^"+r+"$")}function ad(e,r,t){var a=-1,n=-1,s=-1,i=-1,o=-1,c=-1;(r.match(Bc)||[]).forEach(function(f,h){var d=parseInt(t[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=d;break;case"d":s=d;break;case"h":i=d;break;case"s":c=d;break;case"m":i>=0?o=d:n=d;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?l:a==-1&&n==-1&&s==-1?u:l+"T"+u}var nd=function(){var e={};e.version="1.2.0";function r(){for(var k=0,L=new Array(256),I=0;I!=256;++I)k=I,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,L[I]=k;return typeof Int32Array<"u"?new Int32Array(L):L}var t=r();function a(k){var L=0,I=0,G=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)W[G]=k[G];for(G=0;G!=256;++G)for(I=k[G],L=256+G;L<4096;L+=256)I=W[L]=I>>>8^k[I&255];var N=[];for(G=1;G!=16;++G)N[G-1]=typeof Int32Array<"u"?W.subarray(G*256,G*256+256):W.slice(G*256,G*256+256);return N}var n=a(t),s=n[0],i=n[1],o=n[2],c=n[3],l=n[4],u=n[5],f=n[6],h=n[7],d=n[8],x=n[9],p=n[10],g=n[11],_=n[12],E=n[13],v=n[14];function O(k,L){for(var I=L^-1,G=0,W=k.length;G<W;)I=I>>>8^t[(I^k.charCodeAt(G++))&255];return~I}function F(k,L){for(var I=L^-1,G=k.length-15,W=0;W<G;)I=v[k[W++]^I&255]^E[k[W++]^I>>8&255]^_[k[W++]^I>>16&255]^g[k[W++]^I>>>24]^p[k[W++]]^x[k[W++]]^d[k[W++]]^h[k[W++]]^f[k[W++]]^u[k[W++]]^l[k[W++]]^c[k[W++]]^o[k[W++]]^i[k[W++]]^s[k[W++]]^t[k[W++]];for(G+=15;W<G;)I=I>>>8^t[(I^k[W++])&255];return~I}function R(k,L){for(var I=L^-1,G=0,W=k.length,N=0,X=0;G<W;)N=k.charCodeAt(G++),N<128?I=I>>>8^t[(I^N)&255]:N<2048?(I=I>>>8^t[(I^(192|N>>6&31))&255],I=I>>>8^t[(I^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,X=k.charCodeAt(G++)&1023,I=I>>>8^t[(I^(240|N>>8&7))&255],I=I>>>8^t[(I^(128|N>>2&63))&255],I=I>>>8^t[(I^(128|X>>6&15|(N&3)<<4))&255],I=I>>>8^t[(I^(128|X&63))&255]):(I=I>>>8^t[(I^(224|N>>12&15))&255],I=I>>>8^t[(I^(128|N>>6&63))&255],I=I>>>8^t[(I^(128|N&63))&255]);return~I}return e.table=t,e.bstr=O,e.buf=F,e.str=R,e}(),ye=function(){var r={};r.version="1.2.1";function t(m,T){for(var w=m.split("/"),y=T.split("/"),A=0,S=0,M=Math.min(w.length,y.length);A<M;++A){if(S=w[A].length-y[A].length)return S;if(w[A]!=y[A])return w[A]<y[A]?-1:1}return w.length-y.length}function a(m){if(m.charAt(m.length-1)=="/")return m.slice(0,-1).indexOf("/")===-1?m:a(m.slice(0,-1));var T=m.lastIndexOf("/");return T===-1?m:m.slice(0,T+1)}function n(m){if(m.charAt(m.length-1)=="/")return n(m.slice(0,-1));var T=m.lastIndexOf("/");return T===-1?m:m.slice(T+1)}function s(m,T){typeof T=="string"&&(T=new Date(T));var w=T.getHours();w=w<<6|T.getMinutes(),w=w<<5|T.getSeconds()>>>1,m.write_shift(2,w);var y=T.getFullYear()-1980;y=y<<4|T.getMonth()+1,y=y<<5|T.getDate(),m.write_shift(2,y)}function i(m){var T=m.read_shift(2)&65535,w=m.read_shift(2)&65535,y=new Date,A=w&31;w>>>=5;var S=w&15;w>>>=4,y.setMilliseconds(0),y.setFullYear(w+1980),y.setMonth(S-1),y.setDate(A);var M=T&31;T>>>=5;var K=T&63;return T>>>=6,y.setHours(T),y.setMinutes(K),y.setSeconds(M<<1),y}function o(m){er(m,0);for(var T={},w=0;m.l<=m.length-4;){var y=m.read_shift(2),A=m.read_shift(2),S=m.l+A,M={};switch(y){case 21589:w=m.read_shift(1),w&1&&(M.mtime=m.read_shift(4)),A>5&&(w&2&&(M.atime=m.read_shift(4)),w&4&&(M.ctime=m.read_shift(4))),M.mtime&&(M.mt=new Date(M.mtime*1e3));break}m.l=S,T[y]=M}return T}var c;function l(){return c||(c={})}function u(m,T){if(m[0]==80&&m[1]==75)return vi(m,T);if((m[0]|32)==109&&(m[1]|32)==105)return pl(m,T);if(m.length<512)throw new Error("CFB file size "+m.length+" < 512");var w=3,y=512,A=0,S=0,M=0,K=0,B=0,U=[],H=m.slice(0,512);er(H,0);var z=f(H);switch(w=z[0],w){case 3:y=512;break;case 4:y=4096;break;case 0:if(z[1]==0)return vi(m,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}y!==512&&(H=m.slice(0,y),er(H,28));var Q=m.slice(0,y);h(H,w);var se=H.read_shift(4,"i");if(w===3&&se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+se);H.l+=4,M=H.read_shift(4,"i"),H.l+=4,H.chk("00100000","Mini Stream Cutoff Size: "),K=H.read_shift(4,"i"),A=H.read_shift(4,"i"),B=H.read_shift(4,"i"),S=H.read_shift(4,"i");for(var J=-1,ae=0;ae<109&&(J=H.read_shift(4,"i"),!(J<0));++ae)U[ae]=J;var ge=d(m,y);g(B,S,ge,y,U);var Ie=E(ge,M,U,y);Ie[M].name="!Directory",A>0&&K!==X&&(Ie[K].name="!MiniFAT"),Ie[U[0]].name="!FAT",Ie.fat_addrs=U,Ie.ssz=y;var De={},ar=[],da=[],pa=[];v(M,Ie,ge,ar,A,De,da,K),x(da,pa,ar),ar.shift();var xa={FileIndex:da,FullPaths:pa};return T&&T.raw&&(xa.raw={header:Q,sectors:ge}),xa}function f(m){if(m[m.l]==80&&m[m.l+1]==75)return[0,0];m.chk(ce,"Header Signature: "),m.l+=16;var T=m.read_shift(2,"u");return[m.read_shift(2,"u"),T]}function h(m,T){var w=9;switch(m.l+=2,w=m.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}m.chk("0600","Mini Sector Shift: "),m.chk("000000000000","Reserved: ")}function d(m,T){for(var w=Math.ceil(m.length/T)-1,y=[],A=1;A<w;++A)y[A-1]=m.slice(A*T,(A+1)*T);return y[w-1]=m.slice(w*T),y}function x(m,T,w){for(var y=0,A=0,S=0,M=0,K=0,B=w.length,U=[],H=[];y<B;++y)U[y]=H[y]=y,T[y]=w[y];for(;K<H.length;++K)y=H[K],A=m[y].L,S=m[y].R,M=m[y].C,U[y]===y&&(A!==-1&&U[A]!==A&&(U[y]=U[A]),S!==-1&&U[S]!==S&&(U[y]=U[S])),M!==-1&&(U[M]=y),A!==-1&&y!=U[y]&&(U[A]=U[y],H.lastIndexOf(A)<K&&H.push(A)),S!==-1&&y!=U[y]&&(U[S]=U[y],H.lastIndexOf(S)<K&&H.push(S));for(y=1;y<B;++y)U[y]===y&&(S!==-1&&U[S]!==S?U[y]=U[S]:A!==-1&&U[A]!==A&&(U[y]=U[A]));for(y=1;y<B;++y)if(m[y].type!==0){if(K=y,K!=U[K])do K=U[K],T[y]=T[K]+"/"+T[y];while(K!==0&&U[K]!==-1&&K!=U[K]);U[y]=-1}for(T[0]+="/",y=1;y<B;++y)m[y].type!==2&&(T[y]+="/")}function p(m,T,w){for(var y=m.start,A=m.size,S=[],M=y;w&&A>0&&M>=0;)S.push(T.slice(M*N,M*N+N)),A-=N,M=At(w,M*4);return S.length===0?qe(0):ft(S).slice(0,m.size)}function g(m,T,w,y,A){var S=X;if(m===X){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(m!==-1){var M=w[m],K=(y>>>2)-1;if(!M)return;for(var B=0;B<K&&(S=At(M,B*4))!==X;++B)A.push(S);g(At(M,y-4),T-1,w,y,A)}}function _(m,T,w,y,A){var S=[],M=[];A||(A=[]);var K=y-1,B=0,U=0;for(B=T;B>=0;){A[B]=!0,S[S.length]=B,M.push(m[B]);var H=w[Math.floor(B*4/y)];if(U=B*4&K,y<4+U)throw new Error("FAT boundary crossed: "+B+" 4 "+y);if(!m[H])break;B=At(m[H],U)}return{nodes:S,data:uo([M])}}function E(m,T,w,y){var A=m.length,S=[],M=[],K=[],B=[],U=y-1,H=0,z=0,Q=0,se=0;for(H=0;H<A;++H)if(K=[],Q=H+T,Q>=A&&(Q-=A),!M[Q]){B=[];var J=[];for(z=Q;z>=0;){J[z]=!0,M[z]=!0,K[K.length]=z,B.push(m[z]);var ae=w[Math.floor(z*4/y)];if(se=z*4&U,y<4+se)throw new Error("FAT boundary crossed: "+z+" 4 "+y);if(!m[ae]||(z=At(m[ae],se),J[z]))break}S[Q]={nodes:K,data:uo([B])}}return S}function v(m,T,w,y,A,S,M,K){for(var B=0,U=y.length?2:0,H=T[m].data,z=0,Q=0,se;z<H.length;z+=128){var J=H.slice(z,z+128);er(J,64),Q=J.read_shift(2),se=Ys(J,0,Q-U),y.push(se);var ae={name:se,type:J.read_shift(1),color:J.read_shift(1),L:J.read_shift(4,"i"),R:J.read_shift(4,"i"),C:J.read_shift(4,"i"),clsid:J.read_shift(16),state:J.read_shift(4,"i"),start:0,size:0},ge=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);ge!==0&&(ae.ct=O(J,J.l-8));var Ie=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);Ie!==0&&(ae.mt=O(J,J.l-8)),ae.start=J.read_shift(4,"i"),ae.size=J.read_shift(4,"i"),ae.size<0&&ae.start<0&&(ae.size=ae.type=0,ae.start=X,ae.name=""),ae.type===5?(B=ae.start,A>0&&B!==X&&(T[B].name="!StreamData")):ae.size>=4096?(ae.storage="fat",T[ae.start]===void 0&&(T[ae.start]=_(w,ae.start,T.fat_addrs,T.ssz)),T[ae.start].name=ae.name,ae.content=T[ae.start].data.slice(0,ae.size)):(ae.storage="minifat",ae.size<0?ae.size=0:B!==X&&ae.start!==X&&T[B]&&(ae.content=p(ae,T[B].data,(T[K]||{}).data))),ae.content&&er(ae.content,0),S[se]=ae,M.push(ae)}}function O(m,T){return new Date((yr(m,T+4)/1e7*Math.pow(2,32)+yr(m,T)/1e7-11644473600)*1e3)}function F(m,T){return l(),u(c.readFileSync(m),T)}function R(m,T){var w=T&&T.type;switch(w||we&&Buffer.isBuffer(m)&&(w="buffer"),w||"base64"){case"file":return F(m,T);case"base64":return u(Br(kr(m)),T);case"binary":return u(Br(m),T)}return u(m,T)}function k(m,T){var w=T||{},y=w.root||"Root Entry";if(m.FullPaths||(m.FullPaths=[]),m.FileIndex||(m.FileIndex=[]),m.FullPaths.length!==m.FileIndex.length)throw new Error("inconsistent CFB structure");m.FullPaths.length===0&&(m.FullPaths[0]=y+"/",m.FileIndex[0]={name:y,type:5}),w.CLSID&&(m.FileIndex[0].clsid=w.CLSID),L(m)}function L(m){var T="Sh33tJ5";if(!ye.find(m,"/"+T)){var w=qe(4);w[0]=55,w[1]=w[3]=50,w[2]=54,m.FileIndex.push({name:T,type:2,content:w,size:4,L:69,R:69,C:69}),m.FullPaths.push(m.FullPaths[0]+T),I(m)}}function I(m,T){k(m);for(var w=!1,y=!1,A=m.FullPaths.length-1;A>=0;--A){var S=m.FileIndex[A];switch(S.type){case 0:y?w=!0:(m.FileIndex.pop(),m.FullPaths.pop());break;case 1:case 2:case 5:y=!0,isNaN(S.R*S.L*S.C)&&(w=!0),S.R>-1&&S.L>-1&&S.R==S.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!T)){var M=new Date(1987,1,19),K=0,B=Object.create?Object.create(null):{},U=[];for(A=0;A<m.FullPaths.length;++A)B[m.FullPaths[A]]=!0,m.FileIndex[A].type!==0&&U.push([m.FullPaths[A],m.FileIndex[A]]);for(A=0;A<U.length;++A){var H=a(U[A][0]);y=B[H],y||(U.push([H,{name:n(H).replace("/",""),type:1,clsid:oe,ct:M,mt:M,content:null}]),B[H]=!0)}for(U.sort(function(se,J){return t(se[0],J[0])}),m.FullPaths=[],m.FileIndex=[],A=0;A<U.length;++A)m.FullPaths[A]=U[A][0],m.FileIndex[A]=U[A][1];for(A=0;A<U.length;++A){var z=m.FileIndex[A],Q=m.FullPaths[A];if(z.name=n(Q).replace("/",""),z.L=z.R=z.C=-(z.color=1),z.size=z.content?z.content.length:0,z.start=0,z.clsid=z.clsid||oe,A===0)z.C=U.length>1?1:-1,z.size=0,z.type=5;else if(Q.slice(-1)=="/"){for(K=A+1;K<U.length&&a(m.FullPaths[K])!=Q;++K);for(z.C=K>=U.length?-1:K,K=A+1;K<U.length&&a(m.FullPaths[K])!=a(Q);++K);z.R=K>=U.length?-1:K,z.type=1}else a(m.FullPaths[A+1]||"")==a(Q)&&(z.R=A+1),z.type=2}}}function G(m,T){var w=T||{};if(w.fileType=="mad")return xl(m,w);switch(I(m),w.fileType){case"zip":return cl(m,w)}var y=function(se){for(var J=0,ae=0,ge=0;ge<se.FileIndex.length;++ge){var Ie=se.FileIndex[ge];if(Ie.content){var De=Ie.content.length;De>0&&(De<4096?J+=De+63>>6:ae+=De+511>>9)}}for(var ar=se.FullPaths.length+3>>2,da=J+7>>3,pa=J+127>>7,xa=da+ae+ar+pa,_t=xa+127>>7,Yn=_t<=109?0:Math.ceil((_t-109)/127);xa+_t+Yn+127>>7>_t;)Yn=++_t<=109?0:Math.ceil((_t-109)/127);var Zr=[1,Yn,_t,pa,ar,ae,J,0];return se.FileIndex[0].size=J<<6,Zr[7]=(se.FileIndex[0].start=Zr[0]+Zr[1]+Zr[2]+Zr[3]+Zr[4]+Zr[5])+(Zr[6]+7>>3),Zr}(m),A=qe(y[7]<<9),S=0,M=0;{for(S=0;S<8;++S)A.write_shift(1,re[S]);for(S=0;S<8;++S)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),S=0;S<3;++S)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,y[2]),A.write_shift(4,y[0]+y[1]+y[2]+y[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,y[3]?y[0]+y[1]+y[2]-1:X),A.write_shift(4,y[3]),A.write_shift(-4,y[1]?y[0]-1:X),A.write_shift(4,y[1]),S=0;S<109;++S)A.write_shift(-4,S<y[2]?y[1]+S:-1)}if(y[1])for(M=0;M<y[1];++M){for(;S<236+M*127;++S)A.write_shift(-4,S<y[2]?y[1]+S:-1);A.write_shift(-4,M===y[1]-1?X:M+1)}var K=function(se){for(M+=se;S<M-1;++S)A.write_shift(-4,S+1);se&&(++S,A.write_shift(-4,X))};for(M=S=0,M+=y[1];S<M;++S)A.write_shift(-4,ie.DIFSECT);for(M+=y[2];S<M;++S)A.write_shift(-4,ie.FATSECT);K(y[3]),K(y[4]);for(var B=0,U=0,H=m.FileIndex[0];B<m.FileIndex.length;++B)H=m.FileIndex[B],H.content&&(U=H.content.length,!(U<4096)&&(H.start=M,K(U+511>>9)));for(K(y[6]+7>>3);A.l&511;)A.write_shift(-4,ie.ENDOFCHAIN);for(M=S=0,B=0;B<m.FileIndex.length;++B)H=m.FileIndex[B],H.content&&(U=H.content.length,!(!U||U>=4096)&&(H.start=M,K(U+63>>6)));for(;A.l&511;)A.write_shift(-4,ie.ENDOFCHAIN);for(S=0;S<y[4]<<2;++S){var z=m.FullPaths[S];if(!z||z.length===0){for(B=0;B<17;++B)A.write_shift(4,0);for(B=0;B<3;++B)A.write_shift(4,-1);for(B=0;B<12;++B)A.write_shift(4,0);continue}H=m.FileIndex[S],S===0&&(H.start=H.size?H.start-1:X);var Q=S===0&&w.root||H.name;if(U=2*(Q.length+1),A.write_shift(64,Q,"utf16le"),A.write_shift(2,U),A.write_shift(1,H.type),A.write_shift(1,H.color),A.write_shift(-4,H.L),A.write_shift(-4,H.R),A.write_shift(-4,H.C),H.clsid)A.write_shift(16,H.clsid,"hex");else for(B=0;B<4;++B)A.write_shift(4,0);A.write_shift(4,H.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,H.start),A.write_shift(4,H.size),A.write_shift(4,0)}for(S=1;S<m.FileIndex.length;++S)if(H=m.FileIndex[S],H.size>=4096)if(A.l=H.start+1<<9,we&&Buffer.isBuffer(H.content))H.content.copy(A,A.l,0,H.size),A.l+=H.size+511&-512;else{for(B=0;B<H.size;++B)A.write_shift(1,H.content[B]);for(;B&511;++B)A.write_shift(1,0)}for(S=1;S<m.FileIndex.length;++S)if(H=m.FileIndex[S],H.size>0&&H.size<4096)if(we&&Buffer.isBuffer(H.content))H.content.copy(A,A.l,0,H.size),A.l+=H.size+63&-64;else{for(B=0;B<H.size;++B)A.write_shift(1,H.content[B]);for(;B&63;++B)A.write_shift(1,0)}if(we)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function W(m,T){var w=m.FullPaths.map(function(B){return B.toUpperCase()}),y=w.map(function(B){var U=B.split("/");return U[U.length-(B.slice(-1)=="/"?2:1)]}),A=!1;T.charCodeAt(0)===47?(A=!0,T=w[0].slice(0,-1)+T):A=T.indexOf("/")!==-1;var S=T.toUpperCase(),M=A===!0?w.indexOf(S):y.indexOf(S);if(M!==-1)return m.FileIndex[M];var K=!S.match(wa);for(S=S.replace(gr,""),K&&(S=S.replace(wa,"!")),M=0;M<w.length;++M)if((K?w[M].replace(wa,"!"):w[M]).replace(gr,"")==S||(K?y[M].replace(wa,"!"):y[M]).replace(gr,"")==S)return m.FileIndex[M];return null}var N=64,X=-2,ce="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(m,T,w){l();var y=G(m,w);c.writeFileSync(T,y)}function V(m){for(var T=new Array(m.length),w=0;w<m.length;++w)T[w]=String.fromCharCode(m[w]);return T.join("")}function de(m,T){var w=G(m,T);switch(T&&T.type||"buffer"){case"file":return l(),c.writeFileSync(T.filename,w),w;case"binary":return typeof w=="string"?w:V(w);case"base64":return Ki(typeof w=="string"?w:V(w));case"buffer":if(we)return Buffer.isBuffer(w)?w:Lt(w);case"array":return typeof w=="string"?Br(w):w}return w}var pe;function b(m){try{var T=m.InflateRaw,w=new T;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)pe=m;else throw new Error("zlib does not expose bytesRead")}catch(y){console.error("cannot use native zlib: "+(y.message||y))}}function j(m,T){if(!pe)return xi(m,T);var w=pe.InflateRaw,y=new w,A=y._processChunk(m.slice(m.l),y._finishFlushFlag);return m.l+=y.bytesRead,A}function P(m){return pe?pe.deflateRawSync(m):me(m)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(m){var T=(m<<1|m<<11)&139536|(m<<5|m<<15)&558144;return(T>>16|T>>8|T)&255}for(var Z=typeof Uint8Array<"u",Y=Z?new Uint8Array(256):[],Te=0;Te<256;++Te)Y[Te]=ne(Te);function C(m,T){var w=Y[m&255];return T<=8?w>>>8-T:(w=w<<8|Y[m>>8&255],T<=16?w>>>16-T:(w=w<<8|Y[m>>16&255],w>>>24-T))}function Be(m,T){var w=T&7,y=T>>>3;return(m[y]|(w<=6?0:m[y+1]<<8))>>>w&3}function Ae(m,T){var w=T&7,y=T>>>3;return(m[y]|(w<=5?0:m[y+1]<<8))>>>w&7}function be(m,T){var w=T&7,y=T>>>3;return(m[y]|(w<=4?0:m[y+1]<<8))>>>w&15}function _e(m,T){var w=T&7,y=T>>>3;return(m[y]|(w<=3?0:m[y+1]<<8))>>>w&31}function te(m,T){var w=T&7,y=T>>>3;return(m[y]|(w<=1?0:m[y+1]<<8))>>>w&127}function Me(m,T,w){var y=T&7,A=T>>>3,S=(1<<w)-1,M=m[A]>>>y;return w<8-y||(M|=m[A+1]<<8-y,w<16-y)||(M|=m[A+2]<<16-y,w<24-y)||(M|=m[A+3]<<24-y),M&S}function Ar(m,T,w){var y=T&7,A=T>>>3;return y<=5?m[A]|=(w&7)<<y:(m[A]|=w<<y&255,m[A+1]=(w&7)>>8-y),T+3}function Hr(m,T,w){var y=T&7,A=T>>>3;return w=(w&1)<<y,m[A]|=w,T+1}function Yr(m,T,w){var y=T&7,A=T>>>3;return w<<=y,m[A]|=w&255,w>>>=8,m[A+1]=w,T+8}function fa(m,T,w){var y=T&7,A=T>>>3;return w<<=y,m[A]|=w&255,w>>>=8,m[A+1]=w&255,m[A+2]=w>>>8,T+16}function it(m,T){var w=m.length,y=2*w>T?2*w:T+5,A=0;if(w>=T)return m;if(we){var S=qi(y);if(m.copy)m.copy(S);else for(;A<m.length;++A)S[A]=m[A];return S}else if(Z){var M=new Uint8Array(y);if(M.set)M.set(m);else for(;A<w;++A)M[A]=m[A];return M}return m.length=y,m}function _r(m){for(var T=new Array(m),w=0;w<m;++w)T[w]=0;return T}function Jr(m,T,w){var y=1,A=0,S=0,M=0,K=0,B=m.length,U=Z?new Uint16Array(32):_r(32);for(S=0;S<32;++S)U[S]=0;for(S=B;S<w;++S)m[S]=0;B=m.length;var H=Z?new Uint16Array(B):_r(B);for(S=0;S<B;++S)U[A=m[S]]++,y<A&&(y=A),H[S]=0;for(U[0]=0,S=1;S<=y;++S)U[S+16]=K=K+U[S-1]<<1;for(S=0;S<B;++S)K=m[S],K!=0&&(H[S]=U[K+16]++);var z=0;for(S=0;S<B;++S)if(z=m[S],z!=0)for(K=C(H[S],y)>>y-z,M=(1<<y+4-z)-1;M>=0;--M)T[K|M<<z]=z&15|S<<4;return y}var ot=Z?new Uint16Array(512):_r(512),ha=Z?new Uint16Array(32):_r(32);if(!Z){for(var hr=0;hr<512;++hr)ot[hr]=0;for(hr=0;hr<32;++hr)ha[hr]=0}(function(){for(var m=[],T=0;T<32;T++)m.push(5);Jr(m,ha,32);var w=[];for(T=0;T<=143;T++)w.push(8);for(;T<=255;T++)w.push(9);for(;T<=279;T++)w.push(7);for(;T<=287;T++)w.push(8);Jr(w,ot,288)})();var Wr=function(){for(var T=Z?new Uint8Array(32768):[],w=0,y=0;w<ee.length-1;++w)for(;y<ee[w+1];++y)T[y]=w;for(;y<32768;++y)T[y]=29;var A=Z?new Uint8Array(259):[];for(w=0,y=0;w<q.length-1;++w)for(;y<q[w+1];++y)A[y]=w;function S(K,B){for(var U=0;U<K.length;){var H=Math.min(65535,K.length-U),z=U+H==K.length;for(B.write_shift(1,+z),B.write_shift(2,H),B.write_shift(2,~H&65535);H-- >0;)B[B.l++]=K[U++]}return B.l}function M(K,B){for(var U=0,H=0,z=Z?new Uint16Array(32768):[];H<K.length;){var Q=Math.min(65535,K.length-H);if(Q<10){for(U=Ar(B,U,+(H+Q==K.length)),U&7&&(U+=8-(U&7)),B.l=U/8|0,B.write_shift(2,Q),B.write_shift(2,~Q&65535);Q-- >0;)B[B.l++]=K[H++];U=B.l*8;continue}U=Ar(B,U,+(H+Q==K.length)+2);for(var se=0;Q-- >0;){var J=K[H];se=(se<<5^J)&32767;var ae=-1,ge=0;if((ae=z[se])&&(ae|=H&-32768,ae>H&&(ae-=32768),ae<H))for(;K[ae+ge]==K[H+ge]&&ge<250;)++ge;if(ge>2){J=A[ge],J<=22?U=Yr(B,U,Y[J+1]>>1)-1:(Yr(B,U,3),U+=5,Yr(B,U,Y[J-23]>>5),U+=3);var Ie=J<8?0:J-4>>2;Ie>0&&(fa(B,U,ge-q[J]),U+=Ie),J=T[H-ae],U=Yr(B,U,Y[J]>>3),U-=3;var De=J<4?0:J-2>>1;De>0&&(fa(B,U,H-ae-ee[J]),U+=De);for(var ar=0;ar<ge;++ar)z[se]=H&32767,se=(se<<5^K[H])&32767,++H;Q-=ge-1}else J<=143?J=J+48:U=Hr(B,U,1),U=Yr(B,U,Y[J]),z[se]=H&32767,++H}U=Yr(B,U,0)-1}return B.l=(U+7)/8|0,B.l}return function(B,U){return B.length<8?S(B,U):M(B,U)}}();function me(m){var T=qe(50+Math.floor(m.length*1.1)),w=Wr(m,T);return T.slice(0,w)}var Ue=Z?new Uint16Array(32768):_r(32768),Sr=Z?new Uint16Array(32768):_r(32768),Ge=Z?new Uint16Array(128):_r(128),mt=1,pi=1;function sl(m,T){var w=_e(m,T)+257;T+=5;var y=_e(m,T)+1;T+=5;var A=be(m,T)+4;T+=4;for(var S=0,M=Z?new Uint8Array(19):_r(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,U=Z?new Uint8Array(8):_r(8),H=Z?new Uint8Array(8):_r(8),z=M.length,Q=0;Q<A;++Q)M[D[Q]]=S=Ae(m,T),B<S&&(B=S),U[S]++,T+=3;var se=0;for(U[0]=0,Q=1;Q<=B;++Q)H[Q]=se=se+U[Q-1]<<1;for(Q=0;Q<z;++Q)(se=M[Q])!=0&&(K[Q]=H[se]++);var J=0;for(Q=0;Q<z;++Q)if(J=M[Q],J!=0){se=Y[K[Q]]>>8-J;for(var ae=(1<<7-J)-1;ae>=0;--ae)Ge[se|ae<<J]=J&7|Q<<3}var ge=[];for(B=1;ge.length<w+y;)switch(se=Ge[te(m,T)],T+=se&7,se>>>=3){case 16:for(S=3+Be(m,T),T+=2,se=ge[ge.length-1];S-- >0;)ge.push(se);break;case 17:for(S=3+Ae(m,T),T+=3;S-- >0;)ge.push(0);break;case 18:for(S=11+te(m,T),T+=7;S-- >0;)ge.push(0);break;default:ge.push(se),B<se&&(B=se);break}var Ie=ge.slice(0,w),De=ge.slice(w);for(Q=w;Q<286;++Q)Ie[Q]=0;for(Q=y;Q<30;++Q)De[Q]=0;return mt=Jr(Ie,Ue,286),pi=Jr(De,Sr,30),T}function il(m,T){if(m[0]==3&&!(m[1]&3))return[xt(T),2];for(var w=0,y=0,A=qi(T||1<<18),S=0,M=A.length>>>0,K=0,B=0;!(y&1);){if(y=Ae(m,w),w+=3,y>>>1)y>>1==1?(K=9,B=5):(w=sl(m,w),K=mt,B=pi);else{w&7&&(w+=8-(w&7));var U=m[w>>>3]|m[(w>>>3)+1]<<8;if(w+=32,U>0)for(!T&&M<S+U&&(A=it(A,S+U),M=A.length);U-- >0;)A[S++]=m[w>>>3],w+=8;continue}for(;;){!T&&M<S+32767&&(A=it(A,S+32767),M=A.length);var H=Me(m,w,K),z=y>>>1==1?ot[H]:Ue[H];if(w+=z&15,z>>>=4,!(z>>>8&255))A[S++]=z;else{if(z==256)break;z-=257;var Q=z<8?0:z-4>>2;Q>5&&(Q=0);var se=S+q[z];Q>0&&(se+=Me(m,w,Q),w+=Q),H=Me(m,w,B),z=y>>>1==1?ha[H]:Sr[H],w+=z&15,z>>>=4;var J=z<4?0:z-2>>1,ae=ee[z];for(J>0&&(ae+=Me(m,w,J),w+=J),!T&&M<se&&(A=it(A,se+100),M=A.length);S<se;)A[S]=A[S-ae],++S}}}return T?[A,w+7>>>3]:[A.slice(0,S),w+7>>>3]}function xi(m,T){var w=m.slice(m.l||0),y=il(w,T);return m.l+=y[1],y[0]}function gi(m,T){if(m)typeof console<"u"&&console.error(T);else throw new Error(T)}function vi(m,T){var w=m;er(w,0);var y=[],A=[],S={FileIndex:y,FullPaths:A};k(S,{root:T.root});for(var M=w.length-4;(w[M]!=80||w[M+1]!=75||w[M+2]!=5||w[M+3]!=6)&&M>=0;)--M;w.l=M+4,w.l+=4;var K=w.read_shift(2);w.l+=6;var B=w.read_shift(4);for(w.l=B,M=0;M<K;++M){w.l+=20;var U=w.read_shift(4),H=w.read_shift(4),z=w.read_shift(2),Q=w.read_shift(2),se=w.read_shift(2);w.l+=8;var J=w.read_shift(4),ae=o(w.slice(w.l+z,w.l+z+Q));w.l+=z+Q+se;var ge=w.l;w.l=J+4,ol(w,U,H,S,ae),w.l=ge}return S}function ol(m,T,w,y,A){m.l+=2;var S=m.read_shift(2),M=m.read_shift(2),K=i(m);if(S&8257)throw new Error("Unsupported ZIP encryption");for(var B=m.read_shift(4),U=m.read_shift(4),H=m.read_shift(4),z=m.read_shift(2),Q=m.read_shift(2),se="",J=0;J<z;++J)se+=String.fromCharCode(m[m.l++]);if(Q){var ae=o(m.slice(m.l,m.l+Q));(ae[21589]||{}).mt&&(K=ae[21589].mt),((A||{})[21589]||{}).mt&&(K=A[21589].mt)}m.l+=Q;var ge=m.slice(m.l,m.l+U);switch(M){case 8:ge=j(m,H);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+M)}var Ie=!1;S&8&&(B=m.read_shift(4),B==134695760&&(B=m.read_shift(4),Ie=!0),U=m.read_shift(4),H=m.read_shift(4)),U!=T&&gi(Ie,"Bad compressed size: "+T+" != "+U),H!=w&&gi(Ie,"Bad uncompressed size: "+w+" != "+H),Xn(y,se,ge,{unsafe:!0,mt:K})}function cl(m,T){var w=T||{},y=[],A=[],S=qe(1),M=w.compression?8:0,K=0,B=0,U=0,H=0,z=0,Q=m.FullPaths[0],se=Q,J=m.FileIndex[0],ae=[],ge=0;for(B=1;B<m.FullPaths.length;++B)if(se=m.FullPaths[B].slice(Q.length),J=m.FileIndex[B],!(!J.size||!J.content||se=="Sh33tJ5")){var Ie=H,De=qe(se.length);for(U=0;U<se.length;++U)De.write_shift(1,se.charCodeAt(U)&127);De=De.slice(0,De.l),ae[z]=nd.buf(J.content,0);var ar=J.content;M==8&&(ar=P(ar)),S=qe(30),S.write_shift(4,67324752),S.write_shift(2,20),S.write_shift(2,K),S.write_shift(2,M),J.mt?s(S,J.mt):S.write_shift(4,0),S.write_shift(-4,ae[z]),S.write_shift(4,ar.length),S.write_shift(4,J.content.length),S.write_shift(2,De.length),S.write_shift(2,0),H+=S.length,y.push(S),H+=De.length,y.push(De),H+=ar.length,y.push(ar),S=qe(46),S.write_shift(4,33639248),S.write_shift(2,0),S.write_shift(2,20),S.write_shift(2,K),S.write_shift(2,M),S.write_shift(4,0),S.write_shift(-4,ae[z]),S.write_shift(4,ar.length),S.write_shift(4,J.content.length),S.write_shift(2,De.length),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(4,0),S.write_shift(4,Ie),ge+=S.l,A.push(S),ge+=De.length,A.push(De),++z}return S=qe(22),S.write_shift(4,101010256),S.write_shift(2,0),S.write_shift(2,0),S.write_shift(2,z),S.write_shift(2,z),S.write_shift(4,ge),S.write_shift(4,H),S.write_shift(2,0),ft([ft(y),ft(A),S])}var nn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ll(m,T){if(m.ctype)return m.ctype;var w=m.name||"",y=w.match(/\.([^\.]+)$/);return y&&nn[y[1]]||T&&(y=(w=T).match(/[\.\\]([^\.\\])+$/),y&&nn[y[1]])?nn[y[1]]:"application/octet-stream"}function ul(m){for(var T=Ki(m),w=[],y=0;y<T.length;y+=76)w.push(T.slice(y,y+76));return w.join(`\r
`)+`\r
`}function fl(m){var T=m.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(U){var H=U.charCodeAt(0).toString(16).toUpperCase();return"="+(H.length==1?"0"+H:H)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],y=T.split(`\r
`),A=0;A<y.length;++A){var S=y[A];if(S.length==0){w.push("");continue}for(var M=0;M<S.length;){var K=76,B=S.slice(M,M+K);B.charAt(K-1)=="="?K--:B.charAt(K-2)=="="?K-=2:B.charAt(K-3)=="="&&(K-=3),B=S.slice(M,M+K),M+=K,M<S.length&&(B+="="),w.push(B)}}return w.join(`\r
`)}function hl(m){for(var T=[],w=0;w<m.length;++w){for(var y=m[w];w<=m.length&&y.charAt(y.length-1)=="=";)y=y.slice(0,y.length-1)+m[++w];T.push(y)}for(var A=0;A<T.length;++A)T[A]=T[A].replace(/[=][0-9A-Fa-f]{2}/g,function(S){return String.fromCharCode(parseInt(S.slice(1),16))});return Br(T.join(`\r
`))}function dl(m,T,w){for(var y="",A="",S="",M,K=0;K<10;++K){var B=T[K];if(!B||B.match(/^\s*$/))break;var U=B.match(/^(.*?):\s*([^\s].*)$/);if(U)switch(U[1].toLowerCase()){case"content-location":y=U[2].trim();break;case"content-type":S=U[2].trim();break;case"content-transfer-encoding":A=U[2].trim();break}}switch(++K,A.toLowerCase()){case"base64":M=Br(kr(T.slice(K).join("")));break;case"quoted-printable":M=hl(T.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var H=Xn(m,y.slice(w.length),M,{unsafe:!0});S&&(H.ctype=S)}function pl(m,T){if(V(m.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=T&&T.root||"",y=(we&&Buffer.isBuffer(m)?m.toString("binary"):V(m)).split(`\r
`),A=0,S="";for(A=0;A<y.length;++A)if(S=y[A],!!/^Content-Location:/i.test(S)&&(S=S.slice(S.indexOf("file")),w||(w=S.slice(0,S.lastIndexOf("/")+1)),S.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),S.slice(0,w.length)!=w););var M=(y[1]||"").match(/boundary="(.*?)"/);if(!M)throw new Error("MAD cannot find boundary");var K="--"+(M[1]||""),B=[],U=[],H={FileIndex:B,FullPaths:U};k(H);var z,Q=0;for(A=0;A<y.length;++A){var se=y[A];se!==K&&se!==K+"--"||(Q++&&dl(H,y.slice(z,A),w),z=A)}return H}function xl(m,T){var w=T||{},y=w.boundary||"SheetJS";y="------="+y;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+y.slice(2)+'"',"","",""],S=m.FullPaths[0],M=S,K=m.FileIndex[0],B=1;B<m.FullPaths.length;++B)if(M=m.FullPaths[B].slice(S.length),K=m.FileIndex[B],!(!K.size||!K.content||M=="Sh33tJ5")){M=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ge){return"_x"+ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ge){return"_u"+ge.charCodeAt(0).toString(16)+"_"});for(var U=K.content,H=we&&Buffer.isBuffer(U)?U.toString("binary"):V(U),z=0,Q=Math.min(1024,H.length),se=0,J=0;J<=Q;++J)(se=H.charCodeAt(J))>=32&&se<128&&++z;var ae=z>=Q*4/5;A.push(y),A.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+M),A.push("Content-Transfer-Encoding: "+(ae?"quoted-printable":"base64")),A.push("Content-Type: "+ll(K,M)),A.push(""),A.push(ae?fl(H):ul(H))}return A.push(y+`--\r
`),A.join(`\r
`)}function gl(m){var T={};return k(T,m),T}function Xn(m,T,w,y){var A=y&&y.unsafe;A||k(m);var S=!A&&ye.find(m,T);if(!S){var M=m.FullPaths[0];T.slice(0,M.length)==M?M=T:(M.slice(-1)!="/"&&(M+="/"),M=(M+T).replace("//","/")),S={name:n(T),type:2},m.FileIndex.push(S),m.FullPaths.push(M),A||ye.utils.cfb_gc(m)}return S.content=w,S.size=w?w.length:0,y&&(y.CLSID&&(S.clsid=y.CLSID),y.mt&&(S.mt=y.mt),y.ct&&(S.ct=y.ct)),S}function vl(m,T){k(m);var w=ye.find(m,T);if(w){for(var y=0;y<m.FileIndex.length;++y)if(m.FileIndex[y]==w)return m.FileIndex.splice(y,1),m.FullPaths.splice(y,1),!0}return!1}function ml(m,T,w){k(m);var y=ye.find(m,T);if(y){for(var A=0;A<m.FileIndex.length;++A)if(m.FileIndex[A]==y)return m.FileIndex[A].name=n(w),m.FullPaths[A]=w,!0}return!1}function _l(m){I(m,!0)}return r.find=W,r.read=R,r.parse=u,r.write=de,r.writeFile=Re,r.utils={cfb_new:gl,cfb_add:Xn,cfb_del:vl,cfb_mov:ml,cfb_gc:_l,ReadShift:Aa,CheckField:s0,prep_blob:er,bconcat:ft,use_zlib:b,_deflateRaw:me,_inflateRaw:xi,consts:ie},r}();function sd(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function qr(e){for(var r=Object.keys(e),t=[],a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e,r[a])&&t.push(r[a]);return t}function Ks(e){for(var r=[],t=qr(e),a=0;a!==t.length;++a)r[e[t[a]]]=t[a];return r}var In=new Date(1899,11,30,0,0,0);function vr(e,r){var t=e.getTime(),a=In.getTime()+(e.getTimezoneOffset()-In.getTimezoneOffset())*6e4;return(t-a)/(24*60*60*1e3)}var Mc=new Date,id=In.getTime()+(Mc.getTimezoneOffset()-In.getTimezoneOffset())*6e4,ro=Mc.getTimezoneOffset();function Gn(e){var r=new Date;return r.setTime(e*24*60*60*1e3+id),r.getTimezoneOffset()!==ro&&r.setTime(r.getTime()+(r.getTimezoneOffset()-ro)*6e4),r}function od(e){var r=0,t=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(t=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(a)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(n[s],10)}return r}var to=new Date("2017-02-19T19:06:09.000Z"),Uc=isNaN(to.getFullYear())?new Date("2/19/17"):to,cd=Uc.getFullYear()==2017;function Je(e,r){var t=new Date(e);if(cd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Uc.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Pt(e,r){if(we&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Ea(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ea(Ac(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Ea(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ea(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return t[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function rr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=rr(e[t]));return r}function Ne(e,r){for(var t="";t.length<r;)t+=e;return t}function jr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return t=-t,s}),!isNaN(r=Number(a)))?r/t:r}var ld=["january","february","march","april","may","june","july","august","september","october","november","december"];function sa(e){var r=new Date(e),t=new Date(NaN),a=r.getYear(),n=r.getMonth(),s=r.getDate();if(isNaN(s))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&ld.indexOf(i)==-1)return t}else if(i.match(/[a-z]/))return t;return a<0||a>8099?t:(n>0||s>1)&&a!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var ud=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,a,n){if(e||typeof a=="string")return t.split(a);for(var s=t.split(a),i=[s[0]],o=1;o<s.length;++o)i.push(n),i.push(s[o]);return i}}();function $c(e){return e?e.content&&e.type?Pt(e.content,!0):e.data?_a(e.data):e.asNodeBuffer&&we?_a(e.asNodeBuffer().toString("binary")):e.asBinary?_a(e.asBinary()):e._data&&e._data.getContent?_a(Pt(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function jc(e){if(!e)return null;if(e.data)return Vi(e.data);if(e.asNodeBuffer&&we)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?Vi(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function fd(e){return e&&e.name.slice(-4)===".bin"?jc(e):$c(e)}function Or(e,r){for(var t=e.FullPaths||qr(e.files),a=r.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<t.length;++s){var i=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||n==i)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function qs(e,r){var t=Or(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function He(e,r,t){if(!t)return fd(qs(e,r));if(!r)return null;try{return He(e,r)}catch{return null}}function Tr(e,r,t){if(!t)return $c(qs(e,r));if(!r)return null;try{return Tr(e,r)}catch{return null}}function hd(e,r,t){return jc(qs(e,r))}function ao(e){for(var r=e.FullPaths||qr(e.files),t=[],a=0;a<r.length;++a)r[a].slice(-1)!="/"&&t.push(r[a].replace(/^Root Entry[\/]/,""));return t.sort()}function dd(e,r,t){if(e.FullPaths){if(typeof t=="string"){var a;return we?a=Lt(t):a=Ih(t),ye.utils.cfb_add(e,r,a)}ye.utils.cfb_add(e,r,t)}else e.file(r,t)}function Hc(e,r){switch(r.type){case"base64":return ye.read(e,{type:"base64"});case"binary":return ye.read(e,{type:"binary"});case"buffer":case"array":return ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function ya(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?t.pop():n!=="."&&t.push(n)}return t.join("/")}var Wc=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,no=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,xd=/<[^>]*>/g,fr=Wc.match(no)?no:xd,gd=/<\w*:/,vd=/<(\/?)\w+:/;function he(e,r,t){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(r||(a[0]=e.slice(0,n)),n===e.length)return a;var i=e.match(pd),o=0,c="",l=0,u="",f="",h=1;if(i)for(l=0;l!=i.length;++l){for(f=i[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(u=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(n=f.charCodeAt(s+1))==34||n==39?1:0,c=f.slice(s+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var d=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(a[d]&&u.slice(o-3,o)=="ext")continue;a[d]=c,a[d.toLowerCase()]=c}}return a}function zr(e){return e.replace(vd,"<$1")}var Vc={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},md=Ks(Vc),ke=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(o,c){return Vc[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=n.indexOf("]]>");return t(n.slice(0,s))+n.slice(s+9,i)+t(n.slice(i+3))}}(),_d=/[&<>'"]/g,wd=/[\u0000-\u001f]/g;function zs(e){var r=e+"";return r.replace(_d,function(t){return md[t]}).replace(/\n/g,"<br/>").replace(wd,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var so=function(){var e=/&#(\d+);/g;function r(t,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,r)}}();function Fe(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ss(e){for(var r="",t=0,a=0,n=0,s=0,i=0,o=0;t<e.length;){if(a=e.charCodeAt(t++),a<128){r+=String.fromCharCode(a);continue}if(n=e.charCodeAt(t++),a>191&&a<224){i=(a&31)<<6,i|=n&63,r+=String.fromCharCode(i);continue}if(s=e.charCodeAt(t++),a<240){r+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}i=e.charCodeAt(t++),o=((a&7)<<18|(n&63)<<12|(s&63)<<6|i&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function io(e){var r=xt(2*e.length),t,a,n=1,s=0,i=0,o;for(a=0;a<e.length;a+=n)n=1,(o=e.charCodeAt(a))<128?t=o:o<224?(t=(o&31)*64+(e.charCodeAt(a+1)&63),n=2):o<240?(t=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,t=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),t-=65536,i=55296+(t>>>10&1023),t=56320+(t&1023)),i!==0&&(r[s++]=i&255,r[s++]=i>>>8,i=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function oo(e){return Lt(e,"binary").toString("utf8")}var xn="foo bar baz",Oe=we&&(oo(xn)==ss(xn)&&oo||io(xn)==ss(xn)&&io)||ss,Ea=we?function(e){return Lt(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,a=0,n=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:r.push(String.fromCharCode(a));break;case a<2048:r.push(String.fromCharCode(192+(a>>6))),r.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(t++)-56320+(a<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(a>>12))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)))}return r.join("")},Wa=function(){var e={};return function(t,a){var n=t+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",a||"")}}(),Gc=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),yd=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Ed=/<\/?(?:vt:)?variant>/g,Td=/<(?:vt:)([^>]*)>([\s\S]*)</;function co(e,r){var t=he(e),a=e.match(yd(t.baseType))||[],n=[];if(a.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return n}return a.forEach(function(s){var i=s.replace(Ed,"").match(Td);i&&n.push({v:Oe(i[2]),t:i[1]})}),n}var kd=/(^\s|\s$|\n)/;function Ad(e){return qr(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Sd(e,r,t){return"<"+e+(t!=null?Ad(t):"")+(r!=null?(r.match(kd)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Xs(e){if(we&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Oe(Bt(Ws(e)));throw new Error("Bad input format: expected Buffer or string")}var Va=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,bd={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Cd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Od(e,r){for(var t=1-2*(e[r+7]>>>7),a=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),n=e[r+6]&15,s=5;s>=0;--s)n=n*256+e[r+s];return a==2047?n==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),t*Math.pow(2,a-52)*n)}function Rd(e,r,t){var a=(r<0||1/r==-1/0?1:0)<<7,n=0,s=0,i=a?-r:r;isFinite(i)?i==0?n=s=0:(n=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(r)?26985:0);for(var o=0;o<=5;++o,s/=256)e[t+o]=s&255;e[t+6]=(n&15)<<4|s&15,e[t+7]=n>>4|a}var lo=function(e){for(var r=[],t=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=t)r.push.apply(r,e[0][a].slice(n,n+t));return r},uo=we?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Lt(r)})):lo(e)}:lo,fo=function(e,r,t){for(var a=[],n=r;n<t;n+=2)a.push(String.fromCharCode(et(e,n)));return a.join("").replace(gr,"")},Ys=we?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(gr,""):fo(e,r,t)}:fo,ho=function(e,r,t){for(var a=[],n=r;n<r+t;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},Kc=we?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):ho(e,r,t)}:ho,po=function(e,r,t){for(var a=[],n=r;n<t;n++)a.push(String.fromCharCode(Zt(e,n)));return a.join("")},Za=we?function(r,t,a){return Buffer.isBuffer(r)?r.toString("utf8",t,a):po(r,t,a)}:po,qc=function(e,r){var t=yr(e,r);return t>0?Za(e,r+4,r+4+t-1):""},zc=qc,Xc=function(e,r){var t=yr(e,r);return t>0?Za(e,r+4,r+4+t-1):""},Yc=Xc,Jc=function(e,r){var t=2*yr(e,r);return t>0?Za(e,r+4,r+4+t-1):""},Zc=Jc,Qc=function(r,t){var a=yr(r,t);return a>0?Ys(r,t+4,t+4+a):""},e0=Qc,r0=function(e,r){var t=yr(e,r);return t>0?Za(e,r+4,r+4+t):""},t0=r0,a0=function(e,r){return Od(e,r)},Dn=a0,n0=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};we&&(zc=function(r,t){if(!Buffer.isBuffer(r))return qc(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},Yc=function(r,t){if(!Buffer.isBuffer(r))return Xc(r,t);var a=r.readUInt32LE(t);return a>0?r.toString("utf8",t+4,t+4+a-1):""},Zc=function(r,t){if(!Buffer.isBuffer(r))return Jc(r,t);var a=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a-1)},e0=function(r,t){if(!Buffer.isBuffer(r))return Qc(r,t);var a=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+a)},t0=function(r,t){if(!Buffer.isBuffer(r))return r0(r,t);var a=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+a)},Dn=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):a0(r,t)},n0=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Zt=function(e,r){return e[r]},et=function(e,r){return e[r+1]*256+e[r]},Fd=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},yr=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},At=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Id=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Aa(e,r){var t="",a,n,s=[],i,o,c,l;switch(r){case"dbcs":if(l=this.l,we&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(et(this,l)),l+=2;e*=2;break;case"utf8":t=Za(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Ys(this,this.l,this.l+e);break;case"wstr":return Aa.call(this,e,"dbcs");case"lpstr-ansi":t=zc(this,this.l),e=4+yr(this,this.l);break;case"lpstr-cp":t=Yc(this,this.l),e=4+yr(this,this.l);break;case"lpwstr":t=Zc(this,this.l),e=4+2*yr(this,this.l);break;case"lpp4":e=4+yr(this,this.l),t=e0(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+yr(this,this.l),t=t0(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(i=Zt(this,this.l+e++))!==0;)s.push(pn(i));t=s.join("");break;case"_wstr":for(e=0,t="";(i=et(this,this.l+e))!==0;)s.push(pn(i)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",l=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=Zt(this,l),this.l=l+1,o=Aa.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(pn(et(this,l))),l+=2}t=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",l=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return i=Zt(this,l),this.l=l+1,o=Aa.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(pn(Zt(this,l))),l+=1}t=s.join("");break;default:switch(e){case 1:return a=Zt(this,this.l),this.l++,a;case 2:return a=(r==="i"?Fd:et)(this,this.l),this.l+=2,a;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(a=(e>0?At:Id)(this,this.l),this.l+=4,a):(n=yr(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return e==8?n=Dn(this,this.l):n=Dn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:t=Kc(this,this.l,e);break}}return this.l+=e,t}var Dd=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Pd=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Nd=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Ld(e,r,t){var a=0,n=0;if(t==="dbcs"){for(n=0;n!=r.length;++n)Nd(this,r.charCodeAt(n),this.l+2*n);a=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;a=r.length}else if(t==="hex"){for(;n<e;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(r.length,e);++n){var i=r.charCodeAt(n);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=r&255;break;case 2:a=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:a=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:a=4,Dd(this,r,this.l);break;case 8:if(a=8,t==="f"){Rd(this,r,this.l);break}case 16:break;case-4:a=4,Pd(this,r,this.l);break}return this.l+=a,this}function s0(e,r){var t=Kc(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function er(e,r){e.l=r,e.read_shift=Aa,e.chk=s0,e.write_shift=Ld}function lr(e,r){e.l+=r}function qe(e){var r=xt(e);return er(r,0),r}function st(e,r,t){if(e){var a,n,s;er(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var l=Un[o]||Un[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;c=e.l+s;var u=l.f&&l.f(e,s,t);if(e.l=c,r(u,l,o))return}}}function bs(){var e=[],r=we?256:2048,t=function(l){var u=qe(l);return er(u,0),u},a=t(r),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(l){return a&&l<a.length-a.l?a:(n(),a=t(Math.max(l+1,r)))},i=function(){return n(),ft(e)},o=function(l){n(),a=l,a.l==null&&(a.l=a.length),s(r)};return{next:s,push:o,end:i,_bufs:e}}function Sa(e,r,t){var a=rr(e);if(r.s?(a.cRel&&(a.c+=r.s.c),a.rRel&&(a.r+=r.s.r)):(a.cRel&&(a.c+=r.c),a.rRel&&(a.r+=r.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function xo(e,r,t){var a=rr(e);return a.s=Sa(a.s,r.s,t),a.e=Sa(a.e,r.s,t),a}function ba(e,r){if(e.cRel&&e.c<0)for(e=rr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=rr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=xe(e);return!e.cRel&&e.cRel!=null&&(t=Ud(t)),!e.rRel&&e.rRel!=null&&(t=Bd(t)),t}function is(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ze(e.s.c)+":"+(e.e.cRel?"":"$")+ze(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+tr(e.s.r)+":"+(e.e.rRel?"":"$")+tr(e.e.r):ba(e.s,r.biff)+":"+ba(e.e,r.biff)}function Js(e){return parseInt(Md(e),10)-1}function tr(e){return""+(e+1)}function Bd(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Md(e){return e.replace(/\$(\d+)$/,"$1")}function Zs(e){for(var r=$d(e),t=0,a=0;a!==r.length;++a)t=26*t+r.charCodeAt(a)-64;return t-1}function ze(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Ud(e){return e.replace(/^([A-Z])/,"$$$1")}function $d(e){return e.replace(/^\$([A-Z])/,"$1")}function jd(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(e){for(var r=0,t=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(t=26*t+(n-64))}return{c:t-1,r:r-1}}function xe(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function la(e){var r=e.indexOf(":");return r==-1?{s:xr(e),e:xr(e)}:{s:xr(e.slice(0,r)),e:xr(e.slice(r+1))}}function Ee(e,r){return typeof r>"u"||typeof r=="number"?Ee(e.s,e.e):(typeof e!="string"&&(e=xe(e)),typeof r!="string"&&(r=xe(r)),e==r?e:e+":"+r)}function Le(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,n=0,s=e.length;for(t=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.s.c=--t,t=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;if(r.s.r=--t,a===s||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++a,t=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)t=26*t+n;for(r.e.c=--t,t=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)t=10*t+n;return r.e.r=--t,r}function go(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Rr(e.z,t?vr(r):r)}catch{}try{return e.w=Rr((e.XF||{}).numFmtId||(t?14:0),t?vr(r):r)}catch{return""+r}}function at(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?$t[e.v]||e.v:r==null?go(e,e.v):go(e,r))}function vt(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function i0(e,r,t){var a=t||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),i=0,o=0;if(s&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?xr(a.origin):a.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Le(s["!ref"]);l.s.c=u.s.c,l.s.r=u.s.r,l.e.c=Math.max(l.e.c,u.e.c),l.e.r=Math.max(l.e.r,u.e.r),i==-1&&(l.e.r=i=u.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=r[f].length;++h)if(!(typeof r[f][h]>"u")){var d={v:r[f][h]},x=i+f,p=o+h;if(l.s.r>x&&(l.s.r=x),l.s.c>p&&(l.s.c=p),l.e.r<x&&(l.e.r=x),l.e.c<p&&(l.e.c=p),r[f][h]&&typeof r[f][h]=="object"&&!Array.isArray(r[f][h])&&!(r[f][h]instanceof Date))d=r[f][h];else if(Array.isArray(d.v)&&(d.f=r[f][h][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(a.nullError)d.t="e",d.v=0;else if(a.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=a.dateNF||ve[14],a.cellDates?(d.t="d",d.w=Rr(d.z,vr(d.v))):(d.t="n",d.v=vr(d.v),d.w=Rr(d.z,d.v))):d.t="s";if(n)s[x]||(s[x]=[]),s[x][p]&&s[x][p].z&&(d.z=s[x][p].z),s[x][p]=d;else{var g=xe({c:p,r:x});s[g]&&s[g].z&&(d.z=s[g].z),s[g]=d}}}return l.s.c<1e7&&(s["!ref"]=Ee(l)),s}function ua(e,r){return i0(null,e,r)}function Hd(e){return e.read_shift(4,"i")}function cr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Wd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Qs(e,r){var t=e.l,a=e.read_shift(1),n=cr(e),s=[],i={t:n,h:n};if(a&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(Wd(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=t+r,i}var Vd=Qs;function Fr(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Mt(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var Gd=cr;function ei(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var Kd=cr,Cs=ei;function ri(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,a=r[0]&2;e.l+=4;var n=a===0?Dn([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):At(r,0)>>2;return t?n/100:n}function o0(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Ut=o0;function ir(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function qd(e){var r={},t=e.read_shift(1),a=t>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:r.auto=1;break;case 1:r.index=n;var l=Rt[n];l&&(r.rgb=Ka(l));break;case 2:r.rgb=Ka([i,o,c]);break;case 3:r.theme=n;break}return s!=0&&(r.tint=s>0?s/32767:s/32768),r}function zd(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function c0(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function Xd(e){return c0(e,1)}function Yd(e){return c0(e,2)}var ti=2,mr=3,gn=11,vo=12,Pn=19,vn=64,Jd=65,Zd=71,Qd=4108,e1=4126,Ye=80,l0=81,r1=[Ye,l0],t1={1:{n:"CodePage",t:ti},2:{n:"Category",t:Ye},3:{n:"PresentationFormat",t:Ye},4:{n:"ByteCount",t:mr},5:{n:"LineCount",t:mr},6:{n:"ParagraphCount",t:mr},7:{n:"SlideCount",t:mr},8:{n:"NoteCount",t:mr},9:{n:"HiddenCount",t:mr},10:{n:"MultimediaClipCount",t:mr},11:{n:"ScaleCrop",t:gn},12:{n:"HeadingPairs",t:Qd},13:{n:"TitlesOfParts",t:e1},14:{n:"Manager",t:Ye},15:{n:"Company",t:Ye},16:{n:"LinksUpToDate",t:gn},17:{n:"CharacterCount",t:mr},19:{n:"SharedDoc",t:gn},22:{n:"HyperlinksChanged",t:gn},23:{n:"AppVersion",t:mr,p:"version"},24:{n:"DigSig",t:Jd},26:{n:"ContentType",t:Ye},27:{n:"ContentStatus",t:Ye},28:{n:"Language",t:Ye},29:{n:"Version",t:Ye},255:{},2147483648:{n:"Locale",t:Pn},2147483651:{n:"Behavior",t:Pn},1919054434:{}},a1={1:{n:"CodePage",t:ti},2:{n:"Title",t:Ye},3:{n:"Subject",t:Ye},4:{n:"Author",t:Ye},5:{n:"Keywords",t:Ye},6:{n:"Comments",t:Ye},7:{n:"Template",t:Ye},8:{n:"LastAuthor",t:Ye},9:{n:"RevNumber",t:Ye},10:{n:"EditTime",t:vn},11:{n:"LastPrinted",t:vn},12:{n:"CreatedDate",t:vn},13:{n:"ModifiedDate",t:vn},14:{n:"PageCount",t:mr},15:{n:"WordCount",t:mr},16:{n:"CharCount",t:mr},17:{n:"Thumbnail",t:Zd},18:{n:"Application",t:Ye},19:{n:"DocSecurity",t:mr},255:{},2147483648:{n:"Locale",t:Pn},2147483651:{n:"Behavior",t:Pn},1919054434:{}},mo={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},n1=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function s1(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var i1=s1([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rt=rr(i1),$t={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},u0={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},_o={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function o1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function c1(e){var r=o1();if(!e||!e.match)return r;var t={};if((e.match(fr)||[]).forEach(function(a){var n=he(a);switch(n[0].replace(gd,"<")){case"<?xml":break;case"<Types":r.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[n.Extension]=n.ContentType;break;case"<Override":r[_o[n.ContentType]]!==void 0&&r[_o[n.ContentType]].push(n.PartName);break}}),r.xmlns!==bd.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var ea={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Os(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Ca(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var a={};return(e.match(fr)||[]).forEach(function(n){var s=he(n);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:ya(s.Target,r);t[o]=i,a[s.Id]=i}}),t["!id"]=a,t}var l1="application/vnd.oasis.opendocument.spreadsheet";function u1(e,r){for(var t=Xs(e),a,n;a=Va.exec(t);)switch(a[3]){case"manifest":break;case"file-entry":if(n=he(a[0],!1),n.path=="/"&&n.type!==l1)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw a}}var Oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],f1=function(){for(var e=new Array(Oa.length),r=0;r<Oa.length;++r){var t=Oa[r],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function f0(e){var r={};e=Oe(e);for(var t=0;t<Oa.length;++t){var a=Oa[t],n=e.match(f1[t]);n!=null&&n.length>0&&(r[a[1]]=ke(n[1])),a[2]==="date"&&r[a[1]]&&(r[a[1]]=Je(r[a[1]]))}return r}var h1=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function h0(e,r,t,a){var n=[];if(typeof e=="string")n=co(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(u){return{v:u}}));var i=typeof r=="string"?co(r,a).map(function(u){return u.v}):r,o=0,c=0;if(i.length>0)for(var l=0;l!==n.length;l+=2){switch(c=+n[l+1].v,n[l].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=c,t.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=i.slice(o,o+c);break}o+=c}}function d1(e,r,t){var a={};return r||(r={}),e=Oe(e),h1.forEach(function(n){var s=(e.match(Wa(n[0]))||[])[1];switch(n[2]){case"string":s&&(r[n[1]]=ke(s));break;case"bool":r[n[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));i&&i.length>0&&(a[n[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&h0(a.HeadingPairs,a.TitlesOfParts,r,t),r}var p1=/<[^>]+>[^<]*/g;function x1(e,r){var t={},a="",n=e.match(p1);if(n)for(var s=0;s!=n.length;++s){var i=n[s],o=he(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ke(o.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),l=c[0].slice(4),u=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":t[a]=ke(u);break;case"bool":t[a]=Fe(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(u);break;case"filetime":case"date":t[a]=Je(u);break;case"cy":case"error":t[a]=ke(u);break;default:if(l.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",i,l,c)}}else if(i.slice(0,2)!=="</"){if(r.WTF)throw new Error(i)}}}return t}var g1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},os;function v1(e,r,t){os||(os=Ks(g1)),r=os[r]||r,e[r]=t}function ai(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function d0(e,r,t){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return n}function p0(e,r,t){var a=e.read_shift(0,"lpwstr");return a}function x0(e,r,t){return r===31?p0(e):d0(e,r,t)}function Rs(e,r,t){return x0(e,r,t===!1?0:4)}function m1(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return x0(e,r,0)}function _1(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a){var n=e.l;t[a]=e.read_shift(0,"lpwstr").replace(gr,""),e.l-n&2&&(e.l+=2)}return t}function w1(e){for(var r=e.read_shift(4),t=[],a=0;a!=r;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(gr,"");return t}function y1(e){var r=e.l,t=Nn(e,l0);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var a=Nn(e,mr);return[t,a]}function E1(e){for(var r=e.read_shift(4),t=[],a=0;a<r/2;++a)t.push(y1(e));return t}function wo(e,r){for(var t=e.read_shift(4),a={},n=0;n!=t;++n){var s=e.read_shift(4),i=e.read_shift(4);a[s]=e.read_shift(i,r===1200?"utf16le":"utf8").replace(gr,"").replace(wa,"!"),r===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function g0(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function T1(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Nn(e,r,t){var a=e.read_shift(2),n,s=t||{};if(e.l+=2,r!==vo&&a!==r&&r1.indexOf(r)===-1&&!((r&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+r+" saw "+a);switch(r===vo?a:r){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return d0(e,a,4).replace(gr,"");case 31:return p0(e);case 64:return ai(e);case 65:return g0(e);case 71:return T1(e);case 80:return Rs(e,a,!s.raw).replace(gr,"");case 81:return m1(e,a).replace(gr,"");case 4108:return E1(e);case 4126:case 4127:return a==4127?_1(e):w1(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+a)}}function yo(e,r){var t=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0,o=0,c=-1,l={};for(i=0;i!=n;++i){var u=e.read_shift(4),f=e.read_shift(4);s[i]=[u,f+t]}s.sort(function(E,v){return E[1]-v[1]});var h={};for(i=0;i!=n;++i){if(e.l!==s[i][1]){var d=!0;if(i>0&&r)switch(r[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],d=!1);break}if((!r||i==0)&&e.l<=s[i][1]&&(d=!1,e.l=s[i][1]),d)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(r){var x=r[s[i][0]];if(h[x.n]=Nn(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ur(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(s[i][0]===1){if(o=h.CodePage=Nn(e,ti),Ur(o),c!==-1){var p=e.l;e.l=s[c][1],l=wo(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}l=wo(e,o)}else{var g=l[s[i][0]],_;switch(e[e.l]){case 65:e.l+=4,_=g0(e);break;case 30:e.l+=4,_=Rs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Rs(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=$e(e,4);break;case 64:e.l+=4,_=Je(ai(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=_}}return e.l=t+a,h}function Eo(e,r,t){var a=e.content;if(!a)return{};er(a,0);var n,s,i,o,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),u=a.read_shift(16);if(u!==ye.utils.consts.HEADER_CLSID&&u!==t)throw new Error("Bad PropertySet CLSID "+u);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(i=a.read_shift(16),c=a.read_shift(4));var f=yo(a,r),h={SystemIdentifier:l};for(var d in f)h[d]=f[d];if(h.FMTID=s,n===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=yo(a,null)}catch{}for(d in x)h[d]=x[d];return h.FMTID=[s,i],h}function ct(e,r){return e.read_shift(r),null}function k1(e,r,t){for(var a=[],n=e.l+r;e.l<n;)a.push(t(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function $e(e,r){return e.read_shift(r)===1}function We(e){return e.read_shift(2,"u")}function v0(e,r){return k1(e,r,We)}function A1(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Qa(e,r,t){var a=e.read_shift(t&&t.biff>=12?2:1),n="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else t.biff==12&&(n="wstr");t.biff>=2&&t.biff<=5&&(n="cpstr");var i=a?e.read_shift(a,n):"";return i}function S1(e){var r=e.read_shift(2),t=e.read_shift(1),a=t&4,n=t&8,s=1+(t&1),i=0,o,c={};n&&(i=e.read_shift(2)),a&&(o=e.read_shift(4));var l=s==2?"dbcs-cont":"sbcs-cont",u=r===0?"":e.read_shift(r,l);return n&&(e.l+=4*i),a&&(e.l+=o),c.t=u,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Nt(e,r,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(r,"sbcs-cont"):a=e.read_shift(r,"dbcs-cont"),a}function en(e,r,t){var a=e.read_shift(t&&t.biff==2?1:2);return a===0?(e.l++,""):Nt(e,a,t)}function jt(e,r,t){if(t.biff>5)return en(e,r,t);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function b1(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function C1(e){var r=e.read_shift(4),t=e.l,a=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=t);var n=e.read_shift((a?r-24:r)>>1,"utf16le").replace(gr,"");return a&&(e.l+=24),n}function O1(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return t+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(gr,"");return t+i}function R1(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return C1(e);case"0303000000000000c000000000000046":return O1(e);default:throw new Error("Unsupported Moniker "+t)}}function mn(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(gr,""):"";return t}function F1(e,r){var t=e.l+r,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,i,o,c,l="",u,f;n&16&&(s=mn(e,t-e.l)),n&128&&(i=mn(e,t-e.l)),(n&257)===257&&(o=mn(e,t-e.l)),(n&257)===1&&(c=R1(e,t-e.l)),n&8&&(l=mn(e,t-e.l)),n&32&&(u=e.read_shift(16)),n&64&&(f=ai(e)),e.l=t;var h=i||o||c||"";h&&l&&(h+="#"+l),h||(h="#"+l),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var d={Target:h};return u&&(d.guid=u),f&&(d.time=f),s&&(d.Tooltip=s),d}function m0(e){var r=e.read_shift(1),t=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[r,t,a,n]}function _0(e,r){var t=m0(e);return t[3]=0,t}function Xr(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return{r,c:t,ixfe:a}}function I1(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function D1(e,r,t){return r===0?"":jt(e,r,t)}function P1(e,r,t){var a=t.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[n,s,i]}function w0(e){var r=e.read_shift(2),t=ri(e);return[r,t]}function N1(e,r,t){e.l+=4,r-=4;var a=e.l+r,n=Qa(e,r,t),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function Kn(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r},e:{c:n,r:t}}}function y0(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r},e:{c:n,r:t}}}var L1=y0;function E0(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,r,a]}function B1(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function M1(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function nr(e){e.l+=2,e.l+=e.read_shift(2)}var U1={0:nr,4:nr,5:nr,6:nr,7:M1,8:nr,9:nr,10:nr,11:nr,12:nr,13:B1,14:nr,15:nr,16:nr,17:nr,18:nr,19:nr,20:nr,21:E0};function $1(e,r){for(var t=e.l+r,a=[];e.l<t;){var n=e.read_shift(2);e.l-=2;try{a.push(U1[n](e,t-e.l))}catch{return e.l=t,a}}return e.l!=t&&(e.l=t),a}function _n(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function j1(e,r){return r===0||e.read_shift(2),1200}function H1(e,r,t){if(t.enc)return e.l+=r,"";var a=e.l,n=jt(e,0,t);return e.read_shift(r+a-e.l),n}function W1(e,r,t){var a=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function V1(e,r,t){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Qa(e,0,t);return i.length===0&&(i="Sheet1"),{pos:a,hs:n,dt:s,name:i}}function G1(e,r){for(var t=e.l+r,a=e.read_shift(4),n=e.read_shift(4),s=[],i=0;i!=n&&e.l<t;++i)s.push(S1(e));return s.Count=a,s.Unique=n,s}function K1(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function q1(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(r.level=a&7),a&32&&(r.hidden=!0),a&64&&(r.hpt=t/20),r}function z1(e){var r=I1(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function X1(e){return e.read_shift(2),e.read_shift(4)}function To(e,r,t){var a=0;t&&t.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);t&&t.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function Y1(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2);return{Pos:[r,t],Dim:[a,n],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:l}}function J1(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function Z1(){}function Q1(e,r,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Qa(e,0,t),a}function ep(e){var r=Xr(e);return r.isst=e.read_shift(4),r}function rp(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=e.l+r,n=Xr(e);t.biff==2&&e.l++;var s=en(e,a-e.l,t);return n.val=s,n}function tp(e,r,t){var a=e.read_shift(2),n=jt(e,0,t);return[a,n]}var ap=jt;function ko(e,r,t){var a=e.l+r,n=t.biff==8||!t.biff?4:2,s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:s,c:o},e:{r:i,c}}}function np(e){var r=e.read_shift(2),t=e.read_shift(2),a=w0(e);return{r,c:t,ixfe:a[0],rknum:a[1]}}function sp(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<t;)s.push(w0(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:i,rkrec:s}}function ip(e,r){for(var t=e.l+r-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:i,ixfe:s}}function op(e,r,t,a){var n={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=n1[o>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=i&15,n.dgRight=i>>4&15,n.dgTop=i>>8&15,n.dgBottom=i>>12&15,n.icvLeft=i>>16&127,n.icvRight=i>>23&127,n.grbitDiag=i>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function cp(e,r,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,r-=6,a.data=op(e,r,a.fStyle,t),a}function lp(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Ao(e,r,t){var a=Xr(e);(t.biff==2||r==9)&&++e.l;var n=A1(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function up(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var a=Xr(e),n=ir(e);return a.val=n,a}var So=D1;function fp(e,r,t){var a=e.l+r,n=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Nt(e,s),o=[];a>e.l;)o.push(en(e));return[s,n,i,o]}function bo(e,r,t){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return t.sbcch===14849&&(n=N1(e,r-2,t)),s.body=n||e.read_shift(r-2),typeof n=="string"&&(s.Name=n),s}var hp=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Co(e,r,t){var a=e.l+r,n=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var l=Nt(e,i,t);n&32&&(l=hp[l.charCodeAt(0)]);var u=a-e.l;t&&t.biff==2&&--u;var f=a==e.l||o===0||!(u>0)?[]:qv(e,u,t,o);return{chKey:s,Name:l,itab:c,rgce:f}}function T0(e,r,t){if(t.biff<8)return dp(e,r,t);for(var a=[],n=e.l+r,s=e.read_shift(t.biff>8?4:2);s--!==0;)a.push(P1(e,t.biff>8?12:6,t));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function dp(e,r,t){e[e.l+1]==3&&e[e.l]++;var a=Qa(e,r,t);return a.charCodeAt(0)==3?a.slice(1):a}function pp(e,r,t){if(t.biff<8){e.l+=r;return}var a=e.read_shift(2),n=e.read_shift(2),s=Nt(e,a,t),i=Nt(e,n,t);return[s,i]}function xp(e,r,t){var a=y0(e);e.l++;var n=e.read_shift(1);return r-=8,[zv(e,r,t),n,a]}function Oo(e,r,t){var a=L1(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[a,Gv(e,r,t)]}function gp(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,a=e.read_shift(4);return[r,t,a]}function vp(e,r,t){if(!(t.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=jt(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:n},o,i,s]}}function mp(e,r,t){return vp(e,r,t)}function _p(e,r){for(var t=[],a=e.read_shift(2);a--;)t.push(Kn(e));return t}function wp(e,r,t){if(t&&t.biff<8)return Ep(e,r,t);var a=E0(e),n=$1(e,r-22,a[1]);return{cmo:a,ft:n}}var yp={8:function(e,r){var t=e.l+r;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=t,{fmt:a}}};function Ep(e,r,t){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var i=[];return i.push((yp[a]||lr)(e,r,t)),{cmo:[n,a,s],ft:i}}function Tp(e,r,t){var a=e.l,n="";try{e.l+=4;var s=(t.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=b1(e,6,t);var o=e.read_shift(2);e.read_shift(2),We(e,2);var c=e.read_shift(2);e.l+=c;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var u=e[e.l],f=Nt(e,e.lens[l+1]-e.lens[l]-1);if(n+=f,n.length>=(u?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=a+r,{t:n}}catch{return e.l=a+r,{t:n}}}function kp(e,r){var t=Kn(e);e.l+=16;var a=F1(e,r-24);return[t,a]}function Ap(e,r){e.read_shift(2);var t=Kn(e),a=e.read_shift((r-10)/2,"dbcs-cont");return a=a.replace(gr,""),[t,a]}function Sp(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=mo[t]||t,t=e.read_shift(2),r[1]=mo[t]||t,r}function bp(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(_0(e));return t}function Cp(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(_0(e));return t}function Op(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function k0(e,r,t){if(!t.cellStyles)return lr(e,r);var a=t&&t.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:s,w:i,ixfe:o,flags:c};return(t.biff>=5||!t.biff)&&(l.level=c>>8&7),l}function Rp(e,r){var t={};return r<32||(e.l+=16,t.header=ir(e),t.footer=ir(e),e.l+=2),t}function Fp(e,r,t){var a={area:!1};if(t.biff!=5)return e.l+=r,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}var Ip=Xr,Dp=v0,Pp=en;function Np(e){var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n={fmt:r,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function Lp(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var a=Xr(e);++e.l;var n=jt(e,r-7,t);return a.t="str",a.val=n,a}function Bp(e){var r=Xr(e);++e.l;var t=ir(e);return r.t="n",r.val=t,r}function Mp(e){var r=Xr(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Up(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function $p(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function jp(e,r,t){var a=e.l+r,n=Xr(e),s=e.read_shift(2),i=Nt(e,s,t);return e.l=a,n.t="str",n.val=i,n}var Hp=[2,3,48,49,131,139,140,245],Ro=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ks({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(o,c){var l=[],u=xt(1);switch(c.type){case"base64":u=Br(kr(o));break;case"binary":u=Br(o);break;case"buffer":case"array":u=o;break}er(u,0);var f=u.read_shift(1),h=!!(f&136),d=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:d=!0,h=!0;break;case 49:d=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var _=u.read_shift(2),E=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(E=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],O={},F=Math.min(u.length,f==2?521:g-10-(d?264:0)),R=x?32:11;u.l<F&&u[u.l]!=13;)switch(O={},O.name=ja.utils.decode(E,u.slice(u.l,u.l+R)).replace(/[\u0000\r\n].*$/g,""),u.l+=R,O.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(O.offset=u.read_shift(4)),O.len=u.read_shift(1),f==2&&(O.offset=u.read_shift(2)),O.dec=u.read_shift(1),O.name.length&&v.push(O),f!=2&&(u.l+=x?13:14),O.type){case"B":(!d||O.len!=8)&&c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var k=0,L=0;for(l[0]=[],L=0;L!=v.length;++L)l[0][L]=v[L].name;for(;p-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,l[++k]=[],L=0,L=0;L!=v.length;++L){var I=u.slice(u.l,u.l+v[L].len);u.l+=v[L].len,er(I,0);var G=ja.utils.decode(E,I);switch(v[L].type){case"C":G.trim().length&&(l[k][L]=G.replace(/\s+$/,""));break;case"D":G.length===8?l[k][L]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):l[k][L]=G;break;case"F":l[k][L]=parseFloat(G.trim());break;case"+":case"I":l[k][L]=x?I.read_shift(-4,"i")^2147483648:I.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":l[k][L]=!0;break;case"N":case"F":l[k][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[k][L]="##MEMO##"+(x?parseInt(G.trim(),10):I.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(l[k][L]=+G||0);break;case"@":l[k][L]=new Date(I.read_shift(-8,"f")-621356832e5);break;case"T":l[k][L]=new Date((I.read_shift(4)-2440588)*864e5+I.read_shift(4));break;case"Y":l[k][L]=I.read_shift(4,"i")/1e4+I.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[k][L]=-I.read_shift(-8,"f");break;case"B":if(d&&v[L].len==8){l[k][L]=I.read_shift(8,"f");break}case"G":case"P":I.l+=v[L].len;break;case"0":if(v[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[L].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=v,l}function a(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var u=ua(t(o,l),l);return u["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,u}function n(o,c){try{return vt(a(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var l=c||{};if(+l.codepage>=0&&Ur(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var u=bs(),f=Bs(o,{header:1,raw:!0,cellDates:!0}),h=f[0],d=f.slice(1),x=o["!cols"]||[],p=0,g=0,_=0,E=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++_;continue}if(h[p]!=null){if(++_,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=Le(o["!ref"]),O=[],F=[],R=[];for(p=0;p<=v.e.c-v.s.c;++p){var k="",L="",I=0,G=[];for(g=0;g<d.length;++g)d[g][p]!=null&&G.push(d[g][p]);if(G.length==0||h[p]==null){O[p]="?";continue}for(g=0;g<G.length;++g){switch(typeof G[g]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=G[g]instanceof Date?"D":"C";break;default:L="C"}I=Math.max(I,String(G[g]).length),k=k&&k!=L?"C":L}I>250&&(I=250),L=((x[p]||{}).DBF||{}).type,L=="C"&&x[p].DBF.len>I&&(I=x[p].DBF.len),k=="B"&&L=="N"&&(k="N",R[p]=x[p].DBF.dec,I=x[p].DBF.len),F[p]=k=="C"||L=="N"?I:s[k]||0,E+=F[p],O[p]=k}var W=u.next(32);for(W.write_shift(4,318902576),W.write_shift(4,d.length),W.write_shift(2,296+32*_),W.write_shift(2,E),p=0;p<4;++p)W.write_shift(4,0);for(W.write_shift(4,0|(+r[Tc]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var N=u.next(32),X=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,X,"sbcs"),N.write_shift(1,O[p]=="?"?"C":O[p],"sbcs"),N.write_shift(4,g),N.write_shift(1,F[p]||s[O[p]]||0),N.write_shift(1,R[p]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),g+=F[p]||s[O[p]]||0}var ce=u.next(264);for(ce.write_shift(4,13),p=0;p<65;++p)ce.write_shift(4,0);for(p=0;p<d.length;++p){var re=u.next(E);for(re.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(O[g]){case"L":re.write_shift(1,d[p][g]==null?63:d[p][g]?84:70);break;case"B":re.write_shift(8,d[p][g]||0,"f");break;case"N":var oe="0";for(typeof d[p][g]=="number"&&(oe=d[p][g].toFixed(R[g]||0)),_=0;_<F[g]-oe.length;++_)re.write_shift(1,32);re.write_shift(1,oe,"sbcs");break;case"D":d[p][g]?(re.write_shift(4,("0000"+d[p][g].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(d[p][g].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+d[p][g].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(d[p][g]!=null?d[p][g]:"").slice(0,F[g]);for(re.write_shift(1,ie,"sbcs"),_=0;_<F[g]-ie.length;++_)re.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:a,from_sheet:i}}(),Wp=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+qr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(h,d){var x=e[d];return typeof x=="number"?Gi(x):x},a=function(h,d,x){var p=d.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:Gi(p)};e["|"]=254;function n(h,d){switch(d.type){case"base64":return s(kr(h),d);case"binary":return s(h,d);case"buffer":return s(we&&Buffer.isBuffer(h)?h.toString("binary"):Bt(h),d);case"array":return s(Pt(h),d)}throw new Error("Unrecognized type "+d.type)}function s(h,d){var x=h.split(/[\n\r]+/),p=-1,g=-1,_=0,E=0,v=[],O=[],F=null,R={},k=[],L=[],I=[],G=0,W;for(+d.codepage>=0&&Ur(+d.codepage);_!==x.length;++_){G=0;var N=x[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(r,t),X=N.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),ce=X[0],re;if(N.length>0)switch(ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&O.push(N.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,ie=!1,Re=!1,V=!1,de=-1,pe=-1;for(E=1;E<X.length;++E)switch(X[E].charAt(0)){case"A":break;case"X":g=parseInt(X[E].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(X[E].slice(1))-1,ie||(g=0),W=v.length;W<=p;++W)v[W]=[];break;case"K":re=X[E].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(jr(re))?isNaN(sa(re).getDate())||(re=Je(re)):(re=jr(re),F!==null&&ca(F)&&(re=Gn(re))),oe=!0;break;case"E":V=!0;var b=aa(X[E].slice(1),{r:p,c:g});v[p][g]=[v[p][g],b];break;case"S":Re=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":de=parseInt(X[E].slice(1))-1;break;case"C":pe=parseInt(X[E].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}if(oe&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=re:v[p][g]=re,F=null),Re){if(V)throw new Error("SYLK shared formula cannot have own formula");var j=de>-1&&v[de][pe];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=P0(j[1],{r:p-de,c:g-pe})}break;case"F":var P=0;for(E=1;E<X.length;++E)switch(X[E].charAt(0)){case"X":g=parseInt(X[E].slice(1))-1,++P;break;case"Y":for(p=parseInt(X[E].slice(1))-1,W=v.length;W<=p;++W)v[W]=[];break;case"M":G=parseInt(X[E].slice(1))/20;break;case"F":break;case"G":break;case"P":F=O[parseInt(X[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(I=X[E].slice(1).split(" "),W=parseInt(I[0],10);W<=parseInt(I[1],10);++W)G=parseInt(I[2],10),L[W-1]=G===0?{hidden:!0}:{wch:G},ia(L[W-1]);break;case"C":g=parseInt(X[E].slice(1))-1,L[g]||(L[g]={});break;case"R":p=parseInt(X[E].slice(1))-1,k[p]||(k[p]={}),G>0?(k[p].hpt=G,k[p].hpx=qa(G)):G===0&&(k[p].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}P<1&&(F=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+N)}}return k.length>0&&(R["!rows"]=k),L.length>0&&(R["!cols"]=L),d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),[v,R]}function i(h,d){var x=n(h,d),p=x[0],g=x[1],_=ua(p,d);return qr(g).forEach(function(E){_[E]=g[E]}),_}function o(h,d){return vt(i(h,d),d)}function c(h,d,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Og(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function l(h,d){d.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Bn(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Mn(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,d){d.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*F0(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,d){var x=["ID;PWXL;N;E"],p=[],g=Le(h["!ref"]),_,E=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&l(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var O=g.s.r;O<=g.e.r;++O)for(var F=g.s.c;F<=g.e.c;++F){var R=xe({r:O,c:F});_=E?(h[O]||[])[F]:h[R],!(!_||_.v==null&&(!_.f||_.F))&&p.push(c(_,h,O,F))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),Vp=function(){function e(s,i){switch(i.type){case"base64":return r(kr(s),i);case"binary":return r(s,i);case"buffer":return r(we&&Buffer.isBuffer(s)?s.toString("binary"):Bt(s),i);case"array":return r(Pt(s),i)}throw new Error("Unrecognized type "+i.type)}function r(s,i){for(var o=s.split(`
`),c=-1,l=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var h=o[u].trim().split(","),d=h[0],x=h[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+d){case-1:if(p==="BOT"){f[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][l]=!0:p==="FALSE"?f[c][l]=!1:isNaN(jr(x))?isNaN(sa(x).getDate())?f[c][l]=x:f[c][l]=Je(x):f[c][l]=jr(x),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function t(s,i){return ua(e(s,i),i)}function a(s,i){return vt(t(s,i),i)}var n=function(){var s=function(c,l,u,f,h){c.push(l),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,l,u,f){c.push(l+","+u),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],u=Le(c["!ref"]),f,h=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,u.e.r-u.s.r+1,""),s(l,"TUPLES",0,u.e.c-u.s.c+1,""),s(l,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){i(l,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var p=xe({r:d,c:x});if(f=h?(c[d]||[])[x]:c[p],!f){i(l,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(l,1,0,"="+f.f):i(l,1,0,""):i(l,0,g,"V");break;case"b":i(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(l,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Rr(f.z||ve[14],vr(Je(f.v)))),i(l,0,f.w,"V");break;default:i(l,1,0,"")}}}i(l,-1,0,"EOD");var _=`\r
`,E=l.join(_);return E}}();return{to_workbook:a,to_sheet:t,from_sheet:n}}(),Gp=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(f,h){for(var d=f.split(`
`),x=-1,p=-1,g=0,_=[];g!==d.length;++g){var E=d[g].trim().split(":");if(E[0]==="cell"){var v=xr(E[1]);if(_.length<=v.r)for(x=_.length;x<=v.r;++x)_[x]||(_[x]=[]);switch(x=v.r,p=v.c,E[2]){case"t":_[x][p]=e(E[3]);break;case"v":_[x][p]=+E[3];break;case"vtf":var O=E[E.length-1];case"vtc":switch(E[3]){case"nl":_[x][p]=!!+E[4];break;default:_[x][p]=+E[4];break}E[2]=="vtf"&&(_[x][p]=[_[x][p],O])}}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function a(f,h){return ua(t(f,h),h)}function n(f,h){return vt(a(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var h=[],d=[],x,p="",g=la(f["!ref"]),_=Array.isArray(f),E=g.s.r;E<=g.e.r;++E)for(var v=g.s.c;v<=g.e.c;++v)if(p=xe({r:E,c:v}),x=_?(f[E]||[])[v]:f[p],!(!x||x.v==null||x.t==="z")){switch(d=["cell",p,"t"],x.t){case"s":case"str":d.push(r(x.v));break;case"n":x.f?(d[2]="vtf",d[3]="n",d[4]=x.v,d[5]=r(x.f)):(d[2]="v",d[3]=x.v);break;case"b":d[2]="vt"+(x.f?"f":"c"),d[3]="nl",d[4]=x.v?"1":"0",d[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var O=vr(Je(x.v));d[2]="vtc",d[3]="nd",d[4]=""+O,d[5]=x.w||Rr(x.z||ve[14],O);break;case"e":continue}h.push(d.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[s,i,o,i,l(f),c].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:u}}(),Ga=function(){function e(u,f,h,d,x){x.raw?f[h][d]=u:u===""||(u==="TRUE"?f[h][d]=!0:u==="FALSE"?f[h][d]=!1:isNaN(jr(u))?isNaN(sa(u).getDate())?f[h][d]=u:f[h][d]=Je(u):f[h][d]=jr(u))}function r(u,f){var h=f||{},d=[];if(!u||u.length===0)return d;for(var x=u.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,_=0,E=0;E<=p;++E)_=x[E].indexOf(" "),_==-1?_=x[E].length:_++,g=Math.max(g,_);for(E=0;E<=p;++E){d[E]=[];var v=0;for(e(x[E].slice(0,g).trim(),d,E,v,h),v=1;v<=(x[E].length-g)/10+1;++v)e(x[E].slice(g+(v-1)*10,g+v*10).trim(),d,E,v,h)}return h.sheetRows&&(d=d.slice(0,h.sheetRows)),d}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(u){for(var f={},h=!1,d=0,x=0;d<u.length;++d)(x=u.charCodeAt(d))==34?h=!h:!h&&x in t&&(f[x]=(f[x]||0)+1);x=[];for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&x.push([f[d],d]);if(!x.length){f=a;for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&x.push([f[d],d])}return x.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),t[x.pop()[1]]||44}function s(u,f){var h=f||{},d="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=n(u.slice(0,1024)):h&&h.FS?d=h.FS:d=n(u.slice(0,1024));var g=0,_=0,E=0,v=0,O=0,F=d.charCodeAt(0),R=!1,k=0,L=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var I=h.dateNF!=null?td(h.dateNF):null;function G(){var W=u.slice(v,O),N={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)N.t="z";else if(h.raw)N.t="s",N.v=W;else if(W.trim().length===0)N.t="s",N.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(N.t="s",N.v=W.slice(2,-1).replace(/""/g,'"')):Fg(W)?(N.t="n",N.f=W.slice(1)):(N.t="s",N.v=W);else if(W=="TRUE")N.t="b",N.v=!0;else if(W=="FALSE")N.t="b",N.v=!1;else if(!isNaN(E=jr(W)))N.t="n",h.cellText!==!1&&(N.w=W),N.v=E;else if(!isNaN(sa(W).getDate())||I&&W.match(I)){N.z=h.dateNF||ve[14];var X=0;I&&W.match(I)&&(W=ad(W,h.dateNF,W.match(I)||[]),X=1),h.cellDates?(N.t="d",N.v=Je(W,X)):(N.t="n",N.v=vr(Je(W,X))),h.cellText!==!1&&(N.w=Rr(N.z,N.v instanceof Date?vr(N.v):N.v)),h.cellNF||delete N.z}else N.t="s",N.v=W;if(N.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][_]=N):x[xe({c:_,r:g})]=N),v=O+1,L=u.charCodeAt(v),p.e.c<_&&(p.e.c=_),p.e.r<g&&(p.e.r=g),k==F)++_;else if(_=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;O<u.length;++O)switch(k=u.charCodeAt(O)){case 34:L===34&&(R=!R);break;case F:case 10:case 13:if(!R&&G())break e;break}return O-v>0&&G(),x["!ref"]=Ee(p),x}function i(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,f):ua(r(u,f),f)}function o(u,f){var h="",d=f.type=="string"?[0,0,0,0]:fi(u,f);switch(f.type){case"base64":h=kr(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof ja<"u"||(h=we&&Buffer.isBuffer(u)?u.toString("binary"):Bt(u));break;case"array":h=Pt(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return d[0]==239&&d[1]==187&&d[2]==191?h=Oe(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Oe(h):f.type=="binary"&&typeof ja<"u",h.slice(0,19)=="socialcalc:version:"?Gp.to_sheet(f.type=="string"?h:Oe(h),f):i(h,f)}function c(u,f){return vt(o(u,f),f)}function l(u){for(var f=[],h=Le(u["!ref"]),d,x=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],_=h.s.c;_<=h.e.c;++_){var E=xe({r:p,c:_});if(d=x?(u[p]||[])[_]:u[E],!d||d.v==null){g.push("          ");continue}for(var v=(d.w||(at(d),d.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(_===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function Kp(e,r){var t=r||{},a=!!t.WTF;t.WTF=!0;try{var n=Wp.to_workbook(e,t);return t.WTF=a,n}catch(s){if(t.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return Ga.to_workbook(e,r)}}var Ra=function(){function e(b,j,P){if(b){er(b,b.l||0);for(var D=P.Enum||de;b.l<b.length;){var q=b.read_shift(2),ee=D[q]||D[65535],ne=b.read_shift(2),Z=b.l+ne,Y=ee.f&&ee.f(b,ne,P);if(b.l=Z,j(Y,ee,q))return}}}function r(b,j){switch(j.type){case"base64":return t(Br(kr(b)),j);case"binary":return t(Br(b),j);case"buffer":case"array":return t(b,j)}throw"Unsupported type "+j.type}function t(b,j){if(!b)return b;var P=j||{},D=P.dense?[]:{},q="Sheet1",ee="",ne=0,Z={},Y=[],Te=[],C={s:{r:0,c:0},e:{r:0,c:0}},Be=P.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)P.Enum=de,e(b,function(te,Me,Ar){switch(Ar){case 0:P.vers=te,te>=4096&&(P.qpro=!0);break;case 6:C=te;break;case 204:te&&(ee=te);break;case 222:ee=te;break;case 15:case 51:P.qpro||(te[1].v=te[1].v.slice(1));case 13:case 14:case 16:Ar==14&&(te[2]&112)==112&&(te[2]&15)>1&&(te[2]&15)<15&&(te[1].z=P.dateNF||ve[14],P.cellDates&&(te[1].t="d",te[1].v=Gn(te[1].v))),P.qpro&&te[3]>ne&&(D["!ref"]=Ee(C),Z[q]=D,Y.push(q),D=P.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},ne=te[3],q=ee||"Sheet"+(ne+1),ee="");var Hr=P.dense?(D[te[0].r]||[])[te[0].c]:D[xe(te[0])];if(Hr){Hr.t=te[1].t,Hr.v=te[1].v,te[1].z!=null&&(Hr.z=te[1].z),te[1].f!=null&&(Hr.f=te[1].f);break}P.dense?(D[te[0].r]||(D[te[0].r]=[]),D[te[0].r][te[0].c]=te[1]):D[xe(te[0])]=te[1];break}},P);else if(b[2]==26||b[2]==14)P.Enum=pe,b[2]==14&&(P.qpro=!0,b.l=0),e(b,function(te,Me,Ar){switch(Ar){case 204:q=te;break;case 22:te[1].v=te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(te[3]>ne&&(D["!ref"]=Ee(C),Z[q]=D,Y.push(q),D=P.dense?[]:{},C={s:{r:0,c:0},e:{r:0,c:0}},ne=te[3],q="Sheet"+(ne+1)),Be>0&&te[0].r>=Be)break;P.dense?(D[te[0].r]||(D[te[0].r]=[]),D[te[0].r][te[0].c]=te[1]):D[xe(te[0])]=te[1],C.e.c<te[0].c&&(C.e.c=te[0].c),C.e.r<te[0].r&&(C.e.r=te[0].r);break;case 27:te[14e3]&&(Te[te[14e3][0]]=te[14e3][1]);break;case 1537:Te[te[0]]=te[1],te[0]==ne&&(q=te[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(D["!ref"]=Ee(C),Z[ee||q]=D,Y.push(ee||q),!Te.length)return{SheetNames:Y,Sheets:Z};for(var Ae={},be=[],_e=0;_e<Te.length;++_e)Z[Y[_e]]?(be.push(Te[_e]||Y[_e]),Ae[Te[_e]]=Z[Te[_e]]||Z[Y[_e]]):(be.push(Te[_e]),Ae[Te[_e]]={"!ref":"A1"});return{SheetNames:be,Sheets:Ae}}function a(b,j){var P=j||{};if(+P.codepage>=0&&Ur(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var D=bs(),q=Le(b["!ref"]),ee=Array.isArray(b),ne=[];Dr(D,0,s(1030)),Dr(D,6,c(q));for(var Z=Math.min(q.e.r,8191),Y=q.s.r;Y<=Z;++Y)for(var Te=tr(Y),C=q.s.c;C<=q.e.c;++C){Y===q.s.r&&(ne[C]=ze(C));var Be=ne[C]+Te,Ae=ee?(b[Y]||[])[C]:b[Be];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?Dr(D,13,d(Y,C,Ae.v)):Dr(D,14,p(Y,C,Ae.v));else{var be=at(Ae);Dr(D,15,f(Y,C,be.slice(0,239)))}}return Dr(D,1),D.end()}function n(b,j){var P=j||{};if(+P.codepage>=0&&Ur(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var D=bs();Dr(D,0,i(b));for(var q=0,ee=0;q<b.SheetNames.length;++q)(b.Sheets[b.SheetNames[q]]||{})["!ref"]&&Dr(D,27,V(b.SheetNames[q],ee++));var ne=0;for(q=0;q<b.SheetNames.length;++q){var Z=b.Sheets[b.SheetNames[q]];if(!(!Z||!Z["!ref"])){for(var Y=Le(Z["!ref"]),Te=Array.isArray(Z),C=[],Be=Math.min(Y.e.r,8191),Ae=Y.s.r;Ae<=Be;++Ae)for(var be=tr(Ae),_e=Y.s.c;_e<=Y.e.c;++_e){Ae===Y.s.r&&(C[_e]=ze(_e));var te=C[_e]+be,Me=Te?(Z[Ae]||[])[_e]:Z[te];if(!(!Me||Me.t=="z"))if(Me.t=="n")Dr(D,23,G(Ae,_e,ne,Me.v));else{var Ar=at(Me);Dr(D,22,k(Ae,_e,ne,Ar.slice(0,239)))}}++ne}}return Dr(D,1),D.end()}function s(b){var j=qe(2);return j.write_shift(2,b),j}function i(b){var j=qe(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var P=0,D=0,q=0,ee=0;ee<b.SheetNames.length;++ee){var ne=b.SheetNames[ee],Z=b.Sheets[ne];if(!(!Z||!Z["!ref"])){++q;var Y=la(Z["!ref"]);P<Y.e.r&&(P=Y.e.r),D<Y.e.c&&(D=Y.e.c)}}return P>8191&&(P=8191),j.write_shift(2,P),j.write_shift(1,q),j.write_shift(1,D),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(b,j,P){var D={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&P.qpro?(D.s.c=b.read_shift(1),b.l++,D.s.r=b.read_shift(2),D.e.c=b.read_shift(1),b.l++,D.e.r=b.read_shift(2),D):(D.s.c=b.read_shift(2),D.s.r=b.read_shift(2),j==12&&P.qpro&&(b.l+=2),D.e.c=b.read_shift(2),D.e.r=b.read_shift(2),j==12&&P.qpro&&(b.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function c(b){var j=qe(8);return j.write_shift(2,b.s.c),j.write_shift(2,b.s.r),j.write_shift(2,b.e.c),j.write_shift(2,b.e.r),j}function l(b,j,P){var D=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(D[0].c=b.read_shift(1),D[3]=b.read_shift(1),D[0].r=b.read_shift(2),b.l+=2):(D[2]=b.read_shift(1),D[0].c=b.read_shift(2),D[0].r=b.read_shift(2)),D}function u(b,j,P){var D=b.l+j,q=l(b,j,P);if(q[1].t="s",P.vers==20768){b.l++;var ee=b.read_shift(1);return q[1].v=b.read_shift(ee,"utf8"),q}return P.qpro&&b.l++,q[1].v=b.read_shift(D-b.l,"cstr"),q}function f(b,j,P){var D=qe(7+P.length);D.write_shift(1,255),D.write_shift(2,j),D.write_shift(2,b),D.write_shift(1,39);for(var q=0;q<D.length;++q){var ee=P.charCodeAt(q);D.write_shift(1,ee>=128?95:ee)}return D.write_shift(1,0),D}function h(b,j,P){var D=l(b,j,P);return D[1].v=b.read_shift(2,"i"),D}function d(b,j,P){var D=qe(7);return D.write_shift(1,255),D.write_shift(2,j),D.write_shift(2,b),D.write_shift(2,P,"i"),D}function x(b,j,P){var D=l(b,j,P);return D[1].v=b.read_shift(8,"f"),D}function p(b,j,P){var D=qe(13);return D.write_shift(1,255),D.write_shift(2,j),D.write_shift(2,b),D.write_shift(8,P,"f"),D}function g(b,j,P){var D=b.l+j,q=l(b,j,P);if(q[1].v=b.read_shift(8,"f"),P.qpro)b.l=D;else{var ee=b.read_shift(2);O(b.slice(b.l,b.l+ee),q),b.l+=ee}return q}function _(b,j,P){var D=j&32768;return j&=-32769,j=(D?b:0)+(j>=8192?j-16384:j),(D?"":"$")+(P?ze(j):tr(j))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(b,j){er(b,0);for(var P=[],D=0,q="",ee="",ne="",Z="";b.l<b.length;){var Y=b[b.l++];switch(Y){case 0:P.push(b.read_shift(8,"f"));break;case 1:ee=_(j[0].c,b.read_shift(2),!0),q=_(j[0].r,b.read_shift(2),!1),P.push(ee+q);break;case 2:{var Te=_(j[0].c,b.read_shift(2),!0),C=_(j[0].r,b.read_shift(2),!1);ee=_(j[0].c,b.read_shift(2),!0),q=_(j[0].r,b.read_shift(2),!1),P.push(Te+C+":"+ee+q)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(b.read_shift(2));break;case 6:{for(var Be="";Y=b[b.l++];)Be+=String.fromCharCode(Y);P.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Z=P.pop(),ne=P.pop(),P.push(["AND","OR"][Y-20]+"("+ne+","+Z+")");break;default:if(Y<32&&v[Y])Z=P.pop(),ne=P.pop(),P.push(ne+v[Y]+Z);else if(E[Y]){if(D=E[Y][1],D==69&&(D=b[b.l++]),D>P.length){console.error("WK1 bad formula parse 0x"+Y.toString(16)+":|"+P.join("|")+"|");return}var Ae=P.slice(-D);P.length-=D,P.push(E[Y][0]+"("+Ae.join(",")+")")}else return Y<=7?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=24?console.error("WK1 unsupported op "+Y.toString(16)):Y<=30?console.error("WK1 invalid opcode "+Y.toString(16)):Y<=115?console.error("WK1 unsupported function opcode "+Y.toString(16)):console.error("WK1 unrecognized opcode "+Y.toString(16))}}P.length==1?j[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function F(b){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=b.read_shift(2),j[3]=b[b.l++],j[0].c=b[b.l++],j}function R(b,j){var P=F(b);return P[1].t="s",P[1].v=b.read_shift(j-4,"cstr"),P}function k(b,j,P,D){var q=qe(6+D.length);q.write_shift(2,b),q.write_shift(1,P),q.write_shift(1,j),q.write_shift(1,39);for(var ee=0;ee<D.length;++ee){var ne=D.charCodeAt(ee);q.write_shift(1,ne>=128?95:ne)}return q.write_shift(1,0),q}function L(b,j){var P=F(b);P[1].v=b.read_shift(2);var D=P[1].v>>1;if(P[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return P[1].v=D,P}function I(b,j){var P=F(b),D=b.read_shift(4),q=b.read_shift(4),ee=b.read_shift(2);if(ee==65535)return D===0&&q===3221225472?(P[1].t="e",P[1].v=15):D===0&&q===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var ne=ee&32768;return ee=(ee&32767)-16446,P[1].v=(1-ne*2)*(q*Math.pow(2,ee+32)+D*Math.pow(2,ee)),P}function G(b,j,P,D){var q=qe(14);if(q.write_shift(2,b),q.write_shift(1,P),q.write_shift(1,j),D==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var ee=0,ne=0,Z=0,Y=0;return D<0&&(ee=1,D=-D),ne=Math.log2(D)|0,D/=Math.pow(2,ne-31),Y=D>>>0,Y&2147483648||(D/=2,++ne,Y=D>>>0),D-=Y,Y|=2147483648,Y>>>=0,D*=Math.pow(2,32),Z=D>>>0,q.write_shift(4,Z),q.write_shift(4,Y),ne+=16383+(ee?32768:0),q.write_shift(2,ne),q}function W(b,j){var P=I(b);return b.l+=j-14,P}function N(b,j){var P=F(b),D=b.read_shift(4);return P[1].v=D>>6,P}function X(b,j){var P=F(b),D=b.read_shift(8,"f");return P[1].v=D,P}function ce(b,j){var P=X(b);return b.l+=j-10,P}function re(b,j){return b[b.l+j-1]==0?b.read_shift(j,"cstr"):""}function oe(b,j){var P=b[b.l++];P>j-1&&(P=j-1);for(var D="";D.length<P;)D+=String.fromCharCode(b[b.l++]);return D}function ie(b,j,P){if(!(!P.qpro||j<21)){var D=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var q=b.read_shift(j-21,"cstr");return[D,q]}}function Re(b,j){for(var P={},D=b.l+j;b.l<D;){var q=b.read_shift(2);if(q==14e3){for(P[q]=[0,""],P[q][0]=b.read_shift(2);b[b.l];)P[q][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return P}function V(b,j){var P=qe(5+b.length);P.write_shift(2,14e3),P.write_shift(2,j);for(var D=0;D<b.length;++D){var q=b.charCodeAt(D);P[P.l++]=q>127?95:q}return P[P.l++]=0,P}var de={0:{n:"BOF",f:We},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:I},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:r}}();function qp(e){var r={},t=e.match(fr),a=0,n=!1;if(t)for(;a!=t.length;++a){var s=he(t[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;r.cp=js[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return r}var zp=function(){var e=Wa("t"),r=Wa("rPr");function t(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ke(i[1])},c=s.match(r);return c&&(o.s=qp(c[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(n).map(t).filter(function(o){return o.v})}}(),Xp=function(){var r=/(\r\n|\n)/g;function t(n,s,i){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),n.b&&(s.push("<b>"),i.push("</b>")),n.i&&(s.push("<i>"),i.push("</i>")),n.strike&&(s.push("<s>"),i.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&t(n.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),Yp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Jp=/<(?:\w+:)?r>/,Zp=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ni(e,r){var t=r?r.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ke(Oe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Oe(e),t&&(a.h=zs(a.t))):e.match(Jp)&&(a.r=Oe(e),a.t=ke(Oe((e.replace(Zp,"").match(Yp)||[]).join("").replace(fr,""))),t&&(a.h=Xp(zp(a.r)))),a):{t:""}}var Qp=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ex=/<(?:\w+:)?(?:si|sstItem)>/g,rx=/<\/(?:\w+:)?(?:si|sstItem)>/;function tx(e,r){var t=[],a="";if(!e)return t;var n=e.match(Qp);if(n){a=n[2].replace(ex,"").split(rx);for(var s=0;s!=a.length;++s){var i=ni(a[s].trim(),r);i!=null&&(t[t.length]=i)}n=he(n[1]),t.Count=n.count,t.Unique=n.uniqueCount}return t}function ax(e){return[e.read_shift(4),e.read_shift(4)]}function nx(e,r){var t=[],a=!1;return st(e,function(s,i,o){switch(o){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}function A0(e){for(var r=[],t=e.split(""),a=0;a<t.length;++a)r[a]=t[a].charCodeAt(0);return r}function tt(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function sx(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=tt(e,4),r.U=tt(e,4),r.W=tt(e,4),r}function ix(e){for(var r=e.read_shift(4),t=e.l+r-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function ox(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(ix(e));return r}function cx(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function lx(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=tt(e,4),r.U=tt(e,4),r.W=tt(e,4),r}function ux(e){var r=lx(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function S0(e,r){var t=e.l+r,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function b0(e,r){var t={},a=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function fx(e){var r=tt(e);switch(r.Minor){case 2:return[r.Minor,hx(e)];case 3:return[r.Minor,dx()];case 4:return[r.Minor,px(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function hx(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),a=S0(e,t),n=b0(e,e.length-e.l);return{t:"Std",h:a,v:n}}function dx(){throw new Error("File is password-protected: ECMA-376 Extensible")}function px(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(fr,function(s){var i=he(s);switch(zr(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){a[o]=i[o]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function xx(e,r){var t={},a=t.EncryptionVersionInfo=tt(e,4);if(r-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),r-=4;var n=e.read_shift(4);return r-=4,t.EncryptionHeader=S0(e,n),r-=n,t.EncryptionVerifier=b0(e,r),t}function gx(e){var r={},t=r.EncryptionVersionInfo=tt(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function vx(e){var r=0,t,a=A0(e),n=a.length+1,s,i,o,c,l;for(t=xt(n),t[0]=a.length,s=1;s!=n;++s)t[s]=a[s-1];for(s=n-1;s>=0;--s)i=t[s],o=r&16384?1:0,c=r<<1&32767,l=o|c,r=l^i;return r^52811}var C0=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},n=function(i,o){return a(i^o)},s=function(i){for(var o=r[i.length-1],c=104,l=i.length-1;l>=0;--l)for(var u=i[l],f=0;f!=7;++f)u&64&&(o^=t[c]),u*=2,--c;return o};return function(i){for(var o=A0(i),c=s(o),l=o.length,u=xt(16),f=0;f!=16;++f)u[f]=0;var h,d,x;for((l&1)===1&&(h=c>>8,u[l]=n(e[0],h),--l,h=c&255,d=o[o.length-1],u[l]=n(d,h));l>0;)--l,h=c>>8,u[l]=n(o[l],h),--l,h=c&255,u[l]=n(o[l],h);for(l=15,x=15-o.length;x>0;)h=c>>8,u[l]=n(e[x],h),--l,--x,h=c&255,u[l]=n(o[l],h),--l,--x;return u}}(),mx=function(e,r,t,a,n){n||(n=r),a||(a=C0(e));var s,i;for(s=0;s!=r.length;++s)i=r[s],i^=a[t],i=(i>>5|i<<3)&255,n[s]=i,++t;return[n,t,a]},_x=function(e){var r=0,t=C0(e);return function(a){var n=mx("",a,r,t);return r=n[1],n[0]}};function wx(e,r,t,a){var n={key:We(e),verificationBytes:We(e)};return t.password&&(n.verifier=vx(t.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=_x(t.password)),n}function yx(e,r,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=gx(e):a.Data=xx(e,r),a}function Ex(e,r,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?yx(e,r-2,a):wx(e,t.biff>=8?r:r-2,t,a),a}var Tx=function(){function e(n,s){switch(s.type){case"base64":return r(kr(n),s);case"binary":return r(n,s);case"buffer":return r(we&&Buffer.isBuffer(n)?n.toString("binary"):Bt(n),s);case"array":return r(Pt(n),s)}throw new Error("Unrecognized type "+s.type)}function r(n,s){var i=s||{},o=i.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,d=0,x,p=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var g=u.slice(d,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var _={v:g,t:"s"};Array.isArray(o)?o[f][p]=_:o[xe({r:f,c:p})]=_}break}d=h.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ee(l),o}function t(n,s){return vt(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],i=Le(n["!ref"]),o,c=Array.isArray(n),l=i.s.r;l<=i.e.r;++l){s.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var f=xe({r:l,c:u});o=c?(n[l]||[])[u]:n[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(at(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:a}}();function kx(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Ka(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function Ax(e){var r=e[0]/255,t=e[1]/255,a=e[2]/255,n=Math.max(r,t,a),s=Math.min(r,t,a),i=n-s;if(i===0)return[0,0,r];var o=0,c=0,l=n+s;switch(c=i/(l>1?2-l:l),n){case r:o=((t-a)/i+6)%6;break;case t:o=(a-r)/i+2;break;case a:o=(r-t)/i+4;break}return[o/6,c,l/2]}function Sx(e){var r=e[0],t=e[1],a=e[2],n=t*2*(a<.5?a:1-a),s=a-n/2,i=[s,s,s],o=6*r,c;if(t!==0)switch(o|0){case 0:case 6:c=n*o,i[0]+=n,i[1]+=c;break;case 1:c=n*(2-o),i[0]+=c,i[1]+=n;break;case 2:c=n*(o-2),i[1]+=n,i[2]+=c;break;case 3:c=n*(4-o),i[1]+=c,i[2]+=n;break;case 4:c=n*(o-4),i[2]+=n,i[0]+=c;break;case 5:c=n*(6-o),i[2]+=c,i[0]+=n;break}for(var l=0;l!=3;++l)i[l]=Math.round(i[l]*255);return i}function Ln(e,r){if(r===0)return e;var t=Ax(kx(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Ka(Sx(t))}var O0=6,bx=15,Cx=1,pr=O0;function Bn(e){return Math.floor((e+Math.round(128/pr)/256)*pr)}function Mn(e){return Math.floor((e-5)/pr*100+.5)/100}function Fs(e){return Math.round((e*pr+5)/pr*256)/256}function cs(e){return Fs(Mn(Bn(e)))}function si(e){var r=Math.abs(e-cs(e)),t=pr;if(r>.005)for(pr=Cx;pr<bx;++pr)Math.abs(e-cs(e))<=r&&(r=Math.abs(e-cs(e)),t=pr);pr=t}function ia(e){e.width?(e.wpx=Bn(e.width),e.wch=Mn(e.wpx),e.MDW=pr):e.wpx?(e.wch=Mn(e.wpx),e.width=Fs(e.wch),e.MDW=pr):typeof e.wch=="number"&&(e.width=Fs(e.wch),e.wpx=Bn(e.width),e.MDW=pr),e.customWidth&&delete e.customWidth}var Ox=96,R0=Ox;function F0(e){return e*96/R0}function qa(e){return e*R0/96}var Rx={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Fx(e,r,t,a){r.Borders=[];var n={},s=!1;(e[0].match(fr)||[]).forEach(function(i){var o=he(i);switch(zr(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=Fe(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=Fe(o.diagonalDown)),r.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function Ix(e,r,t,a){r.Fills=[];var n={},s=!1;(e[0].match(fr)||[]).forEach(function(i){var o=he(i);switch(zr(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},r.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function Dx(e,r,t,a){r.Fonts=[];var n={},s=!1;(e[0].match(fr)||[]).forEach(function(i){var o=he(i);switch(zr(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Oe(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?Fe(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?Fe(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?Fe(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?Fe(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?Fe(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?Fe(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?Fe(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=js[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=Fe(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=Rt[n.color.index];n.color.index==81&&(c=Rt[1]),c||(c=Rt[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&t.themeElements&&t.themeElements.clrScheme&&(n.color.rgb=Ln(t.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Px(e,r,t){r.NumberFmt=[];for(var a=qr(ve),n=0;n<a.length;++n)r.NumberFmt[a[n]]=ve[a[n]];var s=e[0].match(fr);if(s)for(n=0;n<s.length;++n){var i=he(s[n]);switch(zr(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ke(Oe(i.formatCode)),c=parseInt(i.numFmtId,10);if(r.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&r.NumberFmt[c]!=null;--c);r.NumberFmt[c]=o}Ot(o,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var wn=["numFmtId","fillId","fontId","borderId","xfId"],yn=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Nx(e,r,t){r.CellXf=[];var a,n=!1;(e[0].match(fr)||[]).forEach(function(s){var i=he(s),o=0;switch(zr(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],o=0;o<wn.length;++o)a[wn[o]]&&(a[wn[o]]=parseInt(a[wn[o]],10));for(o=0;o<yn.length;++o)a[yn[o]]&&(a[yn[o]]=Fe(a[yn[o]]));if(r.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[a.numFmtId]==r.NumberFmt[o]){a.numFmtId=o;break}}r.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Fe(i.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(t&&t.WTF&&!n)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var Lx=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(r))&&Px(f,u,l),(f=o.match(n))&&Dx(f,u,c,l),(f=o.match(a))&&Ix(f,u,c,l),(f=o.match(s))&&Fx(f,u,c,l),(f=o.match(t))&&Nx(f,u,l),u}}();function Bx(e,r){var t=e.read_shift(2),a=cr(e);return[t,a]}function Mx(e,r,t){var a={};a.sz=e.read_shift(2)/20;var n=zd(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var o=e.read_shift(1);o>0&&(a.family=o);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=qd(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=cr(e),a}var Ux=lr;function $x(e,r){var t=e.l+r,a=e.read_shift(2),n=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:n}}var jx=lr;function Hx(e,r,t){var a={};a.NumberFmt=[];for(var n in ve)a.NumberFmt[n]=ve[n];a.CellXf=[],a.Fonts=[];var s=[],i=!1;return st(e,function(c,l,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Ot(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(c.color.rgb=Ln(r.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(u),i=!0;break;case 38:s.pop(),i=!1;break;default:if(l.T>0)s.push(u);else if(l.T<0)s.pop();else if(!i||t.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}var Wx=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Vx(e,r,t){r.themeElements.clrScheme=[];var a={};(e[0].match(fr)||[]).forEach(function(n){var s=he(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(r.themeElements.clrScheme[Wx.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Gx(){}function Kx(){}var qx=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zx=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xx=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Yx(e,r,t){r.themeElements={};var a;[["clrScheme",qx,Vx],["fontScheme",zx,Gx],["fmtScheme",Xx,Kx]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,r,t)})}var Jx=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function I0(e,r){(!e||e.length===0)&&(e=Zx());var t,a={};if(!(t=e.match(Jx)))throw new Error("themeElements not found in theme");return Yx(t[0],a,r),a.raw=e,a}function Zx(e,r){var t=[Wc];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function Qx(e,r,t){var a=e.l+r,n=e.read_shift(4);if(n!==124226){if(!t.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var i;try{i=Hc(s,{type:"array"})}catch{return}var o=Tr(i,"theme/theme/theme1.xml",!0);if(o)return I0(o,t)}}function eg(e){return e.read_shift(4)}function rg(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=tg(e,4);break;case 2:r.xclrValue=m0(e);break;case 3:r.xclrValue=eg(e);break;case 4:e.l+=4;break}return e.l+=8,r}function tg(e,r){return lr(e,r)}function ag(e,r){return lr(e,r)}function ng(e){var r=e.read_shift(2),t=e.read_shift(2)-4,a=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=rg(e);break;case 6:a[1]=ag(e,t);break;case 14:case 15:a[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return a}function sg(e,r){var t=e.l+r;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(ng(e,t-e.l));return{ixfe:a,ext:s}}function ig(e,r){r.forEach(function(t){switch(t[0]){}})}function og(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:cr(e)}}function cg(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function lg(e){return e.l+=4,e.read_shift(4)!=0}function ug(e,r,t){var a={Types:[],Cell:[],Value:[]},n=t||{},s=[],i=!1,o=2;return st(e,function(c,l,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):o==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(u),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!l.T){if(!i||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function fg(e,r,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,i;return e.replace(fr,function(o){var c=he(o);switch(zr(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==c.name&&(i=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):s==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),a}function hg(e){var r=[];if(!e)return r;var t=1;return(e.match(fr)||[]).forEach(function(a){var n=he(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?t=n.i:n.i=t,r.push(n);break}}),r}function dg(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=xe(t);var a=e.read_shift(1);return a&2&&(r.l="1"),a&8&&(r.a="1"),r}function pg(e,r,t){var a=[];return st(e,function(s,i,o){switch(o){case 63:a.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function xg(e,r,t,a){if(!e)return e;var n=a||{},s=!1;st(e,function(o,c,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function gg(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Fo(e,r,t,a){var n=Array.isArray(e),s;r.forEach(function(i){var o=xr(i.ref);if(n?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},n?e[o.r][o.c]=s:e[i.ref]=s;var c=Le(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ee(c);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var u={a:i.author,t:i.t,r:i.r,T:t};i.h&&(u.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!t&&s.c[f].T)return;t&&!s.c[f].T&&s.c.splice(f,1)}if(t&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}s.c.push(u)})}function vg(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&t.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=he(o[0]),l={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=xr(c.ref);if(!(r.sheetRows&&r.sheetRows<=u.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&ni(f[1])||{r:"",t:"",h:""};l.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),l.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(l.h=h.h),a.push(l)}}}}),a}function mg(e,r){var t=[],a=!1,n={},s=0;return e.replace(fr,function(o,c){var l=he(o);switch(zr(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&t.push(n);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":n.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),t}function _g(e,r){var t=[],a=!1;return e.replace(fr,function(s){var i=he(s);switch(zr(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&r.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),t}function wg(e){var r={};r.iauthor=e.read_shift(4);var t=Ut(e);return r.rfx=t.s,r.ref=xe(t.s),e.l+=16,r}var yg=cr;function Eg(e,r){var t=[],a=[],n={},s=!1;return st(e,function(o,c,l){switch(l){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,r.sheetRows&&n.rfx&&r.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,t.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),t}var Tg="application/vnd.ms-office.vbaProject";function kg(e){var r=ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var n=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ye.utils.cfb_add(r,n,e.FileIndex[a].content)}}),ye.write(r)}function Ag(){return{"!type":"dialog"}}function Sg(){return{"!type":"dialog"}}function bg(){return{"!type":"macro"}}function Cg(){return{"!type":"macro"}}var aa=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(a,n,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=r.c:--u,c?l+=r.r:--l,n+(o?"":"$")+ze(u)+(c?"":"$")+tr(l)}return function(n,s){return r=s,n.replace(e,t)}}(),D0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Og=function(){return function(r,t){return r.replace(D0,function(a,n,s,i,o,c){var l=Zs(i)-(s?0:t.c),u=Js(c)-(o?0:t.r),f=u==0?"":o?u+1:"["+u+"]",h=l==0?"":s?l+1:"["+l+"]";return n+"R"+f+"C"+h})}}();function P0(e,r){return e.replace(D0,function(t,a,n,s,i,o){return a+(n=="$"?n+s:ze(Zs(s)+r.c))+(i=="$"?i+o:tr(Js(o)+r.r))})}function Rg(e,r,t){var a=la(r),n=a.s,s=xr(t),i={r:s.r-n.r,c:s.c-n.c};return P0(e,i)}function Fg(e){return e.length!=1}function Io(e){return e.replace(/_xlfn\./g,"")}function je(e){e.l+=1}function gt(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function N0(e,r,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return L0(e);t.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),i=gt(e),o=gt(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function L0(e){var r=gt(e),t=gt(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:r[0],c:a,cRel:r[1],rRel:r[2]},e:{r:t[0],c:n,cRel:t[1],rRel:t[2]}}}function Ig(e,r,t){if(t.biff<8)return L0(e);var a=e.read_shift(t.biff==12?4:2),n=e.read_shift(t.biff==12?4:2),s=gt(e),i=gt(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:i[0],cRel:i[1],rRel:i[2]}}}function B0(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return Dg(e);var a=e.read_shift(t&&t.biff==12?4:2),n=gt(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Dg(e){var r=gt(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Pg(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function Ng(e,r,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return Lg(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;n>524287;)n-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:i,rRel:o}}function Lg(e){var r=e.read_shift(2),t=e.read_shift(1),a=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,a==1&&r>=8192&&(r=r-16384),n==1&&t>=128&&(t=t-256),{r,c:t,cRel:n,rRel:a}}function Bg(e,r,t){var a=(e[e.l++]&96)>>5,n=N0(e,t.biff>=2&&t.biff<=5?6:8,t);return[a,n]}function Mg(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=N0(e,s,t);return[a,n,i]}function Ug(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function $g(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function jg(e,r,t){var a=(e[e.l++]&96)>>5,n=Ig(e,r-1,t);return[a,n]}function Hg(e,r,t){var a=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[a]}function Do(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function Wg(e,r,t){e.l+=2;for(var a=e.read_shift(t&&t.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(t&&t.biff==2?1:2));return n}function Vg(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Gg(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(t&&t.biff==2?1:2)]}function Kg(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function qg(e,r,t){var a=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[a]}function M0(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function zg(e){return e.read_shift(2),M0(e)}function Xg(e){return e.read_shift(2),M0(e)}function Yg(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=B0(e,0,t);return[a,n]}function Jg(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=Ng(e,0,t);return[a,n]}function Zg(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var s=B0(e,0,t);return[a,n,s]}function Qg(e,r,t){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(t&&t.biff<=3?1:2);return[em[n],j0[n],a]}function ev(e,r,t){var a=e[e.l++],n=e.read_shift(1),s=t&&t.biff<=3?[a==88?-1:0,e.read_shift(1)]:rv(e);return[n,(s[0]===0?j0:Qv)[s[1]]]}function rv(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function tv(e,r,t){e.l+=t&&t.biff==2?3:4}function av(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function nv(e){return e.l++,$t[e.read_shift(1)]}function sv(e){return e.l++,e.read_shift(2)}function iv(e){return e.l++,e.read_shift(1)!==0}function ov(e){return e.l++,ir(e)}function cv(e,r,t){return e.l++,Qa(e,r-1,t)}function lv(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=$e(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=$t[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ir(e);break;case 2:t[1]=jt(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function uv(e,r,t){for(var a=e.read_shift(t.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((t.biff==12?Ut:Kn)(e));return n}function fv(e,r,t){var a=0,n=0;t.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--n==0&&(n=256));for(var s=0,i=[];s!=a&&(i[s]=[]);++s)for(var o=0;o!=n;++o)i[s][o]=lv(e,t.biff);return i}function hv(e,r,t){var a=e.read_shift(1)>>>5&3,n=!t||t.biff>=8?4:2,s=e.read_shift(n);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function dv(e,r,t){if(t.biff==5)return pv(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function pv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[r,t,a]}function xv(e,r,t){var a=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function gv(e,r,t){var a=e.read_shift(1)>>>5&3,n=e.read_shift(t&&t.biff==2?1:2);return[a,n]}function vv(e,r,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[a]}function mv(e,r,t){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var _v=lr,wv=lr,yv=lr;function rn(e,r,t){return e.l+=2,[Pg(e)]}function ii(e){return e.l+=6,[]}var Ev=rn,Tv=ii,kv=ii,Av=rn;function U0(e){return e.l+=2,[We(e),e.read_shift(2)&1]}var Sv=rn,bv=U0,Cv=ii,Ov=rn,Rv=rn,Fv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Iv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),i=Fv[t>>2&31];return{ixti:r,coltype:t&3,rt:i,idx:a,c:n,C:s}}function Dv(e){return e.l+=2,[e.read_shift(4)]}function Pv(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function Nv(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function Lv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Bv(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function Mv(e){return e.l+=4,[0,0]}var Po={1:{n:"PtgExp",f:av},2:{n:"PtgTbl",f:yv},3:{n:"PtgAdd",f:je},4:{n:"PtgSub",f:je},5:{n:"PtgMul",f:je},6:{n:"PtgDiv",f:je},7:{n:"PtgPower",f:je},8:{n:"PtgConcat",f:je},9:{n:"PtgLt",f:je},10:{n:"PtgLe",f:je},11:{n:"PtgEq",f:je},12:{n:"PtgGe",f:je},13:{n:"PtgGt",f:je},14:{n:"PtgNe",f:je},15:{n:"PtgIsect",f:je},16:{n:"PtgUnion",f:je},17:{n:"PtgRange",f:je},18:{n:"PtgUplus",f:je},19:{n:"PtgUminus",f:je},20:{n:"PtgPercent",f:je},21:{n:"PtgParen",f:je},22:{n:"PtgMissArg",f:je},23:{n:"PtgStr",f:cv},26:{n:"PtgSheet",f:Pv},27:{n:"PtgEndSheet",f:Nv},28:{n:"PtgErr",f:nv},29:{n:"PtgBool",f:iv},30:{n:"PtgInt",f:sv},31:{n:"PtgNum",f:ov},32:{n:"PtgArray",f:Hg},33:{n:"PtgFunc",f:Qg},34:{n:"PtgFuncVar",f:ev},35:{n:"PtgName",f:hv},36:{n:"PtgRef",f:Yg},37:{n:"PtgArea",f:Bg},38:{n:"PtgMemArea",f:xv},39:{n:"PtgMemErr",f:_v},40:{n:"PtgMemNoMem",f:wv},41:{n:"PtgMemFunc",f:gv},42:{n:"PtgRefErr",f:vv},43:{n:"PtgAreaErr",f:Ug},44:{n:"PtgRefN",f:Jg},45:{n:"PtgAreaN",f:jg},46:{n:"PtgMemAreaN",f:Lv},47:{n:"PtgMemNoMemN",f:Bv},57:{n:"PtgNameX",f:dv},58:{n:"PtgRef3d",f:Zg},59:{n:"PtgArea3d",f:Mg},60:{n:"PtgRefErr3d",f:mv},61:{n:"PtgAreaErr3d",f:$g},255:{}},Uv={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$v={1:{n:"PtgElfLel",f:U0},2:{n:"PtgElfRw",f:Ov},3:{n:"PtgElfCol",f:Ev},6:{n:"PtgElfRwV",f:Rv},7:{n:"PtgElfColV",f:Av},10:{n:"PtgElfRadical",f:Sv},11:{n:"PtgElfRadicalS",f:Cv},13:{n:"PtgElfColS",f:Tv},15:{n:"PtgElfColSV",f:kv},16:{n:"PtgElfRadicalLel",f:bv},25:{n:"PtgList",f:Iv},29:{n:"PtgSxName",f:Dv},255:{}},jv={0:{n:"PtgAttrNoop",f:Mv},1:{n:"PtgAttrSemi",f:qg},2:{n:"PtgAttrIf",f:Gg},4:{n:"PtgAttrChoose",f:Wg},8:{n:"PtgAttrGoto",f:Vg},16:{n:"PtgAttrSum",f:tv},32:{n:"PtgAttrBaxcel",f:Do},33:{n:"PtgAttrBaxcel",f:Do},64:{n:"PtgAttrSpace",f:zg},65:{n:"PtgAttrSpaceSemi",f:Xg},128:{n:"PtgAttrIfError",f:Kg},255:{}};function tn(e,r,t,a){if(a.biff<8)return lr(e,r);for(var n=e.l+r,s=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=fv(e,0,a),s.push(t[i][1]);break;case"PtgMemArea":t[i][2]=uv(e,t[i][1],a),s.push(t[i][2]);break;case"PtgExp":a&&a.biff==12&&(t[i][1][1]=e.read_shift(4),s.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return r=n-e.l,r!==0&&s.push(lr(e,r)),s}function an(e,r,t){for(var a=e.l+r,n,s,i=[];a!=e.l;)r=a-e.l,s=e[e.l],n=Po[s]||Po[Uv[s]],(s===24||s===25)&&(n=(s===24?$v:jv)[e[e.l+1]]),!n||!n.f?lr(e,r):i.push([n.n,n.f(e,r,t)]);return i}function Hv(e){for(var r=[],t=0;t<e.length;++t){for(var a=e[t],n=[],s=0;s<a.length;++s){var i=a[s];if(i)switch(i[0]){case 2:n.push('"'+i[1].replace(/"/g,'""')+'"');break;default:n.push(i[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var Wv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Vv(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $0(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!a)return"SH33TJSERR1";var n="";if(t.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function No(e,r,t){var a=$0(e,r,t);return a=="#REF"?a:Vv(a,t)}function sr(e,r,t,a,n){var s=n&&n.biff||8,i={s:{c:0,r:0}},o=[],c,l,u,f=0,h=0,d,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",_=0,E=e[0].length;_<E;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Ne(" ",e[0][p][1][1]);break;case 1:g=Ne("\r",e[0][p][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+g,p=-1}o.push(l+Wv[v[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Sa(v[1][1],i,n),o.push(ba(u,s));break;case"PtgRefN":u=t?Sa(v[1][1],t,n):v[1][1],o.push(ba(u,s));break;case"PtgRef3d":f=v[1][1],u=Sa(v[1][2],i,n),x=No(a,f,n),o.push(x+"!"+ba(u,s));break;case"PtgFunc":case"PtgFuncVar":var O=v[1][0],F=v[1][1];O||(O=0),O&=127;var R=O==0?[]:o.slice(-O);o.length-=O,F==="User"&&(F=R.shift()),o.push(F+"("+R.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":d=xo(v[1][1],t?{s:t}:i,n),o.push(is(d,n));break;case"PtgArea":d=xo(v[1][1],i,n),o.push(is(d,n));break;case"PtgArea3d":f=v[1][1],d=v[1][2],x=No(a,f,n),o.push(x+"!"+is(d,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var k=(a.names||[])[h-1]||(a[0]||[])[h],L=k?k.Name:"SH33TJSNAME"+String(h);L&&L.slice(0,6)=="_xlfn."&&!n.xlfn&&(L=L.slice(6)),o.push(L);break;case"PtgNameX":var I=v[1][1];h=v[1][2];var G;if(n.biff<=5)I<0&&(I=-I),a[I]&&(G=a[I][h]);else{var W="";if(((a[I]||[])[0]||[])[0]==14849||(((a[I]||[])[0]||[])[0]==1025?a[I][h]&&a[I][h].itab>0&&(W=a.SheetNames[a[I][h].itab-1]+"!"):W=a.SheetNames[h-1]+"!"),a[I]&&a[I][h])W+=a[I][h].Name;else if(a[0]&&a[0][h])W+=a[0][h].Name;else{var N=($0(a,I,n)||"").split(";;");N[h-1]?W=N[h-1]:W+="SH33TJSERRX"}o.push(W);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var X="(",ce=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:X=Ne(" ",e[0][p][1][1])+X;break;case 3:X=Ne("\r",e[0][p][1][1])+X;break;case 4:ce=Ne(" ",e[0][p][1][1])+ce;break;case 5:ce=Ne("\r",e[0][p][1][1])+ce;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(X+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var re={c:t.c,r:t.r};if(a.sharedf[xe(u)]){var oe=a.sharedf[xe(u)];o.push(sr(oe,i,re,a,n))}else{var ie=!1;for(c=0;c!=a.arrayf.length;++c)if(l=a.arrayf[c],!(u.c<l[0].s.c||u.c>l[0].e.c)&&!(u.r<l[0].s.r||u.r>l[0].e.r)){o.push(sr(l[1],i,re,a,n)),ie=!0;break}ie||o.push(v[1])}break;case"PtgArray":o.push("{"+Hv(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var Re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Re.indexOf(e[0][_][0])==-1){v=e[0][p];var V=!0;switch(v[1][0]){case 4:V=!1;case 0:g=Ne(" ",v[1][1]);break;case 5:V=!1;case 1:g=Ne("\r",v[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((V?g:"")+o.pop()+(V?"":g)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function Gv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],lr(e,r-2)];var o=an(e,i,t);return r!==i+n&&(s=tn(e,r-i-n,o,t)),e.l=a,[o,s]}function Kv(e,r,t){var a=e.l+r,n=t.biff==2?1:2,s,i=e.read_shift(n);if(i==65535)return[[],lr(e,r-2)];var o=an(e,i,t);return r!==i+n&&(s=tn(e,r-i-n,o,t)),e.l=a,[o,s]}function qv(e,r,t,a){var n=e.l+r,s=an(e,a,t),i;return n!==e.l&&(i=tn(e,n-e.l,s,t)),[s,i]}function zv(e,r,t){var a=e.l+r,n,s=e.read_shift(2),i=an(e,s,t);return s==65535?[[],lr(e,r-2)]:(r!==s+2&&(n=tn(e,a-s-2,i,t)),[i,n])}function Xv(e){var r;if(et(e,e.l+6)!==65535)return[ir(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function ls(e,r,t){var a=e.l+r,n=Xr(e);t.biff==2&&++e.l;var s=Xv(e),i=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=Kv(e,a-e.l,t);return{cell:n,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function qn(e,r,t){var a=e.read_shift(4),n=an(e,a,t),s=e.read_shift(4),i=s>0?tn(e,s,n,t):null;return[n,i]}var Yv=qn,zn=qn,Jv=qn,Zv=qn,Qv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j0={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},em={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Lo(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function us(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Fa={},na={};function Ia(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function H0(e,r,t,a,n,s){try{a.cellNF&&(e.z=ve[r])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Je(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ve[r]==null&&Ot(rd[r]||"General",r),e.t==="e")e.w=e.w||$t[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v);else if(e.t==="d"){var i=vr(e.v);(i|0)===i?e.w=i.toString(10):e.w=Ha(i)}else{if(e.v===void 0)return"";e.w=Dt(e.v,na)}else e.t==="d"?e.w=Rr(r,vr(e.v),na):e.w=Rr(r,e.v,na)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&t!=null)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ln(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ln(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&s.Fills)throw o}}}function rm(e,r){var t=Le(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Ee(t))}var tm=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,am=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,nm=/<(?:\w:)?hyperlink [^>]*>/mg,sm=/"(\w*:\w*)"/,im=/<(?:\w:)?col\b[^>]*[\/]?>/g,om=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,cm=/<(?:\w:)?pageMargins[^>]*\/>/g,W0=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lm=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,um=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function fm(e,r,t,a,n,s,i){if(!e)return e;a||(a={"!id":{}});var o=r.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",u="",f=e.match(am);f?(l=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):l=u=e;var h=l.match(W0);h?oi(h[0],o,n,t):(h=l.match(lm))&&hm(h[0],h[1]||"",o,n,t);var d=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var x=l.slice(d,d+50).match(sm);x&&rm(o,x[1])}var p=l.match(um);p&&p[1]&&mm(p[1],n);var g=[];if(r.cellStyles){var _=l.match(im);_&&xm(g,_)}f&&_m(f[1],o,r,c,s,i);var E=u.match(om);E&&(o["!autofilter"]=gm(E[0]));var v=[],O=u.match(tm);if(O)for(d=0;d!=O.length;++d)v[d]=Le(O[d].slice(O[d].indexOf('"')+1));var F=u.match(nm);F&&dm(o,F,a);var R=u.match(cm);if(R&&(o["!margins"]=pm(he(R[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ee(c)),r.sheetRows>0&&o["!ref"]){var k=Le(o["!ref"]);r.sheetRows<=+k.e.r&&(k.e.r=r.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ee(k))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function oi(e,r,t,a){var n=he(e);t.Sheets[a]||(t.Sheets[a]={}),n.codeName&&(t.Sheets[a].CodeName=ke(Oe(n.codeName)))}function hm(e,r,t,a,n){oi(e.slice(0,e.indexOf(">")),t,a,n)}function dm(e,r,t){for(var a=Array.isArray(e),n=0;n!=r.length;++n){var s=he(Oe(r[n]),!0);if(!s.ref)return;var i=((t||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+ke(s.location))):(s.Target="#"+ke(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Le(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var u=xe({c:l,r:c});a?(e[c]||(e[c]=[]),e[c][l]||(e[c][l]={t:"z",v:void 0}),e[c][l].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function pm(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function xm(e,r){for(var t=!1,a=0;a!=r.length;++a){var n=he(r[a],!0);n.hidden&&(n.hidden=Fe(n.hidden));var s=parseInt(n.min,10)-1,i=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!t&&n.width&&(t=!0,si(n.width)),ia(n);s<=i;)e[s++]=rr(n)}}function gm(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var vm=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mm(e,r){r.Views||(r.Views=[{}]),(e.match(vm)||[]).forEach(function(t,a){var n=he(t);r.Views[a]||(r.Views[a]={}),+n.zoomScale&&(r.Views[a].zoom=+n.zoomScale),Fe(n.rightToLeft)&&(r.Views[a].RTL=!0)})}var _m=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=Wa("v"),i=Wa("f");return function(c,l,u,f,h,d){for(var x=0,p="",g=[],_=[],E=0,v=0,O=0,F="",R,k,L=0,I=0,G,W,N=0,X=0,ce=Array.isArray(d.CellXf),re,oe=[],ie=[],Re=Array.isArray(l),V=[],de={},pe=!1,b=!!u.sheetStubs,j=c.split(r),P=0,D=j.length;P!=D;++P){p=j[P].trim();var q=p.length;if(q!==0){var ee=0;e:for(x=0;x<q;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(k=he(p.slice(ee,x),!0),L=k.r!=null?parseInt(k.r,10):L+1,I=-1,u.sheetRows&&u.sheetRows<L)continue;de={},pe=!1,k.ht&&(pe=!0,de.hpt=parseFloat(k.ht),de.hpx=qa(de.hpt)),k.hidden=="1"&&(pe=!0,de.hidden=!0),k.outlineLevel!=null&&(pe=!0,de.level=+k.outlineLevel),pe&&(V[L-1]=de)}break;case"<":ee=x;break}if(ee>=x)break;if(k=he(p.slice(ee,x),!0),L=k.r!=null?parseInt(k.r,10):L+1,I=-1,!(u.sheetRows&&u.sheetRows<L)){f.s.r>L-1&&(f.s.r=L-1),f.e.r<L-1&&(f.e.r=L-1),u&&u.cellStyles&&(de={},pe=!1,k.ht&&(pe=!0,de.hpt=parseFloat(k.ht),de.hpx=qa(de.hpt)),k.hidden=="1"&&(pe=!0,de.hidden=!0),k.outlineLevel!=null&&(pe=!0,de.level=+k.outlineLevel),pe&&(V[L-1]=de)),g=p.slice(x).split(e);for(var ne=0;ne!=g.length&&g[ne].trim().charAt(0)=="<";++ne);for(g=g.slice(ne),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(_=p.match(t),E=x,v=0,O=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,_!=null&&_.length===2){for(E=0,F=_[1],v=0;v!=F.length&&!((O=F.charCodeAt(v)-64)<1||O>26);++v)E=26*E+O;--E,I=E}else++I;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,k=he(p.slice(0,v),!0),k.r||(k.r=xe({r:L-1,c:I})),F=p.slice(v),R={t:""},(_=F.match(s))!=null&&_[1]!==""&&(R.v=ke(_[1])),u.cellFormula){if((_=F.match(i))!=null&&_[1]!==""){if(R.f=ke(Oe(_[1])).replace(/\r\n/g,`
`),u.xlfn||(R.f=Io(R.f)),_[0].indexOf('t="array"')>-1)R.F=(F.match(n)||[])[1],R.F.indexOf(":")>-1&&oe.push([Le(R.F),R.F]);else if(_[0].indexOf('t="shared"')>-1){W=he(_[0]);var Z=ke(Oe(_[1]));u.xlfn||(Z=Io(Z)),ie[parseInt(W.si,10)]=[W,Z,k.r]}}else(_=F.match(/<f[^>]*\/>/))&&(W=he(_[0]),ie[W.si]&&(R.f=Rg(ie[W.si][1],ie[W.si][2],k.r)));var Y=xr(k.r);for(v=0;v<oe.length;++v)Y.r>=oe[v][0].s.r&&Y.r<=oe[v][0].e.r&&Y.c>=oe[v][0].s.c&&Y.c<=oe[v][0].e.c&&(R.F=oe[v][1])}if(k.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(b)R.t="z";else continue;else R.t=k.t||"n";switch(f.s.c>I&&(f.s.c=I),f.e.c<I&&(f.e.c=I),R.t){case"n":if(R.v==""||R.v==null){if(!b)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!b)continue;R.t="z"}else G=Fa[parseInt(R.v,10)],R.v=G.t,R.r=G.r,u.cellHTML&&(R.h=G.h);break;case"str":R.t="s",R.v=R.v!=null?Oe(R.v):"",u.cellHTML&&(R.h=zs(R.v));break;case"inlineStr":_=F.match(a),R.t="s",_!=null&&(G=ni(_[1]))?(R.v=G.t,u.cellHTML&&(R.h=G.h)):R.v="";break;case"b":R.v=Fe(R.v);break;case"d":u.cellDates?R.v=Je(R.v,1):(R.v=vr(Je(R.v,1)),R.t="n");break;case"e":(!u||u.cellText!==!1)&&(R.w=R.v),R.v=u0[R.v];break}if(N=X=0,re=null,ce&&k.s!==void 0&&(re=d.CellXf[k.s],re!=null&&(re.numFmtId!=null&&(N=re.numFmtId),u.cellStyles&&re.fillId!=null&&(X=re.fillId))),H0(R,N,X,u,h,d),u.cellDates&&ce&&R.t=="n"&&ca(ve[N])&&(R.t="d",R.v=Gn(R.v)),k.cm&&u.xlmeta){var Te=(u.xlmeta.Cell||[])[+k.cm-1];Te&&Te.type=="XLDAPR"&&(R.D=!0)}if(Re){var C=xr(k.r);l[C.r]||(l[C.r]=[]),l[C.r][C.c]=R}else l[k.r]=R}}}}V.length>0&&(l["!rows"]=V)}}();function wm(e,r){var t={},a=e.l+r;t.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(t.level=s&7),s&16&&(t.hidden=!0),s&32&&(t.hpt=n/20),t}var ym=Ut;function Em(){}function Tm(e,r){var t={},a=e[e.l];return++e.l,t.above=!(a&64),t.left=!(a&128),e.l+=18,t.name=Gd(e),t}function km(e){var r=Fr(e);return[r]}function Am(e){var r=Mt(e);return[r]}function Sm(e){var r=Fr(e),t=e.read_shift(1);return[r,t,"b"]}function bm(e){var r=Mt(e),t=e.read_shift(1);return[r,t,"b"]}function Cm(e){var r=Fr(e),t=e.read_shift(1);return[r,t,"e"]}function Om(e){var r=Mt(e),t=e.read_shift(1);return[r,t,"e"]}function Rm(e){var r=Fr(e),t=e.read_shift(4);return[r,t,"s"]}function Fm(e){var r=Mt(e),t=e.read_shift(4);return[r,t,"s"]}function Im(e){var r=Fr(e),t=ir(e);return[r,t,"n"]}function V0(e){var r=Mt(e),t=ir(e);return[r,t,"n"]}function Dm(e){var r=Fr(e),t=ri(e);return[r,t,"n"]}function Pm(e){var r=Mt(e),t=ri(e);return[r,t,"n"]}function Nm(e){var r=Fr(e),t=Qs(e);return[r,t,"is"]}function Lm(e){var r=Fr(e),t=cr(e);return[r,t,"str"]}function Bm(e){var r=Mt(e),t=cr(e);return[r,t,"str"]}function Mm(e,r,t){var a=e.l+r,n=Fr(e);n.r=t["!row"];var s=e.read_shift(1),i=[n,s,"b"];if(t.cellFormula){e.l+=2;var o=zn(e,a-e.l,t);i[3]=sr(o,null,n,t.supbooks,t)}else e.l=a;return i}function Um(e,r,t){var a=e.l+r,n=Fr(e);n.r=t["!row"];var s=e.read_shift(1),i=[n,s,"e"];if(t.cellFormula){e.l+=2;var o=zn(e,a-e.l,t);i[3]=sr(o,null,n,t.supbooks,t)}else e.l=a;return i}function $m(e,r,t){var a=e.l+r,n=Fr(e);n.r=t["!row"];var s=ir(e),i=[n,s,"n"];if(t.cellFormula){e.l+=2;var o=zn(e,a-e.l,t);i[3]=sr(o,null,n,t.supbooks,t)}else e.l=a;return i}function jm(e,r,t){var a=e.l+r,n=Fr(e);n.r=t["!row"];var s=cr(e),i=[n,s,"str"];if(t.cellFormula){e.l+=2;var o=zn(e,a-e.l,t);i[3]=sr(o,null,n,t.supbooks,t)}else e.l=a;return i}var Hm=Ut;function Wm(e,r){var t=e.l+r,a=Ut(e),n=ei(e),s=cr(e),i=cr(e),o=cr(e);e.l=t;var c={rfx:a,relId:n,loc:s,display:o};return i&&(c.Tooltip=i),c}function Vm(){}function Gm(e,r,t){var a=e.l+r,n=o0(e),s=e.read_shift(1),i=[n];if(i[2]=s,t.cellFormula){var o=Yv(e,a-e.l,t);i[1]=o}else e.l=a;return i}function Km(e,r,t){var a=e.l+r,n=Ut(e),s=[n];if(t.cellFormula){var i=Zv(e,a-e.l,t);s[1]=i,e.l=a}else e.l=a;return s}var qm=["left","right","top","bottom","header","footer"];function zm(e){var r={};return qm.forEach(function(t){r[t]=ir(e)}),r}function Xm(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function Ym(){}function Jm(){}function Zm(e,r,t,a,n,s,i){if(!e)return e;var o=r||{};a||(a={"!id":{}});var c=o.dense?[]:{},l,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,d,x,p,g,_,E,v,O,F,R=[];o.biff=12,o["!row"]=0;var k=0,L=!1,I=[],G={},W=o.supbooks||n.supbooks||[[]];if(W.sharedf=G,W.arrayf=I,W.SheetNames=n.SheetNames||n.Sheets.map(function(Re){return Re.name}),!o.supbooks&&(o.supbooks=W,n.Names))for(var N=0;N<n.Names.length;++N)W[0][N+1]=n.Names[N];var X=[],ce=[],re=!1;Un[16]={n:"BrtShortReal",f:V0};var oe;if(st(e,function(V,de,pe){if(!h)switch(pe){case 148:l=V;break;case 0:d=V,o.sheetRows&&o.sheetRows<=d.r&&(h=!0),O=tr(g=d.r),o["!row"]=d.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=qa(V.hpt)),ce[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:V[2]},V[2]){case"n":x.v=V[1];break;case"s":v=Fa[V[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!V[1];break;case"e":x.v=V[1],o.cellText!==!1&&(x.w=$t[x.v]);break;case"str":x.t="s",x.v=V[1];break;case"is":x.t="s",x.v=V[1].t;break}if((p=i.CellXf[V[0].iStyleRef])&&H0(x,p.numFmtId,null,o,s,i),_=V[0].c==-1?_+1:V[0].c,o.dense?(c[g]||(c[g]=[]),c[g][_]=x):c[ze(_)+O]=x,o.cellFormula){for(L=!1,k=0;k<I.length;++k){var b=I[k];d.r>=b[0].s.r&&d.r<=b[0].e.r&&_>=b[0].s.c&&_<=b[0].e.c&&(x.F=Ee(b[0]),L=!0)}!L&&V.length>3&&(x.f=V[3])}if(u.s.r>d.r&&(u.s.r=d.r),u.s.c>_&&(u.s.c=_),u.e.r<d.r&&(u.e.r=d.r),u.e.c<_&&(u.e.c=_),o.cellDates&&p&&x.t=="n"&&ca(ve[p.numFmtId])){var j=Ct(x.v);j&&(x.t="d",x.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}oe&&(oe.type=="XLDAPR"&&(x.D=!0),oe=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},_=V[0].c==-1?_+1:V[0].c,o.dense?(c[g]||(c[g]=[]),c[g][_]=x):c[ze(_)+O]=x,u.s.r>d.r&&(u.s.r=d.r),u.s.c>_&&(u.s.c=_),u.e.r<d.r&&(u.e.r=d.r),u.e.c<_&&(u.e.c=_),oe&&(oe.type=="XLDAPR"&&(x.D=!0),oe=void 0);break;case 176:R.push(V);break;case 49:oe=((o.xlmeta||{}).Cell||[])[V-1];break;case 494:var P=a["!id"][V.relId];for(P?(V.Target=P.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=P):V.relId==""&&(V.Target="#"+V.loc),g=V.rfx.s.r;g<=V.rfx.e.r;++g)for(_=V.rfx.s.c;_<=V.rfx.e.c;++_)o.dense?(c[g]||(c[g]=[]),c[g][_]||(c[g][_]={t:"z",v:void 0}),c[g][_].l=V):(E=xe({c:_,r:g}),c[E]||(c[E]={t:"z",v:void 0}),c[E].l=V);break;case 426:if(!o.cellFormula)break;I.push(V),F=o.dense?c[g][_]:c[ze(_)+O],F.f=sr(V[1],u,{r:d.r,c:_},W,o),F.F=Ee(V[0]);break;case 427:if(!o.cellFormula)break;G[xe(V[0].s)]=V[1],F=o.dense?c[g][_]:c[ze(_)+O],F.f=sr(V[1],u,{r:d.r,c:_},W,o);break;case 60:if(!o.cellStyles)break;for(;V.e>=V.s;)X[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},re||(re=!0,si(V.w/256)),ia(X[V.e+1]);break;case 161:c["!autofilter"]={ref:Ee(V)};break;case 476:c["!margins"]=V;break;case 147:n.Sheets[t]||(n.Sheets[t]={}),V.name&&(n.Sheets[t].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!de.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ee(l||u)),o.sheetRows&&c["!ref"]){var ie=Le(c["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>u.e.r&&(ie.e.r=u.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>u.e.c&&(ie.e.c=u.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ee(ie))}return R.length>0&&(c["!merges"]=R),X.length>0&&(c["!cols"]=X),ce.length>0&&(c["!rows"]=ce),c}function Qm(e){var r=[],t=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(r[+i[1]]=t?+i[2]:i[2])});var n=ke((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[r,n,a]}function e_(e,r,t,a,n,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,l="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Qm(f);u.s.r=u.s.c=0,u.e.c=o,l=ze(o),h[0].forEach(function(d,x){i[l+tr(x)]={t:"n",v:d,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(i["!ref"]=Ee(u)),i}function r_(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(W0);return o&&oi(o[0],s,n,t),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function t_(e,r){e.l+=10;var t=cr(e);return{name:t}}function a_(e,r,t,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return st(e,function(c,l,u){switch(u){case 550:s["!rel"]=c;break;case 651:n.Sheets[t]||(n.Sheets[t]={}),c.name&&(n.Sheets[t].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!i||r.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},r),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var G0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],n_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],s_=[],i_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bo(e,r){for(var t=0;t!=e.length;++t)for(var a=e[t],n=0;n!=r.length;++n){var s=r[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Fe(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function Mo(e,r){for(var t=0;t!=r.length;++t){var a=r[t];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Fe(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function K0(e){Mo(e.WBProps,G0),Mo(e.CalcPr,i_),Bo(e.WBView,n_),Bo(e.Sheets,s_),na.date1904=Fe(e.WBProps.date1904)}var o_="][*?/\\".split("");function c_(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return o_.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var l_=/<\w+:workbook/;function u_(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},i=0;if(e.replace(fr,function(c,l){var u=he(c);switch(zr(u[0])){case"<?xml":break;case"<workbook":c.match(l_)&&(n="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],t.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":G0.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":t.WBProps[f[0]]=Fe(u[f[0]]);break;case"int":t.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:t.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(t.WBProps.CodeName=Oe(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],t.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ke(Oe(u.name)),delete u[0],t.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Oe(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Fe(u.hidden||"0")&&(s.Hidden=!0),i=l+c.length;break;case"</definedName>":s.Ref=ke(Oe(e.slice(i,l))),t.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],t.CalcPr=u;break;case"<calcPr/>":delete u[0],t.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&r.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Cd.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return K0(t),t}function f_(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Cs(e),t.name=cr(e),t}function h_(e,r){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var n=r>8?cr(e):"";return n.length>0&&(t.CodeName=n),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function d_(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function p_(e,r,t){var a=e.l+r;e.l+=4,e.l+=1;var n=e.read_shift(4),s=Kd(e),i=Jv(e,0,t),o=ei(e);e.l=a;var c={Name:s,Ptg:i};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function x_(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;r||(r={}),r.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Un[16]={n:"BrtFRTArchID$",f:d_},st(e,function(c,l,u){switch(u){case 156:i.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(r.SID=c.Sheet),c.Ref=sr(c.Ptg,null,null,i,r),delete r.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,c]):i[0]=[u,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(u),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||r.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},r),K0(t),t.Names=s,t.supbooks=i,t}function g_(e,r,t){return r.slice(-4)===".bin"?x_(e,t):u_(e,t)}function v_(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?Zm(e,a,t,n,s,i,o):fm(e,a,t,n,s,i,o)}function m_(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?a_(e,a,t,n,s):r_(e,a,t,n,s)}function __(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?bg():Cg()}function w_(e,r,t,a,n,s,i,o){return r.slice(-4)===".bin"?Ag():Sg()}function y_(e,r,t,a){return r.slice(-4)===".bin"?Hx(e,t,a):Lx(e,t,a)}function E_(e,r,t){return I0(e,t)}function T_(e,r,t){return r.slice(-4)===".bin"?nx(e,t):tx(e,t)}function k_(e,r,t){return r.slice(-4)===".bin"?Eg(e,t):vg(e,t)}function A_(e,r,t){return r.slice(-4)===".bin"?pg(e):hg(e)}function S_(e,r,t,a){return t.slice(-4)===".bin"?xg(e,r,t,a):void 0}function b_(e,r,t){return r.slice(-4)===".bin"?ug(e,r,t):fg(e,r,t)}var q0=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,z0=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ir(e,r){var t=e.split(/\s+/),a=[];if(a[0]=t[0],t.length===1)return a;var n=e.match(q0),s,i,o,c;if(n)for(c=0;c!=n.length;++c)s=n[c].match(z0),(i=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),a[o]=s[2].slice(1,s[2].length-1));return a}function C_(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var a=e.match(q0),n,s,i,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(z0),(s=n[1].indexOf(":"))===-1?t[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?i="xmlns"+n[1].slice(6):i=n[1].slice(s+1),t[i]=n[2].slice(1,n[2].length-1));return t}var Da;function O_(e,r){var t=Da[e]||ke(e);return t==="General"?Dt(r):Rr(t,r)}function R_(e,r,t,a){var n=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Fe(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Je(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ke(r)]=n}function F_(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||$t[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v):e.w=Dt(e.v):e.w=O_(r||"General",e.v)}catch(s){if(t.WTF)throw s}try{var a=Da[r]||r||"General";if(t.cellNF&&(e.z=a),t.cellDates&&e.t=="n"&&ca(a)){var n=Ct(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(t.WTF)throw s}}}function I_(e,r,t){if(t.cellStyles&&r.Interior){var a=r.Interior;a.Pattern&&(a.patternType=Rx[a.Pattern]||a.Pattern)}e[r.ID]=r}function D_(e,r,t,a,n,s,i,o,c,l){var u="General",f=a.StyleID,h={};l=l||{};var d=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(u=s[f].nf),s[f].Interior&&d.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=Fe(e);break;case"String":a.t="s",a.r=so(ke(e)),a.v=e.indexOf("<")>-1?ke(r||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Je(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=ke(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=u0[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&r==""?a.t="z":(a.t="s",a.v=so(r||e));break}if(F_(a,u,l),l.cellFormula!==!1)if(a.Formula){var p=ke(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=aa(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=aa("RC:RC",n):a.ArrayRange&&(a.F=aa(a.ArrayRange,n),c.push([Le(a.F),a.F]))}else for(x=0;x<c.length;++x)n.r>=c[x][0].s.r&&n.r<=c[x][0].e.r&&n.c>=c[x][0].s.c&&n.c<=c[x][0].e.c&&(a.F=c[x][1]);l.cellStyles&&(d.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function P_(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function fs(e,r){var t=r||{};Lc();var a=_a(Xs(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(a=Oe(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var i=rr(t);return i.type="string",Ga.to_workbook(a,i)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Me){n.indexOf("<"+Me)>=0&&(s=!0)}),s)return W_(a,t);Da={"General Number":"General","General Date":ve[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ve[15],"Short Date":ve[14],"Long Time":ve[19],"Medium Time":ve[18],"Short Time":ve[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ve[2],Standard:ve[4],Percent:ve[10],Scientific:ve[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l,u={},f=[],h=t.dense?[]:{},d="",x={},p={},g=Ir('<Data ss:Type="String">'),_=0,E=0,v=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},R={},k="",L=0,I=[],G={},W={},N=0,X=[],ce=[],re={},oe=[],ie,Re=!1,V=[],de=[],pe={},b=0,j=0,P={Sheets:[],WBProps:{date1904:!1}},D={};Va.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var q="";o=Va.exec(a);)switch(o[3]=(q=o[3]).toLowerCase()){case"data":if(q=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?D_(a.slice(_,o.index),k,g,c[c.length-1][0]=="comment"?re:x,{c:E,r:v},F,oe[E],p,V,t):(k="",g=Ir(o[0]),_=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ce.length>0&&(x.c=ce),(!t.sheetRows||t.sheetRows>v)&&x.v!==void 0&&(t.dense?(h[v]||(h[v]=[]),h[v][E]=x):h[ze(E)+tr(v)]=x),x.HRef&&(x.l={Target:ke(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(b=E+(parseInt(x.MergeAcross,10)|0),j=v+(parseInt(x.MergeDown,10)|0),I.push({s:{c:E,r:v},e:{c:b,r:j}})),!t.sheetStubs)x.MergeAcross?E=b+1:++E;else if(x.MergeAcross||x.MergeDown){for(var ee=E;ee<=b;++ee)for(var ne=v;ne<=j;++ne)(ee>E||ne>v)&&(t.dense?(h[ne]||(h[ne]=[]),h[ne][ee]={t:"z"}):h[ze(ee)+tr(ne)]={t:"z"});E=b+1}else++E;else x=C_(o[0]),x.Index&&(E=+x.Index-1),E<O.s.c&&(O.s.c=E),E>O.e.c&&(O.e.c=E),o[0].slice(-2)==="/>"&&++E,ce=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<O.s.r&&(O.s.r=v),v>O.e.r&&(O.e.r=v),o[0].slice(-2)==="/>"&&(p=Ir(o[0]),p.Index&&(v=+p.Index-1)),E=0,++v):(p=Ir(o[0]),p.Index&&(v=+p.Index-1),pe={},(p.AutoFitHeight=="0"||p.Height)&&(pe.hpx=parseInt(p.Height,10),pe.hpt=F0(pe.hpx),de[v]=pe),p.Hidden=="1"&&(pe.hidden=!0,de[v]=pe));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(d),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(h["!ref"]=Ee(O),t.sheetRows&&t.sheetRows<=O.e.r&&(h["!fullref"]=h["!ref"],O.e.r=t.sheetRows-1,h["!ref"]=Ee(O))),I.length&&(h["!merges"]=I),oe.length>0&&(h["!cols"]=oe),de.length>0&&(h["!rows"]=de),u[d]=h}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=E=0,c.push([o[3],!1]),l=Ir(o[0]),d=ke(l.Name),h=t.dense?[]:{},I=[],V=[],de=[],D={name:d,Hidden:0},P.Sheets.push(D);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),oe=[],Re=!1}break;case"style":o[1]==="/"?I_(F,R,t):R=Ir(o[0]);break;case"numberformat":R.nf=ke(Ir(o[0]).Format||"General"),Da[R.nf]&&(R.nf=Da[R.nf]);for(var Z=0;Z!=392&&ve[Z]!=R.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(ve[Z]==null){Ot(R.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Ir(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!Re&&ie.wpx>10){Re=!0,pr=O0;for(var Y=0;Y<oe.length;++Y)oe[Y]&&ia(oe[Y])}Re&&ia(ie),oe[ie.Index-1||oe.length]=ie;for(var Te=0;Te<+ie.Span;++Te)oe[oe.length]=rr(ie);break;case"namedrange":if(o[1]==="/")break;P.Names||(P.Names=[]);var C=he(o[0]),Be={Name:C.Name,Ref:aa(C.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Be.Sheet=P.Sheets.length-1),P.Names.push(Be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(L,o.index):L=o.index+o[0].length;break;case"interior":if(!t.cellStyles)break;R.Interior=Ir(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v1(G,q,a.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));P_(re),ce.push(re)}else c.push([o[3],!1]),l=Ir(o[0]),re={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ae=Ir(o[0]);h["!autofilter"]={ref:aa(Ae.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Vo(a,t);var be=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(o[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:be=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(N,o.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else N=o.index+o[0].length;break;case"header":h["!margins"]||Ia(h["!margins"]={},"xlml"),isNaN(+he(o[0]).Margin)||(h["!margins"].header=+he(o[0]).Margin);break;case"footer":h["!margins"]||Ia(h["!margins"]={},"xlml"),isNaN(+he(o[0]).Margin)||(h["!margins"].footer=+he(o[0]).Margin);break;case"pagemargins":var _e=he(o[0]);h["!margins"]||Ia(h["!margins"]={},"xlml"),isNaN(+_e.Top)||(h["!margins"].top=+_e.Top),isNaN(+_e.Left)||(h["!margins"].left=+_e.Left),isNaN(+_e.Right)||(h["!margins"].right=+_e.Right),isNaN(+_e.Bottom)||(h["!margins"].bottom=+_e.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:be=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:be=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:be=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1;break}if(be||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?R_(W,q,X,a.slice(N,o.index)):(X=o,N=o.index+o[0].length);break}if(t.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var te={};return!t.bookSheets&&!t.bookProps&&(te.Sheets=u),te.SheetNames=f,te.Workbook=P,te.SSF=rr(ve),te.Props=G,te.Custprops=W,te}function Is(e,r){switch(ui(r=r||{}),r.type||"base64"){case"base64":return fs(kr(e),r);case"binary":case"buffer":case"file":return fs(e,r);case"array":return fs(Bt(e),r)}}function N_(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=Xd(t),t.length-t.l<=4)return r;var a=t.read_shift(4);if(a==0||a>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(a=t.read_shift(4),a!==1907505652)||(r.UnicodeClipboardFormat=Yd(t),a=t.read_shift(4),a==0||a>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var L_=[60,1084,2066,2165,2175];function B_(e,r,t,a,n){var s=a,i=[],o=t.slice(t.l,t.l+s);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}i.push(o),t.l+=s;for(var c=et(t,t.l),l=Ds[c],u=0;l!=null&&L_.indexOf(c)>-1;)s=et(t,t.l+2),u=t.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=t.slice(u,t.l+4+s),i.push(o),t.l+=4+s,l=Ds[c=et(t,t.l)];var f=ft(i);er(f,0);var h=0;f.lens=[];for(var d=0;d<i.length;++d)f.lens.push(h),h+=i[d].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return r.f(f,f.length,n)}function Vr(e,r,t){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=ve[a])}catch(s){if(r.WTF)throw s}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||$t[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Ha(e.v):e.w=Dt(e.v):e.w=Rr(a,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&a&&e.t=="n"&&ca(ve[a]||String(a))){var n=Ct(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function En(e,r,t){return{v:e,ixfe:r,t}}function M_(e,r){var t={opts:{}},a={},n=r.dense?[]:{},s={},i={},o=null,c=[],l="",u={},f,h="",d,x,p,g,_={},E=[],v,O,F=[],R=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},I=function(me){return me<8?Rt[me]:me<64&&R[me-8]||Rt[me]},G=function(me,Ue,Sr){var Ge=Ue.XF.data;if(!(!Ge||!Ge.patternType||!Sr||!Sr.cellStyles)){Ue.s={},Ue.s.patternType=Ge.patternType;var mt;(mt=Ka(I(Ge.icvFore)))&&(Ue.s.fgColor={rgb:mt}),(mt=Ka(I(Ge.icvBack)))&&(Ue.s.bgColor={rgb:mt})}},W=function(me,Ue,Sr){if(!(pe>1)&&!(Sr.sheetRows&&me.r>=Sr.sheetRows)){if(Sr.cellStyles&&Ue.XF&&Ue.XF.data&&G(me,Ue,Sr),delete Ue.ixfe,delete Ue.XF,f=me,h=xe(me),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),me.r<i.s.r&&(i.s.r=me.r),me.c<i.s.c&&(i.s.c=me.c),me.r+1>i.e.r&&(i.e.r=me.r+1),me.c+1>i.e.c&&(i.e.c=me.c+1),Sr.cellFormula&&Ue.f){for(var Ge=0;Ge<E.length;++Ge)if(!(E[Ge][0].s.c>me.c||E[Ge][0].s.r>me.r)&&!(E[Ge][0].e.c<me.c||E[Ge][0].e.r<me.r)){Ue.F=Ee(E[Ge][0]),(E[Ge][0].s.c!=me.c||E[Ge][0].s.r!=me.r)&&delete Ue.f,Ue.f&&(Ue.f=""+sr(E[Ge][1],i,me,V,N));break}}Sr.dense?(n[me.r]||(n[me.r]=[]),n[me.r][me.c]=Ue):n[h]=Ue}},N={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(N.password=r.password);var X,ce=[],re=[],oe=[],ie=[],Re=!1,V=[];V.SheetNames=N.snames,V.sharedf=N.sharedf,V.arrayf=N.arrayf,V.names=[],V.XTI=[];var de=0,pe=0,b=0,j=[],P=[],D;N.codepage=1200,Ur(1200);for(var q=!1;e.l<e.length-1;){var ee=e.l,ne=e.read_shift(2);if(ne===0&&de===10)break;var Z=e.l===e.length?0:e.read_shift(2),Y=Ds[ne];if(Y&&Y.f){if(r.bookSheets&&de===133&&ne!==133)break;if(de=ne,Y.r===2||Y.r==12){var Te=e.read_shift(2);if(Z-=2,!N.enc&&Te!==ne&&((Te&255)<<8|Te>>8)!==ne)throw new Error("rt mismatch: "+Te+"!="+ne);Y.r==12&&(e.l+=10,Z-=10)}var C={};if(ne===10?C=Y.f(e,Z,N):C=B_(ne,Y,e,Z,N),pe==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(ne){case 34:t.opts.Date1904=k.WBProps.date1904=C;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(N.enc||(e.l=0),N.enc=C,!r.password)throw new Error("File is password-protected");if(C.valid==null)throw new Error("Encryption scheme unsupported");if(!C.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=C;break;case 66:var Be=Number(C);switch(Be){case 21010:Be=1200;break;case 32768:Be=1e4;break;case 32769:Be=1252;break}Ur(N.codepage=Be),q=!0;break;case 317:N.rrtabid=C;break;case 25:N.winlocked=C;break;case 439:t.opts.RefreshAll=C;break;case 12:t.opts.CalcCount=C;break;case 16:t.opts.CalcDelta=C;break;case 17:t.opts.CalcIter=C;break;case 13:t.opts.CalcMode=C;break;case 14:t.opts.CalcPrecision=C;break;case 95:t.opts.CalcSaveRecalc=C;break;case 15:N.CalcRefMode=C;break;case 2211:t.opts.FullCalc=C;break;case 129:C.fDialog&&(n["!type"]="dialog"),C.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),C.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:F.push(C);break;case 430:V.push([C]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(C);break;case 24:case 536:D={Name:C.Name,Ref:sr(C.rgce,i,null,V,N)},C.itab>0&&(D.Sheet=C.itab-1),V.names.push(D),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(C),C.Name=="_xlnm._FilterDatabase"&&C.itab>0&&C.rgce&&C.rgce[0]&&C.rgce[0][0]&&C.rgce[0][0][0]=="PtgArea3d"&&(P[C.itab-1]={ref:Ee(C.rgce[0][0][1][2])});break;case 22:N.ExternCount=C;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(C),V.XTI=V.XTI.concat(C);break;case 2196:if(N.biff<8)break;D!=null&&(D.Comment=C[1]);break;case 18:n["!protect"]=C;break;case 19:C!==0&&N.WTF&&console.error("Password verifier: "+C);break;case 133:s[C.pos]=C,N.snames.push(C.name);break;case 10:{if(--pe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,n["!ref"]=Ee(i),r.sheetRows&&r.sheetRows<=i.e.r){var Ae=i.e.r;i.e.r=r.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Ee(i),i.e.r=Ae}i.e.r++,i.e.c++}ce.length>0&&(n["!merges"]=ce),re.length>0&&(n["!objects"]=re),oe.length>0&&(n["!cols"]=oe),ie.length>0&&(n["!rows"]=ie),k.Sheets.push(L)}l===""?u=n:a[l]=n,n=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[C.BIFFVer]||8),N.biffguess=C.BIFFVer==0,C.BIFFVer==0&&C.dt==4096&&(N.biff=5,q=!0,Ur(N.codepage=28591)),N.biff==8&&C.BIFFVer==0&&C.dt==16&&(N.biff=2),pe++)break;if(n=r.dense?[]:{},N.biff<8&&!q&&(q=!0,Ur(N.codepage=r.codepage||1252)),N.biff<5||C.BIFFVer==0&&C.dt==4096){l===""&&(l="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var be={pos:e.l-Z,name:l};s[be.pos]=be,N.snames.push(l)}else l=(s[ee]||{name:""}).name;C.dt==32&&(n["!type"]="chart"),C.dt==64&&(n["!type"]="macro"),ce=[],re=[],N.arrayf=E=[],oe=[],ie=[],Re=!1,L={Hidden:(s[ee]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(r.dense?(n[C.r]||[])[C.c]:n[xe({c:C.c,r:C.r})])&&++C.c,v={ixfe:C.ixfe,XF:F[C.ixfe]||{},v:C.val,t:"n"},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r);break;case 5:case 517:v={ixfe:C.ixfe,XF:F[C.ixfe],v:C.val,t:C.t},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r);break;case 638:v={ixfe:C.ixfe,XF:F[C.ixfe],v:C.rknum,t:"n"},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r);break;case 189:for(var _e=C.c;_e<=C.C;++_e){var te=C.rkrec[_e-C.c][0];v={ixfe:te,XF:F[te],v:C.rkrec[_e-C.c][1],t:"n"},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:_e,r:C.r},v,r)}break;case 6:case 518:case 1030:{if(C.val=="String"){o=C;break}if(v=En(C.val,C.cell.ixfe,C.tt),v.XF=F[v.ixfe],r.cellFormula){var Me=C.formula;if(Me&&Me[0]&&Me[0][0]&&Me[0][0][0]=="PtgExp"){var Ar=Me[0][0][1][0],Hr=Me[0][0][1][1],Yr=xe({r:Ar,c:Hr});_[Yr]?v.f=""+sr(C.formula,i,C.cell,V,N):v.F=((r.dense?(n[Ar]||[])[Hr]:n[Yr])||{}).F}else v.f=""+sr(C.formula,i,C.cell,V,N)}b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W(C.cell,v,r),o=C}break;case 7:case 519:if(o)o.val=C,v=En(C,o.cell.ixfe,"s"),v.XF=F[v.ixfe],r.cellFormula&&(v.f=""+sr(o.formula,i,o.cell,V,N)),b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W(o.cell,v,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(C);var fa=xe(C[0].s);if(d=r.dense?(n[C[0].s.r]||[])[C[0].s.c]:n[fa],r.cellFormula&&d){if(!o||!fa||!d)break;d.f=""+sr(C[1],i,C[0],V,N),d.F=Ee(C[0])}}break;case 1212:{if(!r.cellFormula)break;if(h){if(!o)break;_[xe(o.cell)]=C[0],d=r.dense?(n[o.cell.r]||[])[o.cell.c]:n[xe(o.cell)],(d||{}).f=""+sr(C[0],i,f,V,N)}}break;case 253:v=En(c[C.isst].t,C.ixfe,"s"),c[C.isst].h&&(v.h=c[C.isst].h),v.XF=F[v.ixfe],b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:C.ixfe,XF:F[C.ixfe],t:"z"},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r));break;case 190:if(r.sheetStubs)for(var it=C.c;it<=C.C;++it){var _r=C.ixfe[it-C.c];v={ixfe:_r,XF:F[_r],t:"z"},b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:it,r:C.r},v,r)}break;case 214:case 516:case 4:v=En(C.val,C.ixfe,"s"),v.XF=F[v.ixfe],b>0&&(v.z=j[v.ixfe>>8&63]),Vr(v,r,t.opts.Date1904),W({c:C.c,r:C.r},v,r);break;case 0:case 512:pe===1&&(i=C);break;case 252:c=C;break;case 1054:if(N.biff==4){j[b++]=C[1];for(var Jr=0;Jr<b+163&&ve[Jr]!=C[1];++Jr);Jr>=163&&Ot(C[1],b+163)}else Ot(C[1],C[0]);break;case 30:{j[b++]=C;for(var ot=0;ot<b+163&&ve[ot]!=C;++ot);ot>=163&&Ot(C,b+163)}break;case 229:ce=ce.concat(C);break;case 93:re[C.cmo[0]]=N.lastobj=C;break;case 438:N.lastobj.TxO=C;break;case 127:N.lastobj.ImData=C;break;case 440:for(g=C[0].s.r;g<=C[0].e.r;++g)for(p=C[0].s.c;p<=C[0].e.c;++p)d=r.dense?(n[g]||[])[p]:n[xe({c:p,r:g})],d&&(d.l=C[1]);break;case 2048:for(g=C[0].s.r;g<=C[0].e.r;++g)for(p=C[0].s.c;p<=C[0].e.c;++p)d=r.dense?(n[g]||[])[p]:n[xe({c:p,r:g})],d&&d.l&&(d.l.Tooltip=C[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;d=r.dense?(n[C[0].r]||[])[C[0].c]:n[xe(C[0])];var ha=re[C[2]];d||(r.dense?(n[C[0].r]||(n[C[0].r]=[]),d=n[C[0].r][C[0].c]={t:"z"}):d=n[xe(C[0])]={t:"z"},i.e.r=Math.max(i.e.r,C[0].r),i.s.r=Math.min(i.s.r,C[0].r),i.e.c=Math.max(i.e.c,C[0].c),i.s.c=Math.min(i.s.c,C[0].c)),d.c||(d.c=[]),x={a:C[1],t:ha.TxO.t},d.c.push(x)}break;case 2173:ig(F[C.ixfe],C.ext);break;case 125:{if(!N.cellStyles)break;for(;C.e>=C.s;)oe[C.e--]={width:C.w/256,level:C.level||0,hidden:!!(C.flags&1)},Re||(Re=!0,si(C.w/256)),ia(oe[C.e+1])}break;case 520:{var hr={};C.level!=null&&(ie[C.r]=hr,hr.level=C.level),C.hidden&&(ie[C.r]=hr,hr.hidden=!0),C.hpt&&(ie[C.r]=hr,hr.hpt=C.hpt,hr.hpx=qa(C.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Ia(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=C;break;case 161:n["!margins"]||Ia(n["!margins"]={}),n["!margins"].header=C.header,n["!margins"].footer=C.footer;break;case 574:C.RTL&&(k.Views[0].RTL=!0);break;case 146:R=C;break;case 2198:X=C;break;case 140:O=C;break;case 442:l?L.CodeName=C||L.name:k.WBProps.CodeName=C||"ThisWorkbook";break}}else Y||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),e.l+=Z}return t.SheetNames=qr(s).sort(function(Wr,me){return Number(Wr)-Number(me)}).map(function(Wr){return s[Wr].name}),r.bookSheets||(t.Sheets=a),!t.SheetNames.length&&u["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=u)):t.Preamble=u,t.Sheets&&P.forEach(function(Wr,me){t.Sheets[t.SheetNames[me]]["!autofilter"]=Wr}),t.Strings=c,t.SSF=rr(ve),N.enc&&(t.Encryption=N.enc),X&&(t.Themes=X),t.Metadata={},O!==void 0&&(t.Metadata.Country=O),V.names.length>0&&(k.Names=V.names),t.Workbook=k,t}var Uo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function U_(e,r,t){var a=ye.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Eo(a,t1,Uo.DSI);for(var s in n)r[s]=n[s]}catch(l){if(t.WTF)throw l}var i=ye.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Eo(i,a1,Uo.SI);for(var c in o)r[c]==null&&(r[c]=o[c])}catch(l){if(t.WTF)throw l}r.HeadingPairs&&r.TitlesOfParts&&(h0(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function X0(e,r){r||(r={}),ui(r),kc(),r.codepage&&Hs(r.codepage);var t,a;if(e.FullPaths){if(ye.find(e,"/encryption"))throw new Error("File is password-protected");t=ye.find(e,"!CompObj"),a=ye.find(e,"/Workbook")||ye.find(e,"/Book")}else{switch(r.type){case"base64":e=Br(kr(e));break;case"binary":e=Br(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}er(e,0),a={content:e}}var n,s;if(t&&N_(t),r.bookProps&&!r.bookSheets)n={};else{var i=we?"buffer":"array";if(a&&a.content)n=M_(a.content,r);else if((s=ye.find(e,"PerfectOffice_MAIN"))&&s.content)n=Ra.to_workbook(s.content,(r.type=i,r));else if((s=ye.find(e,"NativeContent_MAIN"))&&s.content)n=Ra.to_workbook(s.content,(r.type=i,r));else throw(s=ye.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=kg(e))}var o={};return e.FullPaths&&U_(e,o,r),n.Props=n.Custprops=o,r.bookFiles&&(n.cfb=e),n}var Un={0:{f:wm},1:{f:km},2:{f:Dm},3:{f:Cm},4:{f:Sm},5:{f:Im},6:{f:Lm},7:{f:Rm},8:{f:jm},9:{f:$m},10:{f:Mm},11:{f:Um},12:{f:Am},13:{f:Pm},14:{f:Om},15:{f:bm},16:{f:V0},17:{f:Bm},18:{f:Fm},19:{f:Qs},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:p_},40:{},42:{},43:{f:Mx},44:{f:Bx},45:{f:Ux},46:{f:jx},47:{f:$x},48:{},49:{f:Hd},50:{},51:{f:cg},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:k0},62:{f:Nm},63:{f:dg},64:{f:Ym},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Xm},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Tm},148:{f:ym,p:16},151:{f:Vm},152:{},153:{f:h_},154:{},155:{},156:{f:f_},157:{},158:{},159:{T:1,f:ax},160:{T:-1},161:{T:1,f:Ut},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Hm},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:og},336:{T:-1},337:{f:lg,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cs},357:{},358:{},359:{},360:{T:1},361:{},362:{f:T0},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Gm},427:{f:Km},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zm},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Em},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Wm},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cs},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:yg},633:{T:1},634:{T:-1},635:{T:1,f:wg},636:{T:-1},637:{f:Vd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:t_},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Jm},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ds={6:{f:ls},10:{f:ct},12:{f:We},13:{f:We},14:{f:$e},15:{f:$e},16:{f:ir},17:{f:$e},18:{f:$e},19:{f:We},20:{f:So},21:{f:So},23:{f:T0},24:{f:Co},25:{f:$e},26:{},27:{},28:{f:mp},29:{},34:{f:$e},35:{f:bo},38:{f:ir},39:{f:ir},40:{f:ir},41:{f:ir},42:{f:$e},43:{f:$e},47:{f:Ex},49:{f:Q1},51:{f:We},60:{},61:{f:Y1},64:{f:$e},65:{f:Z1},66:{f:We},77:{},80:{},81:{},82:{},85:{f:We},89:{},90:{},91:{},92:{f:H1},93:{f:wp},94:{},95:{f:$e},96:{},97:{},99:{f:$e},125:{f:k0},128:{f:lp},129:{f:W1},130:{f:We},131:{f:$e},132:{f:$e},133:{f:V1},134:{},140:{f:Sp},141:{f:We},144:{},146:{f:Cp},151:{},152:{},153:{},154:{},155:{},156:{f:We},157:{},158:{},160:{f:Dp},161:{f:Rp},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sp},190:{f:ip},193:{f:ct},197:{},198:{},199:{},200:{},201:{},202:{f:$e},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:We},220:{},221:{f:$e},222:{},224:{f:cp},225:{f:j1},226:{f:ct},227:{},229:{f:_p},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:G1},253:{f:ep},255:{f:K1},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:v0},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:$e},353:{f:ct},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:fp},431:{f:$e},432:{},433:{},434:{},437:{},438:{f:Tp},439:{f:$e},440:{f:kp},441:{},442:{f:en},443:{},444:{f:We},445:{},446:{},448:{f:ct},449:{f:X1,r:2},450:{f:ct},512:{f:ko},513:{f:Ip},515:{f:up},516:{f:rp},517:{f:Ao},519:{f:Pp},520:{f:q1},523:{},545:{f:Oo},549:{f:To},566:{},574:{f:J1},638:{f:np},659:{},1048:{},1054:{f:tp},1084:{},1212:{f:xp},2048:{f:Ap},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_n},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ct},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Op,r:12},2173:{f:sg,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:$e,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pp,r:12},2197:{},2198:{f:Qx,r:12},2199:{},2200:{},2201:{},2202:{f:gp,r:12},2203:{f:ct},2204:{},2205:{},2206:{},2207:{},2211:{f:z1},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:We},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Fp},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bp},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ko},1:{},2:{f:Mp},3:{f:Bp},4:{f:Lp},5:{f:Ao},7:{f:Up},8:{},9:{f:_n},11:{},22:{f:We},30:{f:ap},31:{},32:{},33:{f:Oo},36:{},37:{f:To},50:{f:$p},62:{},52:{},67:{},68:{f:We},69:{},86:{},126:{},127:{f:Np},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:jp},223:{},234:{},354:{},421:{},518:{f:ls},521:{f:_n},536:{f:Co},547:{f:bo},561:{},579:{},1030:{f:ls},1033:{f:_n},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Dr(e,r,t,a){var n=r;if(!isNaN(n)){var s=(t||[]).length||0,i=e.next(4);i.write_shift(2,n),i.write_shift(2,s),s>0&&n0(t)&&e.push(t)}}function $o(e,r){var t=r||{},a=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=n.index,o=s&&s.index||e.length,c=ud(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,u=0,f=0,h=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var p=c[i].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++l,t.sheetRows&&t.sheetRows<=l){--l;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var _=p.split(/<\/t[dh]>/i);for(o=0;o<_.length;++o){var E=_[o].trim();if(E.match(/<t[dh]/i)){for(var v=E,O=0;v.charAt(0)=="<"&&(O=v.indexOf(">"))>-1;)v=v.slice(O+1);for(var F=0;F<x.length;++F){var R=x[F];R.s.c==u&&R.s.r<l&&l<=R.e.r&&(u=R.e.c+1,F=-1)}var k=he(E.slice(0,E.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&x.push({s:{r:l,c:u},e:{r:l+(f||1)-1,c:u+h-1}});var L=k.t||k["data-t"]||"";if(!v.length){u+=h;continue}if(v=Gc(v),d.s.r>l&&(d.s.r=l),d.e.r<l&&(d.e.r=l),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),!v.length){u+=h;continue}var I={t:"s",v};t.raw||!v.trim().length||L=="s"||(v==="TRUE"?I={t:"b",v:!0}:v==="FALSE"?I={t:"b",v:!1}:isNaN(jr(v))?isNaN(sa(v).getDate())||(I={t:"d",v:Je(v)},t.cellDates||(I={t:"n",v:vr(I.v)}),I.z=t.dateNF||ve[14]):I={t:"n",v:jr(v)}),t.dense?(a[l]||(a[l]=[]),a[l][u]=I):a[xe({r:l,c:u})]=I,u+=h}}}}return a["!ref"]=Ee(d),x.length&&(a["!merges"]=x),a}function $_(e,r,t,a){for(var n=e["!merges"]||[],s=[],i=r.s.c;i<=r.e.c;++i){for(var o=0,c=0,l=0;l<n.length;++l)if(!(n[l].s.r>t||n[l].s.c>i)&&!(n[l].e.r<t||n[l].e.c<i)){if(n[l].s.r<t||n[l].s.c<i){o=-1;break}o=n[l].e.r-n[l].s.r+1,c=n[l].e.c-n[l].s.c+1;break}if(!(o<0)){var u=xe({r:t,c:i}),f=a.dense?(e[t]||[])[i]:e[u],h=f&&f.v!=null&&(f.h||zs(f.w||(at(f),f.w)||""))||"",d={};o>1&&(d.rowspan=o),c>1&&(d.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(d["data-t"]=f&&f.t||"z",f.v!=null&&(d["data-v"]=f.v),f.z!=null&&(d["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),d.id=(a.id||"sjs")+"-"+u,s.push(Sd("td",h,d))}}var x="<tr>";return x+s.join("")+"</tr>"}var j_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',H_="</body></html>";function W_(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return vt($o(t[0],r),r);var a=hi();return t.forEach(function(n,s){di(a,$o(n,r),"Sheet"+(s+1))}),a}function V_(e,r,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function G_(e,r){var t=r||{},a=t.header!=null?t.header:j_,n=t.footer!=null?t.footer:H_,s=[a],i=la(e["!ref"]);t.dense=Array.isArray(e),s.push(V_(e,i,t));for(var o=i.s.r;o<=i.e.r;++o)s.push($_(e,i,o,t));return s.push("</table>"+n),s.join("")}function Y0(e,r,t){var a=t||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var i=typeof a.origin=="string"?xr(a.origin):a.origin;n=i.r,s=i.c}var o=r.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var u=la(e["!ref"]);l.s.r=Math.min(l.s.r,u.s.r),l.s.c=Math.min(l.s.c,u.s.c),l.e.r=Math.max(l.e.r,u.e.r),l.e.c=Math.max(l.e.c,u.e.c),n==-1&&(l.e.r=n=u.e.r+1)}var f=[],h=0,d=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,_=0,E=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var O=o[x];if(jo(O)){if(a.display)continue;d[p]={hidden:!0}}var F=O.children;for(g=_=0;g<F.length;++g){var R=F[g];if(!(a.display&&jo(R))){var k=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Gc(R.innerHTML),L=R.getAttribute("data-z")||R.getAttribute("z");for(h=0;h<f.length;++h){var I=f[h];I.s.c==_+s&&I.s.r<p+n&&p+n<=I.e.r&&(_=I.e.c+1-s,h=-1)}v=+R.getAttribute("colspan")||1,((E=+R.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+n,c:_+s},e:{r:p+n+(E||1)-1,c:_+s+(v||1)-1}});var G={t:"s",v:k},W=R.getAttribute("data-t")||R.getAttribute("t")||"";k!=null&&(k.length==0?G.t=W||"z":a.raw||k.trim().length==0||W=="s"||(k==="TRUE"?G={t:"b",v:!0}:k==="FALSE"?G={t:"b",v:!1}:isNaN(jr(k))?isNaN(sa(k).getDate())||(G={t:"d",v:Je(k)},a.cellDates||(G={t:"n",v:vr(G.v)}),G.z=a.dateNF||ve[14]):G={t:"n",v:jr(k)})),G.z===void 0&&L!=null&&(G.z=L);var N="",X=R.getElementsByTagName("A");if(X&&X.length)for(var ce=0;ce<X.length&&!(X[ce].hasAttribute("href")&&(N=X[ce].getAttribute("href"),N.charAt(0)!="#"));++ce);N&&N.charAt(0)!="#"&&(G.l={Target:N}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][_+s]=G):e[xe({c:_+s,r:p+n})]=G,l.e.c<_+s&&(l.e.c=_+s),_+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=Ee(l),p>=c&&(e["!fullref"]=Ee((l.e.r=o.length-x+p-1+n,l))),e}function J0(e,r){var t=r||{},a=t.dense?[]:{};return Y0(a,e,r)}function K_(e,r){return vt(J0(e,r),r)}function jo(e){var r="",t=q_(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function q_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function z_(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=ke(r.replace(/<[^>]*>/g,""));return[t]}var Ho={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Z0(e,r){var t=r||{},a=Xs(e),n=[],s,i,o={name:""},c="",l=0,u,f,h={},d=[],x=t.dense?[]:{},p,g,_={value:""},E="",v=0,O=[],F=-1,R=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,I={},G=[],W={},N=0,X=0,ce=[],re=1,oe=1,ie=[],Re={Names:[]},V={},de=["",""],pe=[],b={},j="",P=0,D=!1,q=!1,ee=0;for(Va.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Va.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Ee(k):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=t.sheetRows-1,x["!ref"]=Ee(k)),G.length&&(x["!merges"]=G),ce.length&&(x["!rows"]=ce),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),d.push(u.name),h[u.name]=x,q=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=he(p[0],!1),F=R=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=t.dense?[]:{},G=[],ce=[],q=!0);break;case"table-row-group":p[1]==="/"?--L:++L;break;case"table-row":case"":if(p[1]==="/"){F+=re,re=1;break}if(f=he(p[0],!1),f.?F=f.-1:F==-1&&(F=0),re=+f["number-rows-repeated"]||1,re<10)for(ee=0;ee<re;++ee)L>0&&(ce[F+ee]={level:L});R=-1;break;case"covered-table-cell":p[1]!=="/"&&++R,t.sheetStubs&&(t.dense?(x[F]||(x[F]=[]),x[F][R]={t:"z"}):x[xe({r:F,c:R})]={t:"z"}),E="",O=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++R,_=he(p[0],!1),oe=parseInt(_["number-columns-repeated"]||"1",10),g={t:"z",v:null},_.formula&&t.cellFormula!=!1&&(g.f=Lo(ke(_.formula))),(_.||_["value-type"])=="string"&&(g.t="s",g.v=ke(_["string-value"]||""),t.dense?(x[F]||(x[F]=[]),x[F][R]=g):x[xe({r:F,c:R})]=g),R+=oe-1;else if(p[1]!=="/"){++R,E="",v=0,O=[],oe=1;var ne=re?F+re-1:F;if(R>k.e.c&&(k.e.c=R),R<k.s.c&&(k.s.c=R),F<k.s.r&&(k.s.r=F),ne>k.e.r&&(k.e.r=ne),_=he(p[0],!1),pe=[],b={},g={t:_.||_["value-type"],v:null},t.cellFormula)if(_.formula&&(_.formula=ke(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(N=parseInt(_["number-matrix-rows-spanned"],10)||0,X=parseInt(_["number-matrix-columns-spanned"],10)||0,W={s:{r:F,c:R},e:{r:F+N-1,c:R+X-1}},g.F=Ee(W),ie.push([W,g.F])),_.formula)g.f=Lo(_.formula);else for(ee=0;ee<ie.length;++ee)F>=ie[ee][0].s.r&&F<=ie[ee][0].e.r&&R>=ie[ee][0].s.c&&R<=ie[ee][0].e.c&&(g.F=ie[ee][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(N=parseInt(_["number-rows-spanned"],10)||0,X=parseInt(_["number-columns-spanned"],10)||0,W={s:{r:F,c:R},e:{r:F+N-1,c:R+X-1}},G.push(W)),_["number-columns-repeated"]&&(oe=parseInt(_["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Fe(_["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(_.value);break;case"percentage":g.t="n",g.v=parseFloat(_.value);break;case"currency":g.t="n",g.v=parseFloat(_.value);break;case"date":g.t="d",g.v=Je(_["date-value"]),t.cellDates||(g.t="n",g.v=vr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=od(_["time-value"])/86400,t.cellDates&&(g.t="d",g.v=Gn(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(_.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",_["string-value"]!=null&&(E=ke(_["string-value"]),O=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(D=!1,g.t==="s"&&(g.v=E||"",O.length&&(g.R=O),D=v==0),V.Target&&(g.l=V),pe.length>0&&(g.c=pe,pe=[]),E&&t.cellText!==!1&&(g.w=E),D&&(g.t="z",delete g.v),(!D||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=F))for(var Z=0;Z<re;++Z){if(oe=parseInt(_["number-columns-repeated"]||"1",10),t.dense)for(x[F+Z]||(x[F+Z]=[]),x[F+Z][R]=Z==0?g:rr(g);--oe>0;)x[F+Z][R+oe]=rr(g);else for(x[xe({r:F+Z,c:R})]=g;--oe>0;)x[xe({r:F+Z,c:R+oe})]=rr(g);k.e.c<=R&&(k.e.c=R)}oe=parseInt(_["number-columns-repeated"]||"1",10),R+=oe-1,oe=0,g={},E="",O=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s;b.t=E,O.length&&(b.R=O),b.a=j,pe.push(b)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);j="",P=0,E="",v=0,O=[];break;case"creator":p[1]==="/"?j=a.slice(P,p.index):P=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);E="",v=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(I[o.name]=c,(s=n.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=he(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":i=he(p[0],!1),c+=Ho[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":i=he(p[0],!1),c+=Ho[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":i=he(p[0],!1),de=us(i["cell-range-address"]);var Y={Name:i.name,Ref:de[0]+"!"+de[1]};q&&(Y.Sheet=d.length),Re.Names.push(Y);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!_||!_["string-value"])){var Te=z_(a.slice(v,p.index));E=(E.length>0?E+`
`:"")+Te[0]}else he(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{de=us(he(p[0])["target-range-address"]),h[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(V=he(p[0],!1),!V.href)break;V.Target=ke(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(de=us(V.Target.slice(1)),V.Target="#"+de[0]+"!"+de[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(p)}}var C={Sheets:h,SheetNames:d,Workbook:Re};return t.bookSheets&&delete C.Sheets,C}function Wo(e,r){r=r||{},Or(e,"META-INF/manifest.xml")&&u1(He(e,"META-INF/manifest.xml"),r);var t=Tr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=Z0(Oe(t),r);return Or(e,"meta.xml")&&(a.Props=f0(He(e,"meta.xml"))),a}function Vo(e,r){return Z0(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ci(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ps(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Oe(Bt(e))}function Ns(e){var r=e.reduce(function(n,s){return n+s.length},0),t=new Uint8Array(r),a=0;return e.forEach(function(n){t.set(n,a),a+=n.length}),t}function Go(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function X_(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,a=e[r+14]&1,n=r+13;n>=r;--n)a=a*256+e[n];return(e[r+15]&128?-a:a)*Math.pow(10,t-6176)}function za(e,r){var t=r?r[0]:0,a=e[t]&127;e:if(e[t++]>=128&&(a|=(e[t]&127)<<7,e[t++]<128||(a|=(e[t]&127)<<14,e[t++]<128)||(a|=(e[t]&127)<<21,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(a+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),a}function Xe(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function or(e){for(var r=[],t=[0];t[0]<e.length;){var a=t[0],n=za(e,t),s=n&7;n=Math.floor(n/8);var i=0,o;if(n==0)break;switch(s){case 0:{for(var c=t[0];e[t[0]++]>=128;);o=e.slice(c,t[0])}break;case 5:i=4,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 1:i=8,o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 2:i=za(e,t),o=e.slice(t[0],t[0]+i),t[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var l={data:o,type:s};r[n]==null?r[n]=[l]:r[n].push(l)}return r}function li(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function Y_(e){for(var r,t=[],a=[0];a[0]<e.length;){var n=za(e,a),s=or(e.slice(a[0],a[0]+n));a[0]+=n;var i={id:Xe(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=or(o.data),l=Xe(c[3][0].data);i.messages.push({meta:c,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(r=s[3])!=null&&r[0]&&(i.merge=Xe(s[3][0].data)>>>0>0),t.push(i)}return t}function J_(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=za(r,t),n=[];t[0]<r.length;){var s=r[t[0]]&3;if(s==0){var i=r[t[0]++]>>2;if(i<60)++i;else{var o=i-59;i=r[t[0]],o>1&&(i|=r[t[0]+1]<<8),o>2&&(i|=r[t[0]+2]<<16),o>3&&(i|=r[t[0]+3]<<24),i>>>=0,i++,t[0]+=o}n.push(r.slice(t[0],t[0]+i)),t[0]+=i;continue}else{var c=0,l=0;if(s==1?(l=(r[t[0]]>>2&7)+4,c=(r[t[0]++]&224)<<3,c|=r[t[0]++]):(l=(r[t[0]++]>>2)+1,s==2?(c=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(c=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),n=[Ns(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(n.push(n[0].slice(-c)),l-=c;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-c,-c+l))}}var u=Ns(n);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Z_(e){for(var r=[],t=0;t<e.length;){var a=e[t++],n=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(J_(a,e.slice(t,t+n))),t+=n}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Ns(r)}function Q_(e,r,t,a){var n=ci(e),s=n.getUint32(4,!0),i=(a>1?12:8)+Go(s&(a>1?3470:398))*4,o=-1,c=-1,l=NaN,u=new Date(2001,0,1);s&512&&(o=n.getUint32(i,!0),i+=4),i+=Go(s&(a>1?12288:4096))*4,s&16&&(c=n.getUint32(i,!0),i+=4),s&32&&(l=n.getFloat64(i,!0),i+=8),s&64&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:r[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:t[o]};else if(c>-1)f={t:"s",v:r[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function ew(e,r,t){var a=ci(e),n=a.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,l=NaN,u=new Date(2001,0,1);n&1&&(c=X_(e,s),s+=16),n&2&&(l=a.getFloat64(s,!0),s+=8),n&4&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(o=a.getUint32(s,!0),s+=4),n&16&&(i=a.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:r[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:t[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function rw(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return Q_(e,r,t,e[0]);case 5:return ew(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function pt(e){var r=or(e);return za(r[1][0].data)}function Ko(e,r){var t=or(r.data),a=Xe(t[1][0].data),n=t[3],s=[];return(n||[]).forEach(function(i){var o=or(i.data),c=Xe(o[1][0].data)>>>0;switch(a){case 1:s[c]=Ps(o[3][0].data);break;case 8:{var l=e[pt(o[9][0].data)][0],u=or(l.data),f=e[pt(u[1][0].data)][0],h=Xe(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var d=or(f.data);s[c]=d[3].map(function(x){return Ps(x.data)}).join("")}break}}),s}function tw(e,r){var t,a,n,s,i,o,c,l,u,f,h,d,x,p,g=or(e),_=Xe(g[1][0].data)>>>0,E=Xe(g[2][0].data)>>>0,v=((a=(t=g[8])==null?void 0:t[0])==null?void 0:a.data)&&Xe(g[8][0].data)>0||!1,O,F;if((s=(n=g[7])==null?void 0:n[0])!=null&&s.data&&r!=0)O=(o=(i=g[7])==null?void 0:i[0])==null?void 0:o.data,F=(l=(c=g[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&r!=1)O=(d=(h=g[4])==null?void 0:h[0])==null?void 0:d.data,F=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var R=v?4:1,k=ci(O),L=[],I=0;I<O.length/2;++I){var G=k.getUint16(I*2,!0);G<65535&&L.push([I,G])}if(L.length!=E)throw"Expected ".concat(E," cells, found ").concat(L.length);var W=[];for(I=0;I<L.length-1;++I)W[L[I][0]]=F.subarray(L[I][1]*R,L[I+1][1]*R);return L.length>=1&&(W[L[L.length-1][0]]=F.subarray(L[L.length-1][1]*R)),{R:_,cells:W}}function aw(e,r){var t,a=or(r.data),n=(t=a==null?void 0:a[7])!=null&&t[0]?Xe(a[7][0].data)>>>0>0?1:0:-1,s=li(a[5],function(i){return tw(i,n)});return{nrows:Xe(a[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,l){if(i[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));i[o.R][l]=c}),i},[])}}function nw(e,r,t){var a,n=or(r.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Xe(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(Xe(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));t["!ref"]=Ee(s);var i=or(n[4][0].data),o=Ko(e,e[pt(i[4][0].data)][0]),c=(a=i[17])!=null&&a[0]?Ko(e,e[pt(i[17][0].data)][0]):[],l=or(i[3][0].data),u=0;l[1].forEach(function(f){var h=or(f.data),d=e[pt(h[2][0].data)][0],x=Xe(d.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=aw(e,d);p.data.forEach(function(g,_){g.forEach(function(E,v){var O=xe({r:u+_,c:v}),F=rw(E,o,c);F&&(t[O]=F)})}),u+=p.nrows})}function sw(e,r){var t=or(r.data),a={"!ref":"A1"},n=e[pt(t[2][0].data)],s=Xe(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return nw(e,n[0],a),a}function iw(e,r){var t,a=or(r.data),n={name:(t=a[1])!=null&&t[0]?Ps(a[1][0].data):"",sheets:[]},s=li(a[2],pt);return s.forEach(function(i){e[i].forEach(function(o){var c=Xe(o.meta[1][0].data);c==6e3&&n.sheets.push(sw(e,o))})}),n}function ow(e,r){var t=hi(),a=or(r.data),n=li(a[1],pt);if(n.forEach(function(s){e[s].forEach(function(i){var o=Xe(i.meta[1][0].data);if(o==2){var c=iw(e,i);c.sheets.forEach(function(l,u){di(t,l,u==0?c.name:c.name+"_"+u,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function hs(e){var r,t,a,n,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=Z_(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=Y_(l)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((n=(a=(t=(r=s==null?void 0:s[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Xe(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(l){var u=Xe(l.meta[1][0].data)>>>0;if(u==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return ow(s,o)}function cw(e){return function(t){for(var a=0;a!=e.length;++a){var n=e[a];t[n[0]]===void 0&&(t[n[0]]=n[1]),n[2]==="n"&&(t[n[0]]=Number(t[n[0]]))}}}function ui(e){cw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function lw(e){return ea.WS.indexOf(e)>-1?"sheet":e==ea.CS?"chart":e==ea.DS?"dialog":e==ea.MS?"macro":e&&e.length?e:"sheet"}function uw(e,r){if(!e)return 0;try{e=r.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,lw(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function fw(e,r,t,a,n,s,i,o,c,l,u,f){try{s[a]=Ca(Tr(e,t,!0),r);var h=He(e,r),d;switch(o){case"sheet":d=v_(h,r,n,c,s[a],l,u,f);break;case"chart":if(d=m_(h,r,n,c,s[a],l,u,f),!d||!d["!drawel"])break;var x=ya(d["!drawel"].Target,r),p=Os(x),g=gg(Tr(e,x,!0),Ca(Tr(e,p,!0),x)),_=ya(g,x),E=Os(_);d=e_(Tr(e,_,!0),_,c,Ca(Tr(e,E,!0),_),l,d);break;case"macro":d=__(h,r,n,c,s[a],l,u,f);break;case"dialog":d=w_(h,r,n,c,s[a],l,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=d;var v=[];s&&s[a]&&qr(s[a]).forEach(function(O){var F="";if(s[a][O].Type==ea.CMNT){F=ya(s[a][O].Target,r);var R=k_(He(e,F,!0),F,c);if(!R||!R.length)return;Fo(d,R,!1)}s[a][O].Type==ea.TCMNT&&(F=ya(s[a][O].Target,r),v=v.concat(mg(He(e,F,!0),c)))}),v&&v.length&&Fo(d,v,!0,c.people||[])}catch(O){if(c.WTF)throw O}}function br(e){return e.charAt(0)=="/"?e.slice(1):e}function hw(e,r){if(Lc(),r=r||{},ui(r),Or(e,"META-INF/manifest.xml")||Or(e,"objectdata.xml"))return Wo(e,r);if(Or(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof hs<"u"){if(e.FileIndex)return hs(e);var t=ye.utils.cfb_new();return ao(e).forEach(function(ce){dd(t,ce,hd(e,ce))}),hs(t)}throw new Error("Unsupported NUMBERS file")}if(!Or(e,"[Content_Types].xml"))throw Or(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Or(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=ao(e),n=c1(Tr(e,"[Content_Types].xml")),s=!1,i,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",He(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!He(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!r.bookSheets&&!r.bookProps){if(Fa=[],n.sst)try{Fa=T_(He(e,br(n.sst)),n.sst,r)}catch(ce){if(r.WTF)throw ce}r.cellStyles&&n.themes.length&&(c=E_(Tr(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],r)),n.style&&(l=y_(He(e,br(n.style)),n.style,c,r))}n.links.map(function(ce){try{var re=Ca(Tr(e,Os(br(ce))),ce);return S_(He(e,br(ce)),re,ce,r)}catch{}});var u=g_(He(e,br(n.workbooks[0])),n.workbooks[0],r),f={},h="";n.coreprops.length&&(h=He(e,br(n.coreprops[0]),!0),h&&(f=f0(h)),n.extprops.length!==0&&(h=He(e,br(n.extprops[0]),!0),h&&d1(h,f,r)));var d={};(!r.bookSheets||r.bookProps)&&n.custprops.length!==0&&(h=Tr(e,br(n.custprops[0]),!0),h&&(d=x1(h,r)));var x={};if((r.bookSheets||r.bookProps)&&(u.Sheets?i=u.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),r.bookProps&&(x.Props=f,x.Custprops=d),r.bookSheets&&typeof i<"u"&&(x.SheetNames=i),r.bookSheets?x.SheetNames:r.bookProps))return x;i={};var p={};r.bookDeps&&n.calcchain&&(p=A_(He(e,br(n.calcchain)),n.calcchain));var g=0,_={},E,v;{var O=u.Sheets;f.Worksheets=O.length,f.SheetNames=[];for(var F=0;F!=O.length;++F)f.SheetNames[F]=O[F].name}var R=s?"bin":"xml",k=n.workbooks[0].lastIndexOf("/"),L=(n.workbooks[0].slice(0,k+1)+"_rels/"+n.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Or(e,L)||(L="xl/_rels/workbook."+R+".rels");var I=Ca(Tr(e,L,!0),L.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(r.xlmeta=b_(He(e,br(n.metadata[0])),n.metadata[0],r)),(n.people||[]).length>=1&&(r.people=_g(He(e,br(n.people[0])),r)),I&&(I=uw(I,u.Sheets));var G=He(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var W="sheet";if(I&&I[g]?(E="xl/"+I[g][1].replace(/[\/]?xl\//,""),Or(e,E)||(E=I[g][1]),Or(e,E)||(E=L.replace(/_rels\/.*$/,"")+I[g][1]),W=I[g][2]):(E="xl/worksheets/sheet"+(g+1-G)+"."+R,E=E.replace(/sheet0\./,"sheet.")),v=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(g!=r.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var N=!1,X=0;X!=r.sheets.length;++X)typeof r.sheets[X]=="number"&&r.sheets[X]==g&&(N=1),typeof r.sheets[X]=="string"&&r.sheets[X].toLowerCase()==f.SheetNames[g].toLowerCase()&&(N=1);if(!N)continue e}}fw(e,E,v,f.SheetNames[g],g,_,i,W,r,u,c,l)}return x={Directory:n,Workbook:u,Props:f,Custprops:d,Deps:p,Sheets:i,SheetNames:f.SheetNames,Strings:Fa,Styles:l,Themes:c,SSF:rr(ve)},r&&r.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ce,re){ce=ce.replace(/^Root Entry[\/]/,""),x.keys.push(ce),x.files[ce]=e.FileIndex[re]}))),r&&r.bookVBA&&(n.vba.length>0?x.vbaraw=He(e,br(n.vba[0]),!0):n.defaults&&n.defaults.bin===Tg&&(x.vbaraw=He(e,"xl/vbaProject.bin",!0))),x}function dw(e,r){var t=r||{},a="Workbook",n=ye.find(e,a);try{if(a="/!DataSpaces/Version",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(sx(n.content),a="/!DataSpaces/DataSpaceMap",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=ox(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=cx(n.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);ux(n.content)}catch{}if(a="/EncryptionInfo",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=fx(n.content);if(a="/EncryptedPackage",n=ye.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,t.password||"",t);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,t.password||"",t);throw new Error("File is password-protected")}function fi(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=kr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function pw(e,r){return ye.find(e,"EncryptedPackage")?dw(e,r):X0(e,r)}function xw(e,r){var t,a=e,n=r||{};return n.type||(n.type=we&&Buffer.isBuffer(e)?"buffer":"base64"),t=Hc(a,n),hw(t,n)}function Q0(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Is(e.slice(t),r);default:break e}return Ga.to_workbook(e,r)}function gw(e,r){var t="",a=fi(e,r);switch(r.type){case"base64":t=kr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Pt(e);break;default:throw new Error("Unrecognized type "+r.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(t=Oe(t)),r.type="binary",Q0(t,r)}function vw(e,r){var t=e;return r.type=="base64"&&(t=kr(t)),t=ja.utils.decode(1200,t.slice(2),"str"),r.type="binary",Q0(t,r)}function mw(e){return e.match(/[^\x00-\x7F]/)?Ea(e):e}function ds(e,r,t,a){return a?(t.type="string",Ga.to_workbook(e,t)):Ga.to_workbook(r,t)}function Ls(e,r){kc();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ls(new Uint8Array(e),(t=rr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),na={},t.dateNF&&(na.dateNF=t.dateNF),t.type||(t.type=we&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=we?"buffer":"binary",a=sd(e),typeof Uint8Array<"u"&&!we&&(t.type="array")),t.type=="string"&&(s=!0,t.type="binary",t.codepage=65001,a=mw(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return t=rr(t),t.type="array",Ls(Ws(a),t)}switch((n=fi(a,t))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return pw(ye.read(a,t),t);break;case 9:if(n[1]<=8)return X0(a,t);break;case 60:return Is(a,t);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return Kp(a,t);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return Vp.to_workbook(a,t);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?xw(a,t):ds(e,a,t,s);case 239:return n[3]===60?Is(a,t):ds(e,a,t,s);case 255:if(n[1]===254)return vw(a,t);if(n[1]===0&&n[2]===2&&n[3]===0)return Ra.to_workbook(a,t);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Ra.to_workbook(a,t);break;case 3:case 131:case 139:case 140:return Ro.to_workbook(a,t);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Tx.to_workbook(a,t);break;case 10:case 13:case 32:return gw(a,t);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Hp.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Ro.to_workbook(a,t):ds(e,a,t,s)}function _w(e,r,t,a,n,s,i,o){var c=tr(t),l=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch{h.__rowNum__=t}else h.__rowNum__=t;if(!i||e[t])for(var d=r.s.c;d<=r.e.c;++d){var x=i?e[t][d]:e[a[d]+c];if(x===void 0||x.t===void 0){if(l===void 0)continue;s[d]!=null&&(h[s[d]]=l);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(s[d]!=null){if(p==null)if(x.t=="e"&&p===null)h[s[d]]=null;else if(l!==void 0)h[s[d]]=l;else if(u&&p===null)h[s[d]]=null;else continue;else h[s[d]]=u&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:at(x,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Bs(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},a=0,n=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=r||{},u=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof u){case"string":c=Le(u);break;case"number":c=Le(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(n=0);var f=tr(c.s.r),h=[],d=[],x=0,p=0,g=Array.isArray(e),_=c.s.r,E=0,v={};g&&!e[_]&&(e[_]=[]);var O=l.skipHidden&&e["!cols"]||[],F=l.skipHidden&&e["!rows"]||[];for(E=c.s.c;E<=c.e.c;++E)if(!(O[E]||{}).hidden)switch(h[E]=ze(E),t=g?e[_][E]:e[h[E]+f],a){case 1:s[E]=E-c.s.c;break;case 2:s[E]=h[E];break;case 3:s[E]=l.header[E-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),o=i=at(t,null,l),p=v[i]||0,!p)v[i]=1;else{do o=i+"_"+p++;while(v[o]);v[i]=p,v[o]=1}s[E]=o}for(_=c.s.r+n;_<=c.e.r;++_)if(!(F[_]||{}).hidden){var R=_w(e,c,_,h,a,s,g,l);(R.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(d[x++]=R.row)}return d.length=x,d}var qo=/"/g;function ww(e,r,t,a,n,s,i,o){for(var c=!0,l=[],u="",f=tr(t),h=r.s.c;h<=r.e.c;++h)if(a[h]){var d=o.dense?(e[t]||[])[h]:e[a[h]+f];if(d==null)u="";else if(d.v!=null){c=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:at(d,null,o));for(var x=0,p=0;x!==u.length;++x)if((p=u.charCodeAt(x))===n||p===s||p===34||o.forceQuotes){u='"'+u.replace(qo,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(c=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(qo,'""')+'"')):u="";l.push(u)}return o.blankrows===!1&&c?null:l.join(i)}function el(e,r){var t=[],a=r??{};if(e==null||e["!ref"]==null)return"";var n=Le(e["!ref"]),s=a.FS!==void 0?a.FS:",",i=s.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],d=a.skipHidden&&e["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(f[x]=ze(x));for(var p=0,g=n.s.r;g<=n.e.r;++g)(d[g]||{}).hidden||(u=ww(e,n,g,f,i,c,s,a),u!=null&&(a.strip&&(u=u.replace(l,"")),(u||a.blankrows!==!1)&&t.push((p++?o:"")+u)));return delete a.dense,t.join("")}function yw(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=el(e,r);return t}function Ew(e){var r="",t,a="";if(e==null||e["!ref"]==null)return[];var n=Le(e["!ref"]),s="",i=[],o,c=[],l=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)i[o]=ze(o);for(var u=n.s.r;u<=n.e.r;++u)for(s=tr(u),o=n.s.c;o<=n.e.c;++o)if(r=i[o]+s,t=l?(e[u]||[])[o]:e[r],a="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;a=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}c[c.length]=r+"="+a}return c}function rl(e,r,t){var a=t||{},n=+!a.skipHeader,s=e||{},i=0,o=0;if(s&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var c=typeof a.origin=="string"?xr(a.origin):a.origin;i=c.r,o=c.c}var l,u={s:{c:0,r:0},e:{c:o,r:i+r.length-1+n}};if(s["!ref"]){var f=Le(s["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(i=f.e.r+1,u.e.r=i+r.length-1+n)}else i==-1&&(i=0,u.e.r=r.length-1+n);var h=a.header||[],d=0;r.forEach(function(p,g){qr(p).forEach(function(_){(d=h.indexOf(_))==-1&&(h[d=h.length]=_);var E=p[_],v="z",O="",F=xe({c:o+d,r:i+g+n});l=Xa(s,F),E&&typeof E=="object"&&!(E instanceof Date)?s[F]=E:(typeof E=="number"?v="n":typeof E=="boolean"?v="b":typeof E=="string"?v="s":E instanceof Date?(v="d",a.cellDates||(v="n",E=vr(E)),O=a.dateNF||ve[14]):E===null&&a.nullError&&(v="e",E=0),l?(l.t=v,l.v=E,delete l.w,delete l.R,O&&(l.z=O)):s[F]=l={t:v,v:E},O&&(l.z=O))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var x=tr(i);if(n)for(d=0;d<h.length;++d)s[ze(d+o)+x]={t:"s",v:h[d]};return s["!ref"]=Ee(u),s}function Tw(e,r){return rl(null,e,r)}function Xa(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var a=xr(r);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Xa(e,xe(r)):Xa(e,xe({r,c:t||0}))}function kw(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function hi(){return{SheetNames:[],Sheets:{}}}function di(e,r,t,a){var n=1;if(!t)for(;n<=65535&&e.SheetNames.indexOf(t="Sheet"+n)!=-1;++n,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var s=t.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var i=s&&s[1]||t;for(++n;n<=65535&&e.SheetNames.indexOf(t=i+n)!=-1;++n);}if(c_(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function Aw(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=kw(e,r);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t}function Sw(e,r){return e.z=r,e}function tl(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function bw(e,r,t){return tl(e,"#"+r,t)}function Cw(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function Ow(e,r,t,a){for(var n=typeof r!="string"?r:Le(r),s=typeof r=="string"?r:Ee(r),i=n.s.r;i<=n.e.r;++i)for(var o=n.s.c;o<=n.e.c;++o){var c=Xa(e,i,o);c.t="n",c.F=s,delete c.v,i==n.s.r&&o==n.s.c&&(c.f=t,a&&(c.D=!0))}return e}var Rw={encode_col:ze,encode_row:tr,encode_cell:xe,encode_range:Ee,decode_col:Zs,decode_row:Js,split_cell:jd,decode_cell:xr,decode_range:la,format_cell:at,sheet_add_aoa:i0,sheet_add_json:rl,sheet_add_dom:Y0,aoa_to_sheet:ua,json_to_sheet:Tw,table_to_sheet:J0,table_to_book:K_,sheet_to_csv:el,sheet_to_txt:yw,sheet_to_json:Bs,sheet_to_html:G_,sheet_to_formulae:Ew,sheet_to_row_object_array:Bs,sheet_get_cell:Xa,book_new:hi,book_append_sheet:di,book_set_sheet_visibility:Aw,cell_set_number_format:Sw,cell_set_hyperlink:tl,cell_set_internal_link:bw,cell_add_comment:Cw,sheet_set_array_formula:Ow,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};async function Fw(e){if(!e.url)return null;try{switch(e.type){case"excel":return await Iw(e.url);default:return null}}catch(r){return console.warn(`[ApprovalGraph] Attachment extraction failed for ${e.name}:`,r),null}}async function Iw(e){const r=await fetch(e);if(!r.ok)return null;const t=await r.arrayBuffer(),a=Ls(t,{type:"array"}),n=[];for(const s of a.SheetNames){const i=a.Sheets[s],o=Rw.sheet_to_csv(i);o.trim()&&n.push(`[: ${s}]
${o}`)}return n.length>0?n.join(`

`):null}async function Dw(e){const r=[];for(const t of e){const a=await Fw(t);a&&r.push({name:t.name,content:a})}return r}function Pw(e,r){if(r<=0)return"WARN";const t=e/r;return t>=.8?"PASS":t>=.4?"WARN":"FAIL"}function Nw(e){const r=e.map(n=>typeof n.weight=="number"&&n.weight>0?n.weight:20),t=r.reduce((n,s)=>n+s,0);let a;if(t!==100&&t>0){a=r.map(s=>Math.round(s*100/t));const n=100-a.reduce((s,i)=>s+i,0);if(n!==0){const s=a.indexOf(Math.max(...a));a[s]+=n}}else a=r;return e.map((n,s)=>{const i=a[s],o=typeof n.score=="number"?n.score:-1,c=["PASS","WARN","FAIL"].includes(n.result)?n.result:"WARN",l=o>=0?Math.min(Math.round(o),i):c==="PASS"?i:c==="WARN"?Math.round(i*.5):0,u=Pw(l,i),f=Array.isArray(n.evidence_refs)?n.evidence_refs.filter(h=>typeof h=="string"&&h.length>0):[];return{item:n.item,result:u,detail:n.detail,weight:i,score:l,evidence_refs:f}})}function Lw(){return`local-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}async function Bw(e,r){var h,d,x,p,g;r(1,va[0].label);let t;try{t=(await Qf(e)).id}catch(_){console.warn("[ApprovalGraph] Supabase save skipped:",_),t=Lw()}r(2,va[1].label);let a=[],n=[];try{n=Mw(e),a=await rh(n,t)}catch(_){console.warn("[ApprovalGraph] Similar doc search failed:",_)}r(3,va[2].label);let s;try{let _=[];try{_=await th()}catch{}let E=[];try{const O=await((d=(h=chrome==null?void 0:chrome.storage)==null?void 0:h.local)==null?void 0:d.get("feedback_rules"));E=(O==null?void 0:O.feedback_rules)??[]}catch{}let v=[];try{e.attachments&&e.attachments.length>0&&(v=await Dw(e.attachments))}catch{}s=await Ch(e,a,_,v,E)}catch(_){const E=_ instanceof Error?_.message:String(_);throw new Error(`AI  : ${E}`)}r(4,va[3].label);try{await eh(t,{summary:s.summary,coherence:s.coherence,recommendation:s.recommendation,topics:s.topics,similar_docs_insight:s.similar_docs_insight})}catch(_){console.warn("[ApprovalGraph] Document analysis update failed:",_)}const i=a.map(_=>({..._,insight:s.similar_docs_insight||""}));let c=(Array.isArray(s.causal_chains)?s.causal_chains:[]).filter(_=>(_==null?void 0:_.keyword)&&Array.isArray(_==null?void 0:_.chain)&&_.chain.length>=2).map(_=>({keyword:String(_.keyword),chain:_.chain.map(String),kpis:Array.isArray(_.kpis)?_.kpis.map(String):[],impact:["high","medium","low"].includes(_.impact)?_.impact:"medium"}));const l=Uw(s.value_hierarchy);c.length===0&&l&&l.valueChain.length>=2&&(c=[{keyword:l.valueChain[0],chain:l.valueChain,kpis:l.kpis.map(_=>_.name),impact:l.impactScore}]);const u=Array.isArray(s.predicted_questions)?s.predicted_questions.filter(_=>typeof _=="string").slice(0,3):[];return{docId:t,summary:{request:((x=s.summary)==null?void 0:x.request)||"",basis:((p=s.summary)==null?void 0:p.basis)||"",expected_effect:((g=s.summary)==null?void 0:g.expected_effect)||""},coherence:(()=>{var O;const _=Array.isArray((O=s.coherence)==null?void 0:O.checks)?s.coherence.checks:[],E=Nw(_),v=E.reduce((F,R)=>F+R.score,0);return{overall_score:Math.round(v),checks:E}})(),similarDocs:i,recommendation:s.recommendation||"",topics:Array.isArray(s.topics)?s.topics:n,causalChains:c,valueHierarchy:l,analyzedAt:new Date().toISOString(),predictedQuestions:u}}function Mw(e){const r=[];if(e.doc_type&&r.push(e.doc_type.trim()),e.subject){const t=e.subject.replace(/[^\uAC00-\uD7A3a-zA-Z0-9\s]/g," ").split(/\s+/).filter(a=>a.length>=2);r.push(...t.slice(0,3))}return e.requester_dept&&r.push(e.requester_dept.trim()),[...new Set(r)].slice(0,5)}function Uw(e){if(!e||typeof e!="object"||!e.business_goal||!Array.isArray(e.value_chain)||e.value_chain.length<2)return null;const r=Array.isArray(e.kpis)?e.kpis.filter(t=>t==null?void 0:t.name).map(t=>({name:String(t.name),current:String(t.current||""),target:String(t.target||""),relevance:["high","medium","low"].includes(t.relevance)?t.relevance:"medium"})):[];return{businessGoal:String(e.business_goal),goalDescription:String(e.goal_description||""),kpis:r,valueChain:e.value_chain.map(String),impactScore:["high","medium","low"].includes(e.impact_score)?e.impact_score:"medium"}}function $w(){return`       ,    .
  ${new Date().toISOString().slice(0,10)}.

    
   ,     .
 ,         3~5 .
  (weight)   100 .

[  ]
- : ,   (  )
- :   /  
- :  ()  
- : , ,    
- :     
-  : /   , ,    
-  : //   
-  :  /     

[  ]
- /  ( , ,   ):  , ,   
-  /: , ,  
-  (,  ): , ,  
-  : , ,   

    ( ) 

[    ]
-    "===  ==="  .
-   (, , , , ,  )   .
- "===    ==="    ,   //    .

[   ]
-  (,  ) HTML     .
-    (: '  ', '  ', ' ', ' ', '  ') HTML      .     .
-     .        .
- //         .
-      ( ,  ) .
-        '' ,    .

[   ]
- ()     .      .
-   (, ,  ) /    . : 1  2   .  " "  .
-   :   (: 2 30),     , > 
- "   "   
- "   "   

[   ]
-     "===  ==="  .    .
-  , ,    ""  .
-          .

[       ]
-  "" ,         .
-     ""    .
-        .       .
-  " OO" "OO"  .         .
-  " OO" "()OO"  .      .
- "   "    .   .
-   /         .
- /  (: "OO--2026-0001")       .

[  ]
-  ()   ,      .
-         .
- , ,         .

[  ]
-  FAIL/WARN         .
- detail      '' .
-   :        .
-   : detail "", "", ""   result FAIL/WARN  .     PASS  .

  :
- category:   (  )
- result: "PASS" ( ), "WARN" ( ), "FAIL" ( )
- detail:    .   " "
- weight:    (  weight  = 100)

:
- basis:    (   ) 1~2 
- expected_effect:      1~2 
- predictedQuestions:       3 ()

  JSON  :
{
  "checks": [
    { "category": " ", "result": "PASS|WARN|FAIL", "detail": "", "weight": 30 },
    { "category": " ", "result": "PASS|WARN|FAIL", "detail": "", "weight": 25 },
    { "category": " ", "result": "PASS|WARN|FAIL", "detail": "", "weight": 25 },
    { "category": " ", "result": "PASS|WARN|FAIL", "detail": "", "weight": 20 }
  ],
  "basis": "  ",
  "expected_effect": "  ",
  "predictedQuestions": ["  1", "  2", "  3"]
}`}function jw(e,r=[]){const t=e.approval_line.length>0?e.approval_line.map(i=>`- ${i.name} (${i.position}) [${i.status}]`).join(`
`):"  ",a=e.body&&e.body.trim().length>=20,n=a?e.body:e.rawText?Ms(e.rawText,e.subject):"  ",s=r.length>0?`
===    ( ) ===
     .    .
${r.map(i=>`- ${i.category}: ${i.userMessage}`).join(`
`)}
`:"";return`   .

===   (      ) ===
 : ${e.doc_type||""}
: ${e.subject||""}
: ${e.requester_name||""} (${e.requester_dept||" "})
: ${e.created_at||""}

===  ===
${t}

===  ( ) ===
${n.slice(0,4e3)}

${a&&e.rawText?`===    (   //  ,   ) ===
${e.rawText.slice(0,4e3)}`:""}${s}`}function Hw(e){const r=e.map(a=>typeof a.weight=="number"&&a.weight>0?a.weight:20),t=r.reduce((a,n)=>a+n,0);if(t!==100&&t>0){const a=r.map(s=>Math.round(s*100/t)),n=100-a.reduce((s,i)=>s+i,0);if(n!==0){const s=a.indexOf(Math.max(...a));a[s]+=n}return a}return r}function Ww(e,r){const t=e.result==="PASS"?r:e.result==="WARN"?Math.round(r*.5):0;return{item:e.category,result:e.result,detail:e.detail,weight:r,score:t}}function Vw(){return`lite-${Date.now()}-${Math.random().toString(36).slice(2,9)}`}async function Gw(e,r){var d,x;r(1,xs[0].label);let t=[];try{const p=await((x=(d=chrome==null?void 0:chrome.storage)==null?void 0:d.local)==null?void 0:x.get("feedback_rules"));t=(p==null?void 0:p.feedback_rules)??[]}catch{}const a=jw(e,t);r(2,xs[1].label);let n,s="",i="",o=[];try{const p=await Ja({model:"gpt-4o-mini",messages:[{role:"system",content:$w()},{role:"user",content:a}],max_tokens:2048,temperature:.1,response_format:{type:"json_object"}});let g;try{g=JSON.parse(p)}catch{throw new Error(`Lite  JSON  : ${p.slice(0,200)}`)}if(!Array.isArray(g.checks))throw new Error("Lite   checks  .");n=g.checks.map(_=>({category:typeof _.category=="string"?_.category:"",result:["PASS","WARN","FAIL"].includes(_.result)?_.result:"WARN",detail:typeof _.detail=="string"?_.detail:"",weight:typeof _.weight=="number"&&_.weight>0?_.weight:void 0})),s=typeof g.basis=="string"?g.basis:"",i=typeof g.expected_effect=="string"?g.expected_effect:"",o=Array.isArray(g.predictedQuestions)?g.predictedQuestions.filter(_=>typeof _=="string").slice(0,3):[]}catch(p){const g=p instanceof Error?p.message:String(p);throw new Error(`Lite AI  : ${g}`)}const c=Hw(n),l=n.map((p,g)=>Ww(p,c[g])),u=Math.round(l.reduce((p,g)=>p+g.score,0)),f=n.filter(p=>p.result!=="PASS").length;return{docId:Vw(),mode:"lite",summary:{request:e.subject||"",basis:s,expected_effect:i},coherence:{overall_score:u,checks:l},similarDocs:[],recommendation:f===0?"     .":`${f}   .`,topics:[],causalChains:[],valueHierarchy:null,analyzedAt:new Date().toISOString(),predictedQuestions:o.length>0?o:void 0}}let Tn=null;async function Kw(){var t,a;if(Tn)return Tn;let e=rc,r=tc;try{const n=await((a=(t=chrome==null?void 0:chrome.storage)==null?void 0:t.local)==null?void 0:a.get(["supabaseUrl","supabaseAnonKey"]));n!=null&&n.supabaseUrl&&(e=n.supabaseUrl),n!=null&&n.supabaseAnonKey&&(r=n.supabaseAnonKey)}catch{}if(!e||!r)throw new Error("Supabase URL  Anon Key  .");return Tn=wc(e,r,{auth:{persistSession:!1,autoRefreshToken:!1}}),Tn}const qw="https://www.googleapis.com/oauth2/v3/userinfo",$n="truenorth_user";async function zw(){const e=await al(!0),r=await Yw(e),t=await Jw(r);return await chrome.storage.local.set({[$n]:t}),t}async function zo(){try{return(await chrome.storage.local.get($n))[$n]||null}catch{return null}}async function Xw(){try{const e=await al(!1);e&&(await fetch("https://oauth2.googleapis.com/revoke",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`token=${encodeURIComponent(e)}`}),await chrome.identity.removeCachedAuthToken({token:e}))}catch{}await chrome.storage.local.remove($n)}async function al(e){return new Promise((r,t)=>{chrome.identity.getAuthToken({interactive:e},a=>{if(chrome.runtime.lastError){t(new Error(chrome.runtime.lastError.message||" "));return}if(!a){t(new Error("Google    ."));return}r(a)})})}async function Yw(e){const r=await fetch(qw,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`Google    (${r.status})`);const t=await r.json();return{sub:t.sub,email:t.email,name:t.name||t.email.split("@")[0],picture:t.picture||""}}async function Jw(e){const r=await Kw(),{data:t,error:a}=await r.rpc("upsert_user",{p_google_id:e.sub,p_email:e.email,p_display_name:e.name,p_avatar_url:e.picture});if(a)throw new Error(`  : ${a.message}`);const n=Array.isArray(t)?t[0]:t;if(!n)throw new Error("   .");return{id:n.id,googleId:n.google_id,email:n.email,displayName:n.display_name||e.name,avatarUrl:n.avatar_url||e.picture,plan:n.plan,createdAt:n.created_at,lastLoginAt:n.last_login_at}}async function nl(e,r,t,a){var n,s,i,o,c,l,u;try{const f={id:r.docId||`local-${Date.now()}`,documentId:r.docId,subject:e.subject||"",docType:e.doc_type||"",mode:t,overallScore:((n=r.coherence)==null?void 0:n.overall_score)??null,createdAt:new Date().toISOString(),url:a||"",analysisCount:1},h=await((i=(s=chrome==null?void 0:chrome.storage)==null?void 0:s.local)==null?void 0:i.get("career_history")),d=(h==null?void 0:h.career_history)??[],x=a?d.findIndex(F=>F.url&&F.url===a):-1;let p;if(x>=0){const F=d[x];p=F.id,d[x]={...f,id:F.id,analysisCount:(F.analysisCount||1)+1}}else p=f.id,d.push(f);const g=d.slice(-200);await((c=(o=chrome==null?void 0:chrome.storage)==null?void 0:o.local)==null?void 0:c.set({career_history:g}));const _=`analysis_detail_${p}`,{bodyImages:E,...v}=e,O={id:p,analysisResult:r,parsedDocument:v,savedAt:new Date().toISOString()};await((u=(l=chrome==null?void 0:chrome.storage)==null?void 0:l.local)==null?void 0:u.set({[_]:O})),await Zw(p)}catch{}}async function Zw(e){var r,t,a,n,s,i;try{const o=await((t=(r=chrome==null?void 0:chrome.storage)==null?void 0:r.local)==null?void 0:t.get("analysis_detail_index")),c=(o==null?void 0:o.analysis_detail_index)??[];if(c.push({id:e,savedAt:new Date().toISOString()}),c.length>50){const l=c.splice(0,c.length-50);await((n=(a=chrome==null?void 0:chrome.storage)==null?void 0:a.local)==null?void 0:n.remove(l.map(u=>`analysis_detail_${u.id}`)))}await((i=(s=chrome==null?void 0:chrome.storage)==null?void 0:s.local)==null?void 0:i.set({analysis_detail_index:c}))}catch{}}let Kr=null,St=null,Ft=null,Mr=null,kn="pro";var An,Yo;try{(Yo=(An=chrome==null?void 0:chrome.sidePanel)==null?void 0:An.setPanelBehavior)==null||Yo.call(An,{openPanelOnActionClick:!0})}catch{}var Jo,Zo;(Zo=(Jo=chrome==null?void 0:chrome.action)==null?void 0:Jo.onClicked)==null||Zo.addListener(async e=>{try{e.id&&await chrome.sidePanel.open({tabId:e.id})}catch{}});function Se(e){var r,t;try{(t=(r=chrome==null?void 0:chrome.runtime)==null?void 0:r.sendMessage)==null||t.call(r,e).catch(()=>{})}catch{}}async function It(e){try{const[r]=await chrome.tabs.query({active:!0,currentWindow:!0});r!=null&&r.id&&chrome.tabs.sendMessage(r.id,e).catch(()=>{})}catch{}}function Qw(e,r){Se({type:"ANALYSIS_PROGRESS",payload:{step:e,total:va.length,message:r}})}function ey(e,r){Se({type:"ANALYSIS_PROGRESS",payload:{step:e,total:xs.length,message:r}})}async function Xo(e){if(Ft)return;Kr=e,Se({type:"ANALYSIS_START",payload:{docId:""}}),Ft=(async()=>{try{const t=await Gw(e,ey);St=t,await nl(e,t,"lite",Mr==null?void 0:Mr.url),Se({type:"ANALYSIS_RESULT",payload:t}),await It({type:"ANALYSIS_COMPLETE",payload:t})}catch(t){const a=t instanceof Error?t.message:String(t);Se({type:"ANALYSIS_ERROR",payload:{message:a,code:"LITE_ANALYSIS_FAILED"}}),await It({type:"ERROR",payload:{message:a,code:"LITE_ANALYSIS_FAILED"}})}finally{Ft=null}})()}async function ps(e){if(Ft)return;Kr=e,Se({type:"ANALYSIS_START",payload:{docId:""}}),Ft=(async()=>{try{const t=await Bw(e,Qw);St=t,await nl(e,t,"pro",Mr==null?void 0:Mr.url),Se({type:"ANALYSIS_RESULT",payload:t}),await It({type:"ANALYSIS_COMPLETE",payload:t})}catch(t){const a=t instanceof Error?t.message:String(t);Se({type:"ANALYSIS_ERROR",payload:{message:a,code:"ANALYSIS_FAILED"}}),await It({type:"ERROR",payload:{message:a,code:"ANALYSIS_FAILED"}})}finally{Ft=null}})()}var Qo,ec;(ec=(Qo=chrome==null?void 0:chrome.runtime)==null?void 0:Qo.onMessage)==null||ec.addListener((e,r,t)=>{if(!e||!e.type)return!1;switch(e.type){case"DOM_HASH":{const{hash:a,groupware:n,domHtml:s}=e.payload;return(async()=>{var i,o,c;try{const l=await hh(a,n);if(l){(i=r.tab)!=null&&i.id&&chrome.tabs.sendMessage(r.tab.id,{type:"PARSE_RULE",payload:l});return}const u=await Ah(s);await dh(a,n,u),(o=r.tab)!=null&&o.id&&chrome.tabs.sendMessage(r.tab.id,{type:"PARSE_RULE",payload:u})}catch(l){const u=l instanceof Error?l.message:String(l);(c=r.tab)!=null&&c.id&&chrome.tabs.sendMessage(r.tab.id,{type:"ERROR",payload:{message:`   : ${u}`,code:"PARSE_RULE_FAILED"}})}})(),!0}case"DOM_PARSED":{const a=e.payload;return kn==="lite"?Xo(a):ps(a),kn="pro",!0}case"PAGE_DETECTED":{const a=e.payload;return Mr=a,Kr=null,St=null,Se({type:"PAGE_READY",payload:a}),!1}case"REQUEST_ANALYSIS":return Kr?ps(Kr):St?Se({type:"ANALYSIS_RESULT",payload:St}):Mr?(kn="pro",It({type:"START_PARSE",payload:null})):Se({type:"ANALYSIS_ERROR",payload:{message:"  .    .",code:"NO_DOCUMENT"}}),!0;case"REQUEST_LITE_ANALYSIS":return Kr?Xo(Kr):Mr?(kn="lite",It({type:"START_PARSE",payload:null})):Se({type:"ANALYSIS_ERROR",payload:{message:"  .    .",code:"NO_DOCUMENT"}}),!0;case"RETRY_ANALYSIS":return Kr?ps(Kr):Se({type:"ANALYSIS_ERROR",payload:{message:"  .    .",code:"NO_DOCUMENT"}}),!0;case"GET_STATUS":return Ft?t({status:"analyzing"}):St?(Se({type:"ANALYSIS_RESULT",payload:St}),t({status:"complete"})):Kr?t({status:"ready"}):Mr?(Se({type:"PAGE_READY",payload:Mr}),t({status:"page_detected"})):t({status:"idle"}),!0;case"HIGHLIGHT_TEXT":case"CLEAR_HIGHLIGHTS":case"SCROLL_TO_HIGHLIGHT":case"SHOW_CHECK_CONNECTION":case"TOGGLE_HIGHLIGHTS":return It(e),!1;case"SIGN_IN":return(async()=>{try{const a=await zw();Se({type:"AUTH_STATE",payload:{user:a}});try{const n=await Wi(a.id);Se({type:"USAGE_INFO",payload:n})}catch{}}catch(a){const n=a instanceof Error?a.message:String(a);Se({type:"ANALYSIS_ERROR",payload:{message:` : ${n}`,code:"AUTH_FAILED"}})}})(),!0;case"SIGN_OUT":return(async()=>{try{await Xw(),Se({type:"AUTH_STATE",payload:{user:null}})}catch{}})(),!0;case"GET_AUTH_STATE":return(async()=>{try{const a=await zo();Se({type:"AUTH_STATE",payload:{user:a}})}catch{Se({type:"AUTH_STATE",payload:{user:null}})}})(),!0;case"GET_USAGE_INFO":return(async()=>{try{const a=await zo();if(a){const n=await Wi(a.id);Se({type:"USAGE_INFO",payload:n})}}catch{}})(),!0;case"CAREER_SYNC_GOALS":{const{userId:a}=e.payload;return(async()=>{try{const n=await sh(a);Se({type:"CAREER_GOALS_DATA",payload:{goals:n}})}catch{}})(),!0}case"CAREER_UPSERT_GOAL":{const{userId:a,goal:n}=e.payload;return(async()=>{try{await ih(a,n)}catch{}})(),!0}case"CAREER_DELETE_GOAL":{const{goalId:a}=e.payload;return(async()=>{try{await oh(a)}catch{}})(),!0}case"CAREER_SYNC_HISTORY":{const{userId:a}=e.payload;return(async()=>{try{const n=await ch(a);Se({type:"CAREER_HISTORY_DATA",payload:{history:n}})}catch{}})(),!0}case"GET_ANALYSIS_DETAIL":{const{historyId:a}=e.payload;return(async()=>{var n,s;try{const i=`analysis_detail_${a}`,o=await((s=(n=chrome==null?void 0:chrome.storage)==null?void 0:n.local)==null?void 0:s.get(i));Se({type:"ANALYSIS_DETAIL_RESULT",payload:{detail:(o==null?void 0:o[i])??null}})}catch{Se({type:"ANALYSIS_DETAIL_RESULT",payload:{detail:null}})}})(),!0}case"DELETE_HISTORY_ENTRY":{const{historyId:a}=e.payload;return(async()=>{var n,s,i,o,c,l,u,f,h,d;try{const x=await((s=(n=chrome==null?void 0:chrome.storage)==null?void 0:n.local)==null?void 0:s.get("career_history")),g=((x==null?void 0:x.career_history)??[]).filter(v=>v.id!==a);await((o=(i=chrome==null?void 0:chrome.storage)==null?void 0:i.local)==null?void 0:o.set({career_history:g})),await((l=(c=chrome==null?void 0:chrome.storage)==null?void 0:c.local)==null?void 0:l.remove(`analysis_detail_${a}`));const _=await((f=(u=chrome==null?void 0:chrome.storage)==null?void 0:u.local)==null?void 0:f.get("analysis_detail_index")),E=(_==null?void 0:_.analysis_detail_index)??[];await((d=(h=chrome==null?void 0:chrome.storage)==null?void 0:h.local)==null?void 0:d.set({analysis_detail_index:E.filter(v=>v.id!==a)}))}catch{}})(),!0}case"GENERATE_CAREER_DOCUMENT":{const{history:a,prompt:n}=e.payload;return(async()=>{try{const s=`     .
     ,        .

 :
-  (,  )  .    .
- ,         .
-   "  -    -  "  .

  ():
    
  -        
  -      

     
  -       
  -       

:
1.      
2.        /  
3.       
4.  
5.   (, , ,  )  .   .
6.     .
7.        (: "  " X  "  " O)`,o=`     :

${a.map(l=>{var u;return`- [${l.docType||""}] ${l.subject} (${l.mode}, : ${l.overallScore??"N/A"}, ${(u=l.createdAt)==null?void 0:u.slice(0,10)})`}).join(`
`)}

${n?` : ${n}`:"        ."}`,c=await Ja({model:"gpt-4o",messages:[{role:"system",content:s},{role:"user",content:o}],max_tokens:3e3,temperature:.4});Se({type:"CAREER_DOCUMENT_RESULT",payload:{content:c}})}catch(s){Se({type:"CAREER_DOCUMENT_ERROR",payload:{message:s instanceof Error?s.message:String(s)}})}})(),!0}case"SAVE_CAREER_DOCUMENT":{const{document:a}=e.payload;return(async()=>{var n,s,i,o,c,l;try{const u=await((s=(n=chrome==null?void 0:chrome.storage)==null?void 0:n.local)==null?void 0:s.get("career_documents")),f=(u==null?void 0:u.career_documents)??[];f.some(p=>p.id===a.id)||f.push(a);const h=f.slice(-50);await((o=(i=chrome==null?void 0:chrome.storage)==null?void 0:i.local)==null?void 0:o.set({career_documents:h})),Se({type:"CAREER_DOCUMENTS_DATA",payload:{documents:h}});const d=await((l=(c=chrome==null?void 0:chrome.storage)==null?void 0:c.local)==null?void 0:l.get("current_user_id")),x=d==null?void 0:d.current_user_id;x&&await lh(x,a)}catch{}})(),!0}case"DELETE_CAREER_DOCUMENT":{const{docId:a}=e.payload;return(async()=>{var n,s,i,o;try{const c=await((s=(n=chrome==null?void 0:chrome.storage)==null?void 0:n.local)==null?void 0:s.get("career_documents")),u=((c==null?void 0:c.career_documents)??[]).filter(f=>f.id!==a);await((o=(i=chrome==null?void 0:chrome.storage)==null?void 0:i.local)==null?void 0:o.set({career_documents:u})),Se({type:"CAREER_DOCUMENTS_DATA",payload:{documents:u}}),await fh(a)}catch{}})(),!0}case"LOAD_CAREER_DOCUMENTS":return(async()=>{var a,n,s,i,o,c;try{const l=await((n=(a=chrome==null?void 0:chrome.storage)==null?void 0:a.local)==null?void 0:n.get("career_documents")),u=(l==null?void 0:l.career_documents)??[];Se({type:"CAREER_DOCUMENTS_DATA",payload:{documents:u}});const f=await((i=(s=chrome==null?void 0:chrome.storage)==null?void 0:s.local)==null?void 0:i.get("current_user_id")),h=f==null?void 0:f.current_user_id;if(h){const d=await uh(h);if(d.length>0){const x=new Set(d.map(_=>_.id)),p=u.filter(_=>!x.has(_.id)),g=[...d,...p];await((c=(o=chrome==null?void 0:chrome.storage)==null?void 0:o.local)==null?void 0:c.set({career_documents:g})),Se({type:"CAREER_DOCUMENTS_DATA",payload:{documents:g}})}}}catch{}})(),!0;case"SUBMIT_FEEDBACK":{const{category:a,originalDetail:n,userMessage:s}=e.payload;return(async()=>{var i,o,c,l;try{const u=await((o=(i=chrome==null?void 0:chrome.storage)==null?void 0:i.local)==null?void 0:o.get("feedback_rules")),f=(u==null?void 0:u.feedback_rules)??[];f.push({id:`fb-${Date.now()}`,category:a,originalDetail:n,userMessage:s,createdAt:new Date().toISOString()}),await((l=(c=chrome==null?void 0:chrome.storage)==null?void 0:c.local)==null?void 0:l.set({feedback_rules:f.slice(-100)}))}catch{}})(),!0}default:return!1}});
